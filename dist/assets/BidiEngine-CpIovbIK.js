var e=[[`(`,`)`],[`)`,`(`],[`<`,`>`],[`>`,`<`],[`[`,`]`],[`]`,`[`],[`{`,`}`],[`}`,`{`],[`«`,`»`],[`»`,`«`],[`‹`,`›`],[`›`,`‹`],[`⁽`,`⁾`],[`⁾`,`⁽`],[`₍`,`₎`],[`₎`,`₍`],[`≤`,`≥`],[`≥`,`≤`],[`〈`,`〉`],[`〉`,`〈`],[`﹙`,`﹚`],[`﹚`,`﹙`],[`﹛`,`﹜`],[`﹜`,`﹛`],[`﹝`,`﹞`],[`﹞`,`﹝`],[`﹤`,`﹥`],[`﹥`,`﹤`]],t=[`آ`,`أ`,`إ`,`ا`],n=[`ﻵ`,`ﻷ`,`ﻹ`,`ﻻ`],r=[`ﻶ`,`ﻸ`,`ﻺ`,`ﻼ`],i=`ا.ب.ت.ث.ج.ح.خ.د.ذ.ر.ز.س.ش.ص.ض.ط.ظ.ع.غ.ف.ق.ك.ل.م.ن.ه.و.ي.إ.أ.آ.ة.ى.ل.م.ن.ه.و.ي.إ.أ.آ.ة.ى.ی.ئ.ؤ`.split(`.`),a=`ﺍ.ﺏ.ﺕ.ﺙ.ﺝ.ﺡ.ﺥ.ﺩ.ﺫ.ﺭ.ﺯ.ﺱ.ﺵ.ﺹ.ﺽ.ﻁ.ﻅ.ﻉ.ﻍ.ﻑ.ﻕ.ﻙ.ﻝ.ﻡ.ﻥ.ﻩ.ﻭ.ﻱ.ﺇ.ﺃ.ﺁ.ﺓ.ﻯ.ﯼ.ﺉ.ﺅ.ﹰ.ﹲ.ﹴ.ﹶ.ﹸ.ﹺ.ﹼ.ﹾ.ﺀ.ﺉ.ﺅ`.split(`.`),o=`ﺎ.ﺐ.ﺖ.ﺚ.ﺞ.ﺢ.ﺦ.ﺪ.ﺬ.ﺮ.ﺰ.ﺲ.ﺶ.ﺺ.ﺾ.ﻂ.ﻆ.ﻊ.ﻎ.ﻒ.ﻖ.ﻚ.ﻞ.ﻢ.ﻦ.ﻪ.ﻮ.ﻲ.ﺈ.ﺄ.ﺂ.ﺔ.ﻰ.ﯽ.ﺊ.ﺆ.ﹰ.ﹲ.ﹴ.ﹶ.ﹸ.ﹺ.ﹼ.ﹾ.ﺀ.ﺊ.ﺆ`.split(`.`),s=`ﺎ.ﺒ.ﺘ.ﺜ.ﺠ.ﺤ.ﺨ.ﺪ.ﺬ.ﺮ.ﺰ.ﺴ.ﺸ.ﺼ.ﻀ.ﻄ.ﻈ.ﻌ.ﻐ.ﻔ.ﻘ.ﻜ.ﻠ.ﻤ.ﻨ.ﻬ.ﻮ.ﻴ.ﺈ.ﺄ.ﺂ.ﺔ.ﻰ.ﯿ.ﺌ.ﺆ.ﹱ.ﹲ.ﹴ.ﹷ.ﹹ.ﹻ.ﹽ.ﹿ.ﺀ.ﺌ.ﺆ`.split(`.`),c=`ﺍ.ﺑ.ﺗ.ﺛ.ﺟ.ﺣ.ﺧ.ﺩ.ﺫ.ﺭ.ﺯ.ﺳ.ﺷ.ﺻ.ﺿ.ﻃ.ﻇ.ﻋ.ﻏ.ﻓ.ﻗ.ﻛ.ﻟ.ﻣ.ﻧ.ﻫ.ﻭ.ﻳ.ﺇ.ﺃ.ﺁ.ﺓ.ﻯ.ﯾ.ﺋ.ﺅ.ﹰ.ﹲ.ﹴ.ﹶ.ﹸ.ﹺ.ﹼ.ﹾ.ﺀ.ﺋ.ﺅ`.split(`.`),l=[`ء`,`آ`,`أ`,`ؤ`,`إ`,`ا`,`ة`,`د`,`ذ`,`ر`,`ز`,`و`,`ى`],u=`ً.ً.ٌ.؟.ٍ.؟.َ.َ.ُ.ُ.ِ.ِ.ّ.ّ.ْ.ْ.ء.آ.آ.أ.أ.ؤ.ؤ.إ.إ.ئ.ئ.ئ.ئ.ا.ا.ب.ب.ب.ب.ة.ة.ت.ت.ت.ت.ث.ث.ث.ث.ج.ج.ج.ج.ح.ح.ح.ح.خ.خ.خ.خ.د.د.ذ.ذ.ر.ر.ز.ز.س.س.س.س.ش.ش.ش.ش.ص.ص.ص.ص.ض.ض.ض.ض.ط.ط.ط.ط.ظ.ظ.ظ.ظ.ع.ع.ع.ع.غ.غ.غ.غ.ف.ف.ف.ف.ق.ق.ق.ق.ك.ك.ك.ك.ل.ل.ل.ل.م.م.م.م.ن.ن.ن.ن.ه.ه.ه.ه.و.و.ى.ى.ي.ي.ي.ي.ﻵ.ﻶ.ﻷ.ﻸ.ﻹ.ﻺ.ﻻ.ﻼ.؟.؟.؟`.split(`.`),d=[`ء`,`ف`],f=[`غ`,`ي`],p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h=[`UBAT_L`,`UBAT_R`,`UBAT_EN`,`UBAT_AN`,`UBAT_ON`,`UBAT_B`,`UBAT_S`,`UBAT_AL`,`UBAT_WS`,`UBAT_CS`,`UBAT_ES`,`UBAT_ET`,`UBAT_NSM`,`UBAT_LRE`,`UBAT_RLE`,`UBAT_PDF`,`UBAT_LRO`,`UBAT_RLO`,`UBAT_BN`],g=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],_=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]],ee=class{constructor(){this.inputFormat=`ILYNN`,this.outputFormat=`VLNNN`,this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,t,n){if(this.sourceToTarget=[],this.targetToSource=[],!e)return``;if(U(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,n))return e;t=this.inputFormat,n=this.outputFormat;let r=e,i=Y,a=B(t.charAt(1)),o=B(n.charAt(1)),s=(t.startsWith(`I`)?`L`:t.charAt(0))+a,c=(n.startsWith(`I`)?`L`:n.charAt(0))+o,l=t.charAt(2)+n.charAt(2);i.defInFormat=s,i.defOutFormat=c,i.defSwap=l;let u=v(e,s,c,l,i),d=!1;return n.charAt(1)===`R`?d=!0:n.charAt(1)!==`C`&&n.charAt(1)!==`D`||(d=this.checkContextual(u)===`rtl`),this.sourceToTarget=K,this.targetToSource=W(this.sourceToTarget),q=this.targetToSource,r=t.charAt(3)===n.charAt(3)?u:n.charAt(3)===`S`?b(d,u):w(u,d,!0),this.sourceToTarget=K,this.targetToSource=q,this.levels=J,r}_inputFormatSetter(e){if(!$.test(e))throw Error(`dojox/string/BidiEngine: the bidi layout string is wrong!`);this.inputFormat=e}_outputFormatSetter(e){if(!$.test(e))throw Error(`dojox/string/BidiEngine: the bidi layout string is wrong!`);this.outputFormat=e}checkParameters(e,t){return e?this._inputFormatSetter(e):e=this.inputFormat,t?this._outputFormatSetter(t):t=this.outputFormat,e!==t}checkContextual(e){let t=S(e);if(t!==`ltr`&&t!==`rtl`){try{t=document.dir.toLowerCase()}catch{}t!==`ltr`&&t!==`rtl`&&(t=`ltr`)}return t}hasBidiChar(e){return ie.test(e)}};function v(e,t,n,r,i){let a=y(e,{inFormat:t,outFormat:n,swap:r},i);if(a.inFormat===a.outFormat)return e;t=a.inFormat,n=a.outFormat,r=a.swap;let o=t.slice(0,1),s=t.slice(1,4),c=n.slice(0,1),l=n.slice(1,4);if(i.inFormat=t,i.outFormat=n,i.swap=r,o===`L`&&n===`VLTR`){if(s===`LTR`)return i.dir=Z,T(e,i);if(s===`RTL`)return i.dir=Q,T(e,i)}if(o===`V`&&c===`V`)return i.dir=s===`RTL`?Q:Z,k(e,i);if(o===`L`&&n===`VRTL`)return s===`LTR`?(i.dir=Z,e=T(e,i)):(i.dir=Q,e=T(e,i)),k(e);if(t===`VLTR`&&n===`LLTR`)return i.dir=Z,T(e,i);if(o===`V`&&c===`L`&&s!==l)return e=k(e),s===`RTL`?v(e,`LLTR`,`VLTR`,r,i):v(e,`LRTL`,`VRTL`,r,i);if(t===`VRTL`&&n===`LRTL`)return v(e,`LRTL`,`VRTL`,r,i);if(o===`L`&&c===`L`){let t=i.swap;return i.swap=t.slice(0,1)+`N`,s===`RTL`?(i.dir=Q,e=T(e,i),i.swap=`N`+t.slice(1,3),i.dir=Z,e=T(e,i)):(i.dir=Z,e=T(e,i),i.swap=`N`+t.slice(1,3),e=v(e,`VLTR`,`LRTL`,i.swap,i)),e}return e}function y(e,t,n){if(t.inFormat===void 0&&(t.inFormat=n.defInFormat),t.outFormat===void 0&&(t.outFormat=n.defOutFormat),t.swap===void 0&&(t.swap=n.defSwap),t.inFormat===t.outFormat)return t;let r=t.inFormat.slice(0,1),i=t.outFormat.slice(0,1),a,o=t.inFormat.slice(1,4),s=t.outFormat.slice(1,4);return o.startsWith(`C`)&&(a=S(e),o=a===`ltr`||a===`rtl`?a.toUpperCase():t.inFormat.charAt(2)===`L`?`LTR`:`RTL`,t.inFormat=r+o),s.startsWith(`C`)&&(a=S(e),a===`rtl`?s=`RTL`:a===`ltr`?(a=C(e),s=a.toUpperCase()):s=t.outFormat.charAt(2)===`L`?`LTR`:`RTL`,t.outFormat=i+s),t}function b(e,t,n){if(t.length===0)return``;e===void 0&&(e=!0);let r=(t=String(t)).split(``),i=0,a=1,o=r.length;e||(i=r.length-1,a=-1,o=1);let s=x(r,i,a,o),c=``;for(let t=0;t<r.length;t++)ne(s,s.length,t)>-1?(G(q,t,!e,-1),K.splice(t,1)):c+=r[t];return c}function x(e,t,i,s,l){let u=0,d=[],f=0;for(let l=t;l*i<s;l+=i)if(A(e[l])||z(e[l])){if(e[l]===`ل`&&M(e,l+i,i,s)){e[l]=H(e[l+i],u===0?n:r),l+=i,V(e,l,i,s),d[f]=l,f++,u=0;continue}let t=e[l];u===1?e[l]=j(e,l+i,i,s)?L(e[l]):R(e[l],o):!0===j(e,l+i,i,s)?e[l]=R(e[l],c):e[l]=R(e[l],a),z(t)||(u=1),!0===I(t)&&(u=0)}else u=0;return d}function S(e){let t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<=`z`?`ltr`:`rtl`:``}function C(e){let t=e.split(``);return t.reverse(),S(t.join(``))}function w(e,n,r){if(e.length===0)return``;n===void 0&&(n=!0);let i=``,a=(e=String(e)).split(``);for(let o=0;o<e.length;o++){let s=!1;if(a[o]>=`ﹰ`&&a[o]<`﻿`){let c=e.charCodeAt(o);a[o]>=`ﻵ`&&a[o]<=`ﻼ`?(n?(o>0&&r&&a[o-1]===` `?i=i.slice(0,-1)+`ل`:(i+=`ل`,s=!0),i+=t[(c-65269)/2]):(i+=t[(c-65269)/2],i+=`ل`,o+1<e.length&&r&&a[o+1]===` `?o++:s=!0),s&&(G(q,o,!0,1),K.splice(o,0,K[o]))):i+=u[c-65136]}else i+=a[o]}return i}function T(e,t){let n=e.split(``),r=[];return E(n,r,t),O(n,r,t),N(2,n,r,t),N(1,n,r,t),J=r,n.join(``)}function E(e,t,n){let r=e.length,i=n.dir?m:p,a=0,o=-1,s=[],c=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let t=0;t<r;t++)s[t]=te(e[t]);for(let l=0;l<r;l++){let r=a,u=P(e,s,c,l,n);c[l]=u,a=i[r][u];let d=240&a;a&=15;let f=i[a][X];if(t[l]=f,d>0)if(d===16){for(let e=o;e<l;e++)t[e]=1;o=-1}else o=-1;if(i[a][re])o===-1&&(o=l);else if(o>-1){for(let e=o;e<l;e++)t[e]=f;o=-1}s[l]===5&&(t[l]=0),n.hiLevel|=f}n.hasUbatS&&D(s,t,r,n)}function D(e,t,n,r){for(let i=0;i<n;i++)if(e[i]===6){t[i]=r.dir;for(let n=i-1;n>=0&&e[n]===8;n--)t[n]=r.dir}}function O(e,t,n){if(n.hiLevel!==0&&n.swap[0]!==n.swap[1])for(let n=0;n<e.length;n++)t[n]===1&&(e[n]=F(e[n]))}function te(e){let t=e.charCodeAt(0),n=g[t>>8];return n<100?n:_[n-100][255&t]}function k(e,t){let n=e.split(``);if(t){let e=[];E(n,e,t),J=e}return n.reverse(),K.reverse(),n.join(``)}function ne(e,t,n){for(let r=0;r<t;r++)if(e[r]===n)return r;return-1}function A(e){for(let t=0;t<d.length;t++)if(e>=d[t]&&e<=f[t])return!0;return!1}function j(e,t,n,r){for(;t*n<r&&z(e[t]);)t+=n;return!!(t*n<r&&A(e[t]))}function M(e,n,r,i){for(;n*r<i&&z(e[n]);)n+=r;let a=` `;if(!(n*r<i))return!1;a=e[n];for(let e=0;e<t.length;e++)if(t[e]===a)return!0;return!1}function N(e,t,n,r){if(r.hiLevel<e)return;if(e===1&&r.dir===Q&&!r.hasUbatB)return t.reverse(),void K.reverse();let i=t.length,a,o,s,c,l,u=0;for(;u<i;){if(n[u]>=e){for(a=u+1;a<i&&n[a]>=e;)a++;for(o=u,s=a-1;o<s;o++,s--)c=t[o],t[o]=t[s],t[s]=c,l=K[o],K[o]=K[s],K[s]=l;u=a}u++}}function P(e,t,n,r,i){let a=t[r];return{UBAT_L:()=>(i.lastArabic=!1,0),UBAT_R:()=>(i.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>i.lastArabic?3:2,UBAT_AL:()=>(i.lastArabic=!0,i.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let e,a;return r<1||r+1>=t.length||(e=n[r-1])!==2&&e!==3||(a=t[r+1])!==2&&a!==3?4:(i.lastArabic&&(a=3),a===e?a:4)},UBAT_ES:()=>(r>0?n[r-1]:5)===2&&r+1<t.length&&t[r+1]===2?2:4,UBAT_ET:()=>{if(r>0&&n[r-1]===2)return 2;if(i.lastArabic)return 4;let e=r+1,a=t.length;for(;e<a&&t[e]===11;)e++;return e<a&&t[e]===2?2:4},UBAT_NSM:()=>{if(i.inFormat===`VLTR`){let n=t.length,i=r+1;for(;i<n&&t[i]===12;)i++;if(i<n){let n=e[r].charCodeAt(0),a=n>=1425&&n<=2303||n===64286,o=t[i];if(a&&(o===1||o===7))return 1}}return r<1||t[r-1]===5?4:n[r-1]},UBAT_B:()=>(i.lastArabic=!0,i.hasUbatB=!0,i.dir),UBAT_S:()=>(i.hasUbatS=!0,4),UBAT_LRE:()=>(i.lastArabic=!1,4),UBAT_RLE:()=>(i.lastArabic=!1,4),UBAT_LRO:()=>(i.lastArabic=!1,4),UBAT_RLO:()=>(i.lastArabic=!1,4),UBAT_PDF:()=>(i.lastArabic=!1,4),UBAT_BN:()=>4}[h[a]]()}function F(t){let n,r=0,i=e.length-1;for(;r<=i;)if(n=Math.floor((r+i)/2),t<e[n][0])i=n-1;else{if(!(t>e[n][0]))return e[n][1];r=n+1}return t}function I(e){for(let t=0;t<l.length;t++)if(l[t]===e)return!0;return!1}function L(e){for(let t=0;t<i.length;t++)if(e===i[t])return s[t];return e}function R(e,t){for(let n=0;n<i.length;n++)if(e===i[n])return t[n];return e}function z(e){return e>=`ً`&&e<=`ٕ`}function B(e){return e===`L`?`LTR`:e===`R`?`RTL`:e===`C`?`CLR`:e===`D`?`CRL`:``}function V(e,t,n,r){for(;t*n<r&&z(e[t]);)t+=n;return t*n<r&&(e[t]=` `,!0)}function H(e,n){for(let r=0;r<t.length;r++)if(e===t[r])return n[r];return e}function U(e,t,n){K=[],J=[];for(let r=0;r<n;r++)e[r]=r,t[r]=r,K[r]=r}function W(e){let t=Array(e.length);for(let n=0;n<e.length;n++)t[e[n]]=n;return t}function G(e,t,n,r){for(let i=0;i<e.length;i++)(e[i]>t||!n&&e[i]===t)&&(e[i]+=r)}var K=[],q=[],J=[],Y={dir:0,defInFormat:`LLTR`,defSwap:`YN`,inFormat:`LLTR`,outFormat:`VLTR`,swap:`YN`,hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:``},X=5,re=6,Z=0,Q=1,$=/^[(I|V)][(L|RCD)][(Y|N)][(S|N)]N$/,ie=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{ee as t};