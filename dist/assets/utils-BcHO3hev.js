import{r as e,t}from"./generateRendererUtils-BgK3c0Qk.js";var n=`<Null>`,r=`equal-interval`,i=1,a=5,o=10,s=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,c=new Set([`esriFieldTypeDate`,`esriFieldTypeInteger`,`esriFieldTypeSmallInteger`,`esriFieldTypeSingle`,`esriFieldTypeDouble`,`esriFieldTypeLong`,`esriFieldTypeOID`,`esriFieldTypeBigInteger`]),l=new Set([`esriFieldTypeTimeOnly`,`esriFieldTypeDateOnly`]),u=[`min`,`max`,`avg`,`stddev`,`count`,`sum`,`variance`,`nullcount`,`median`];function d(e){return e==null||typeof e==`string`&&!e?n:e}function f(e){let t=e.normalizationField!=null||e.normalizationType!=null,n=e.minValue!=null||e.maxValue!=null,r=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!n&&!r}function p(e){let{outStatisticTypes:t}=e,n=e.returnDistinct?[...new Set(e.values)]:e.values,r=n.filter(e=>e!=null).sort(),i=r.length,a={count:i,min:r[0],max:r[i-1]};return e.supportsNullCount&&(a.nullcount=n.length-i),!e.percentileParams||t?.include?.length&&!t.include.includes(`median`)||t?.exclude?.length&&t.exclude.includes(`median`)||(a.median=h(n,e.percentileParams)),a}function m(e){let{values:t,useSampleStdDev:n,supportsNullCount:r,outStatisticTypes:i}=e,a=1/0,o=-1/0,s=null,c=null,l=null,u=null,d=0,f=e.minValue==null?-1/0:e.minValue,p=e.maxValue==null?1/0:e.maxValue;for(let e of t)Number.isFinite(e)?e>=f&&e<=p&&(s=s===null?e:s+e,a=Math.min(a,e),o=Math.max(o,e),d++):typeof e==`string`&&d++;if(d&&s!=null){c=s/d;let e=0;for(let n of t)Number.isFinite(n)&&n>=f&&n<=p&&(e+=(n-c)**2);u=n?d>1?e/(d-1):0:d>0?e/d:0,l=Math.sqrt(u)}else a=null,o=null;let m={avg:c,count:d,max:o,min:a,stddev:l,sum:s,variance:u};return r&&(m.nullcount=t.length-d),!e.percentileParams||i?.include?.length&&!i.include.includes(`median`)||i?.exclude?.length&&i.exclude.includes(`median`)||(m.median=h(t,e.percentileParams)),m}function h(e,t){let{fieldType:n,value:r,orderBy:i,isDiscrete:a}=t,o=g(n,i===`desc`);if((e=[...e].filter(e=>e!=null).sort((e,t)=>o(e,t))).length===0)return null;if(r<=0)return e[0];if(r>=1)return e[e.length-1];let s=(e.length-1)*r,c=Math.floor(s),l=c+1,u=s%1,d=e[c],f=e[l];return l>=e.length||a||typeof d==`string`||typeof f==`string`?d:d*(1-u)+f*u}function g(e,t){if(e){if(c.has(e))return O(t);if(l.has(e))return T(t,!1);if(e===`esriFieldTypeTimestampOffset`)return S(t);let n=T(t,!0);if(e===`esriFieldTypeString`)return n;if(e===`esriFieldTypeGUID`||e===`esriFieldTypeGlobalID`)return(e,t)=>n(k(e),k(t))}let n=t?1:-1,r=O(t),i=T(t,!0),a=y(t);return(e,t)=>typeof e==`number`&&typeof t==`number`?r(e,t):typeof e==`string`&&typeof t==`string`?i(e,t):a(e,t)??n}var _=(e,t)=>e==null?t==null?0:1:t==null?-1:null,v=(e,t)=>e==null?t==null?0:-1:t==null?1:null;function y(e){return e?_:v}var b=(e,t)=>v(e,t)??(e===t?0:new Date(e).getTime()-new Date(t).getTime()),x=(e,t)=>_(e,t)??(e===t?0:new Date(t).getTime()-new Date(e).getTime());function S(e){return e?x:b}var C=(e,t)=>v(e,t)??(e===t?0:e<t?-1:1),w=(e,t)=>_(e,t)??(e===t?0:e<t?1:-1);function T(e,t){if(!t)return e?w:C;let n=y(e);return e?(e,t)=>n(e,t)??((e=e.toUpperCase())>(t=t.toUpperCase())?-1:e<t?1:0):(e,t)=>n(e,t)??((e=e.toUpperCase())<(t=t.toUpperCase())?-1:e>t?1:0)}var E=(e,t)=>_(e,t)??t-e,D=(e,t)=>v(e,t)??e-t;function O(e){return e?E:D}function k(e){return e.slice(24,36)+e.slice(19,23)+e.slice(16,18)+e.slice(14,16)+e.slice(11,13)+e.slice(9,11)+e.slice(6,8)+e.slice(4,6)+e.slice(2,4)+e.slice(0,2)}function A(e,t,n){let r;for(r in e)t?.include?.length&&!t.include.includes(r)||t?.exclude?.length&&t.exclude.includes(r)?delete e[r]:u.includes(r)&&(Number.isFinite(e[r])||(e[r]=null));return n&&[`avg`,`stddev`,`variance`].forEach(t=>{e[t]!=null&&(e[t]=Math.ceil(e[t]??0))}),e}function j(e){let t={};for(let n of e)(n==null||typeof n==`string`&&n.trim()===``)&&(n=null),t[n]==null?t[n]={count:1,data:n}:t[n].count++;return{count:t}}function M(e){return e?.type===`coded-value`?e.codedValues.map(e=>e.code):[]}function N(e,t,n,r){let i=e.count,a=[];if(n&&t){let e=[],n=M(t[0]);for(let i of n)if(t[1]){let n=M(t[1]);for(let a of n)if(t[2]){let n=M(t[2]);for(let t of n)e.push(`${d(i)}${r}${d(a)}${r}${d(t)}`)}else e.push(`${d(i)}${r}${d(a)}`)}else e.push(i);for(let t of e)i.hasOwnProperty(t)||(i[t]={data:t,count:0})}for(let e in i){let t=i[e];a.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:a}}function P(e,t,n,r){let i=null;switch(t){case`log`:e!==0&&(i=Math.log(e)*Math.LOG10E);break;case`percent-of-total`:Number.isFinite(r)&&r!==0&&(i=e/r*100);break;case`field`:Number.isFinite(n)&&n!==0&&(i=e/n);break;case`natural-log`:e>0&&(i=Math.log(e));break;case`square-root`:e>0&&(i=e**.5)}return i}function F(e,n,r){let i=L({field:n.field,normalizationType:n.normalizationType,normalizationField:n.normalizationField,classificationMethod:n.classificationMethod,standardDeviationInterval:n.standardDeviationInterval,definedInterval:n.definedInterval,breakCount:n.numClasses||a});return e=I(e,n.minValue,n.maxValue),t({definition:i,values:e,normalizationTotal:n.normalizationTotal},r)}function I(e,t,n){let r=t??-1/0,i=n??1/0;return e.filter(e=>Number.isFinite(e)&&e>=r&&e<=i)}function L(t){let{breakCount:n,field:a,normalizationField:o,normalizationType:s}=t,c=t.classificationMethod||r,l=c===`standard-deviation`?t.standardDeviationInterval||i:void 0,u=c===`defined-interval`?t.definedInterval:void 0;return new e({breakCount:n,classificationField:a,classificationMethod:c,normalizationField:s===`field`?o:void 0,normalizationType:s,standardDeviationInterval:l,definedInterval:u})}function R(e,t){let n=e.classBreaks,r=n.length,i=n[0]?.minValue,a=n[r-1]?.maxValue,o=t===`standard-deviation`,c=s;return n=n.map(e=>{let t=e.label,n={minValue:e.minValue,maxValue:e.maxValue,label:t};if(o&&t){let e=t.match(c)?.map(e=>+e.trim())??[];e.length===2?(n.minStdDev=e[0],n.maxStdDev=e[1],e[0]<0&&e[1]>0&&(n.hasAvg=!0)):e.length===1&&(t.includes(`<`)?(n.minStdDev=null,n.maxStdDev=e[0]):t.includes(`>`)&&(n.minStdDev=e[0],n.maxStdDev=null))}return n}),{minValue:i,maxValue:a,classBreakInfos:n,normalizationTotal:e.normalizationTotal}}function z(e,t){let n=B(e,t);if(n.min==null&&n.max==null)return{bins:[],minValue:n.min,maxValue:n.max,normalizationTotal:t.normalizationTotal};let r=n.intervals,i=n.min??0,a=n.max??0,o=r.map((e,t)=>({minValue:r[t][0],maxValue:r[t][1],count:0}));for(let t of e)if(t!=null&&t>=i&&t<=a){let e=V(r,t);e>-1&&o[e].count++}return{bins:o,minValue:i,maxValue:a,normalizationTotal:t.normalizationTotal}}function B(e,t,n=!1){let{field:r,classificationMethod:i,standardDeviationInterval:a,definedInterval:s,normalizationType:c,normalizationField:l,normalizationTotal:u,minValue:d,maxValue:p}=t,h=t.numBins||o,g=null,_=null,v=null;if((!i||i===`equal-interval`)&&!c){if(d!=null&&p!=null)g=d,_=p;else{let t=m({values:e,minValue:d,maxValue:p,useSampleStdDev:!c,supportsNullCount:f({normalizationType:c,normalizationField:l,minValue:d,maxValue:p})});g=t.min??null,_=t.max??null}v=H(g??0,_??0,h)}else{let{classBreaks:t}=F(e,{field:r,normalizationType:c,normalizationField:l,normalizationTotal:u,classificationMethod:i,standardDeviationInterval:a,definedInterval:s,minValue:d,maxValue:p,numClasses:h},d!=null&&p!=null?[d,p]:void 0);g=t[0]?.minValue,_=t[t.length-1]?.maxValue,v=t.map(e=>[e.minValue,e.maxValue])}if(n&&v.length){let e=v.at(-1)[1];v.push([e,e])}return{min:g,max:_,intervals:v}}function V(e,t){let n=-1;for(let r=e.length-1;r>=0;r--)if(t>=e[r][0]){n=r;break}return n}function H(e,t,n){let r=(t-e)/n,i=[],a,o=e;for(let e=1;e<=n;e++)a=o+r,a=Number(a.toFixed(16)),i.push([o,e===n?t:a]),o=a;return i}export{L as _,B as a,z as c,p as d,g as f,m as g,d as h,F as i,u as l,j as m,P as n,V as o,H as p,A as r,R as s,N as t,f as u,h as v};