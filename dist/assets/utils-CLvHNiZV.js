const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/visualVariableUtils-a76hLqJP.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css"])))=>i.map(i=>d[i]);
import{$b as e,Cw as t,Dp as n,ET as r,Ft as i,Lb as a,Op as o,Wy as s,Xb as c,Yd as l,Zb as u,ab as d,ho as ee,nD as f,po as p,sD as m,ss as h,tx as g,vE as te,vb as _}from"./index-BqmCqmfp.js";import{a as v}from"./utils-5jlQHYup.js";import{s as y}from"./utils-DD1PtgG7.js";function b({level:e,class:t,...n},r){let i=x(e);return p(`h${i}`,{...n,"aria-level":String(i),class:h(ee.heading,t),role:`heading`},r)}function x(e){return d(Math.ceil(e),1,6)}function S(e,t=1){return x(e+t)}var C=/^-?(\d+)(\.(\d+))?$/i;function ne(e,t){return e-t}function re(e,t){let n,r;return n=Number(e.toFixed(t)),n<e?r=n+1/10**t:(r=n,n-=1/10**t),n=Number(n.toFixed(t)),r=Number(r.toFixed(t)),[n,r]}function ie(e,t,n,r,i){let a=T(e,t,n,r),o=a.previous==null||a.previous<=i,s=a.next==null||a.next<=i;return o&&s||a.previous+a.next<=2*i}function w(e){let t=String(e),n=t.match(C);if(n?.[1])return{integer:n[1].split(``).length,fractional:n[3]?n[3].split(``).length:0};if(t.toLowerCase().includes(`e`)){let e=t.split(`e`),n=e[0],r=e[1];if(n&&r){let e=Number(n),t=Number(r),i=t>0;i||(t=Math.abs(t));let a=w(e);return i?(a.integer+=t,t>a.fractional?a.fractional=0:a.fractional-=t):(a.fractional+=t,t>a.integer?a.integer=1:a.integer-=t),a}}return{integer:0,fractional:0}}function T(e,t,n,r){let i={previous:null,next:null};if(n!=null){let r=e-n,a=t-n-r;i.previous=Math.floor(Math.abs(100*a/r))}if(r!=null){let n=r-e,a=r-t-n;i.next=Math.floor(Math.abs(100*a/n))}return i}function E(e,t={}){let n=e.slice(),{tolerance:r=2,strictBounds:i=!1,indexes:a=n.map((e,t)=>t)}=t;a.sort(ne);for(let e=0;e<a.length;e++){let t=a[e],o=n[t],s=t===0?null:n[t-1],c=t===n.length-1?null:n[t+1],l=w(o).fractional;if(l){let a,u=0,d=!1;for(;u<=l&&!d;){let t=re(o,u);a=i&&e===0?t[1]:t[0],d=ie(o,a,s,c,r),u++}d&&(n[t]=a)}}return n}var D={maximumFractionDigits:20};function O(e){return c(e,D)}var k=`<`,A=`>`;function j(e,t,n,r){let i=``;t===0?i=`< `:t===n&&(i=`> `);let a=N(e,r);return a==null?``:i+a}function M(e){let{format:t,fieldFormat:n}=e||{};return n?.type===`number`||!!t&&t.dateFormat==null&&(t.places!=null||t.digitSeparator!=null)}function N(t,n){if(t==null)return t;let{fieldType:r,format:i,fieldFormat:a,timeZoneOptions:o}=n||{};if(B(r))return y(t,{fieldType:r,format:i?.dateFormat,fieldFormat:a?.type===`date-time`?a:void 0,timeZoneOptions:o});if(typeof t==`string`&&M(n)){let e=Number(t);isNaN(e)||(t=e)}if(typeof t==`string`)return t;let s=a?.type===`number`?e(a):i?u(i):void 0;return s?c(t,s):O(t)}var P=[`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=`,`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=`,`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII=`];async function F(e){if(!(`visualVariables`in e)||!e.visualVariables)return null;let n=e.visualVariables.find(e=>e.type===`color`);if(!n)return null;let r=null,i=null;if(n.stops){if(n.stops.length===1)return n.stops[0].color;r=n.stops[0].value,i=n.stops[n.stops.length-1].value}let a=r!=null&&i!=null?r+(i-r)/2:0,{getColor:o}=await t(async()=>{let{getColor:e}=await import(`./visualVariableUtils-a76hLqJP.js`);return{getColor:e}},__vite__mapDeps([0,1,2]));return o(n,a)??null}async function I(e,t){let n=e.trailCap,r=e.trailWidth||1,i=t||await F(e)||e.color;return new l({cap:n,color:i,width:r})}function L(e,t){if(!t)return null;if(`featureReduction`in e)switch(e.featureReduction?.type){case`cluster`:case`binning`:{let n=e.featureReduction.fields.find(({name:e})=>e.toLowerCase()===t.toLowerCase());return n&&`getField`in e?e.getField(n.onStatisticField):null}}return`getField`in e?e.getField?.(t):null}function R(e,t){let n=`popupTemplate`in e?e.popupTemplate?.fieldInfos:null;if(n?.length&&t)return n.find(e=>e.fieldName?.toLowerCase()===t.toLowerCase())}function z(e){let t=0,n=0;return e.stops?(t=e.stops?.at(0)?.value??t,n=e.stops?.at(-1)?.value??n):`minDataValue`in e&&`maxDataValue`in e&&(t=e.minDataValue??t,n=e.maxDataValue??n),n-t>2*a.days?`short-date`:`short-date-short-time`}function B(e){return[`date`,`date-only`,`time-only`,`timestamp-offset`].includes(e||``)}function V(e){return _(e)&&!(`featureReduction`in e&&e.featureReduction)}function H(e,t,r){let i=U(e,t.field,r);return i?(B(i.fieldType)&&(V(e)?i.fieldFormat??=new o({dateStyle:`short`,timeStyle:z(t)===`short-date-short-time`?`short`:null}):i.format??=new n({dateFormat:z(t)})),i):null}function U(e,t,n){let r=L(e,t),i=r?.name;if(!i)return null;let a=r?.type,o=V(e);return{fieldType:a,format:o?null:R(e,i)?.format,fieldFormat:o?e.getFieldConfiguration(i)?.fieldFormat:null,timeZoneOptions:B(a)?{layerTimeZone:`preferredTimeZone`in e?e.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:`datesInUnknownTimezone`in e&&e.datesInUnknownTimezone}:null}}function W(e,t){if(`authoringInfo`in e)return e.authoringInfo?.visualVariables?.find(({theme:e})=>e===t)}function G(e,t){let n=e??``;return t!=null&&t&&(n=n?`(`+n+`) AND (`+t+`)`:t),n}var K=new s([64,64,64]);function q(e,t){let n=[],r=e.length-1;return e.length===5?n.push(0,2,4):n.push(0,r),e.map((e,i)=>n.includes(i)?j(e,i,r,t):null)}async function J(e,n,r){let i=!1,a=[],o=[];if(e.stops){let t=e.stops;a=t.map(e=>e.value),i=t.some(e=>!!e.label),i&&(o=t.map(e=>e.label))}let s=a[0],c=a[a.length-1];if(s==null&&c==null)return null;let l=i?null:q(a,r);return(await Promise.all(a.map(async(r,a)=>{let s=e.type===`opacity`?await Y(r,e,n):(await t(async()=>{let{getColor:e}=await import(`./visualVariableUtils-a76hLqJP.js`);return{getColor:e}},__vite__mapDeps([0,1,2]))).getColor(e,r),c=i?o[a]:l?.[a]??``;return s==null?null:{value:r,color:s,label:c}}))).filter(f).reverse()}async function Y(e,n,r){let i=new s(r??K),a=(await t(async()=>{let{getOpacity:e}=await import(`./visualVariableUtils-a76hLqJP.js`);return{getOpacity:e}},__vite__mapDeps([0,1,2]))).getOpacity(n,e);return a!=null&&(i.a=a),i}function X(e){let t=!1,n=[],r=[];n=e.map(e=>e.value),t=e.some(e=>!!e.label),t&&(r=e.map(e=>e.label??``));let i=n[0],a=n[n.length-1];if(i==null&&a==null)return null;let o=t?null:q(n);return n.map((n,i)=>({value:n,color:Z(n,e),label:t?r[i]:o?.[i]??``})).reverse()}function Z(e,t){let{startIndex:n,endIndex:r,weight:i}=ae(e,t);if(n===r)return t[n].color;let a=s.blendColors(t[n].color,t[r].color,i);return new s(a)}function ae(e,t){let n=0,r=t.length-1;return t.some((t,i)=>e<t.value?(r=i,!0):(n=i,!1)),{startIndex:n,endIndex:r,weight:(e-t[n].value)/(t[r].value-t[n].value)}}function oe(e,t){let n=[];if(e&&e.type===`multipart`)e.colorRamps.reverse().forEach((r,i)=>{i===0?n.push({value:t.max,color:new s(r.toColor),label:`high`}):n.push({value:null,color:new s(r.toColor),label:``}),i===e.colorRamps.length-1?n.push({value:t.min,color:new s(r.fromColor),label:`low`}):n.push({value:null,color:new s(r.fromColor),label:``})});else{let r,i;e&&e.type===`algorithmic`?(r=e.fromColor,i=e.toColor):(r=[0,0,0,1],i=[255,255,255,1]),n=[{value:t.max,color:new s(i),label:`high`},{value:t.min,color:new s(r),label:`low`}]}return n}function Q(e){if(!e.colorStops)return[];let t=[...e.colorStops].filter(e=>e.color?.a>0),n=t.length-1;if(t&&t[0]){let e=t[n];e&&e.ratio!==1&&(t.push(new i({ratio:1,color:e.color})),n++)}return t.map((t,r)=>{let i=``;return r===0?i=e.legendOptions?.minLabel||`low`:r===n&&(i=e.legendOptions?.maxLabel||`high`),{color:t.color,label:i,ratio:t.ratio}}).reverse()}g(`short-date`);async function $(e,t,n){r(e,t,()=>[]).push(...n)}async function se(e){let t=new Map;if(!e)return t;if(`visualVariables`in e&&e.visualVariables){for(let n of e.visualVariables)if(ce(n)){let e=(await J(n)??[]).map(e=>e.color);await $(t,n.field||n.valueExpression,e)}}if(e.type===`heatmap`){let n=Q(e).map(e=>e.color);await $(t,e.field||e.valueExpression,n)}else if(e.type===`pie-chart`){for(let n of e.attributes)await $(t,n.field||n.valueExpression,[n.color]);await $(t,`default`,[e?.othersCategory?.color,v(e.backgroundFillSymbol,null)])}else if(e.type===`dot-density`){for(let n of e.attributes)await $(t,n.field||n.valueExpression,[n.color]);await $(t,`default`,[e.backgroundColor])}else if(e.type===`unique-value`)if(e.authoringInfo?.type===`predominance`)for(let n of e.uniqueValueInfos??[])await $(t,n.value.toString(),[v(n.symbol,null)]);else{let n=(e.uniqueValueInfos??[]).map(e=>v(e.symbol,null)),{field:r,field2:i,field3:a,valueExpression:o}=e;(r||o)&&await $(t,r||o,n),i&&await $(t,i,n),a&&await $(t,a,n)}else if(e.type===`class-breaks`){let n=e.classBreakInfos.map(e=>v(e.symbol,null)),{field:r,valueExpression:i}=e;await $(t,r??i,n)}else e.type===`simple`&&await $(t,`default`,[v(e.symbol,null)]);return`defaultSymbol`in e&&e.defaultSymbol&&await $(t,`default`,[v(e.defaultSymbol,null)]),t.forEach((e,n)=>{let r=m(e.filter(Boolean),(e,t)=>JSON.stringify(e)===JSON.stringify(t));t.set(n,r)}),t}function ce(e){return e.type===`color`}export{b as S,I as _,J as a,E as b,H as c,N as d,A as f,k as g,j as h,Z as i,G as l,U as m,Q as n,X as o,F as p,oe as r,W as s,se as t,P as u,w as v,S as x,T as y};