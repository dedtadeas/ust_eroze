const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projectOperator-BUKyFcqE.js","assets/SimpleGeometryCursor-CI9GIWKa.js","assets/operatorProject-xNL6vJqt.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css","assets/projectOperator-D9Kz8ulR.js","assets/geographicTransformationUtils-El-K6aja.js"])))=>i.map(i=>d[i]);
import{Ax as e,Cw as t,JS as n,Sx as r,Ux as i,Vw as a,XS as o,YS as s,_E as c,_g as l,aS as u,eC as d,e_ as f,jS as p,nD as m,tC as h}from"./index-BqmCqmfp.js";function g(){if(!D)throw new c(`rasterprojectionhelper-project`,`projection operator is not loaded`)}var _=(e,t,n,r=0)=>{if(n[0]===1)return[0,0];let i=1,a=-1,o=1,s=-1;for(let t=0;t<e.length;t+=2)isNaN(e[t])||(i=i>e[t]?e[t]:i,a=a>e[t]?a:e[t],o=o>e[t+1]?e[t+1]:o,s=s>e[t+1]?s:e[t+1]);let{cols:c,rows:l}=t,u=(a-i)/c/n[0],d=(s-o)/l/n[1],f=2*r,p=0,m=!1,h=[0,0];for(let t=0;t<c-3;t++){for(let n=0;n<l-3;n++){let r=t*l*2+2*n,i=(e[r]+e[r+4]+e[r+4*l]+e[r+4*l+4])/4,a=(e[r+1]+e[r+5]+e[r+4*l+1]+e[r+4*l+5])/4,o=Math.abs((i-e[r+2*l+2])/u),s=Math.abs((a-e[r+2*l+3])/d);if(o+s>p&&(p=o+s,h=[o,s]),f&&p>f){m=!0;break}}if(m)break}return h},v={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},y=new Map,b=new Map,x=500,S=39.37,C=96,w,T,E,D=!1;async function O(){return w||(w=a(),T=await t(()=>import(`./projectOperator-BUKyFcqE.js`),__vite__mapDeps([0,1,2,3,4,5])),E=await t(()=>import(`./geographicTransformationUtils-El-K6aja.js`),__vite__mapDeps([6,3,4])),T.isLoaded()||await T.load(),E.isLoaded()||await E.load(),D=!0,w.resolve()),w.promise}function k(e,t,n){if(g(),n){let n=T.execute(e,t);return E.getTransformation(t,e.spatialReference,n)}return E.getTransformation(e.spatialReference,t,e)}function A(e,t,n,i){let a=e.spatialReference;if(!a||!t||a.equals(t))return e;g();let o=n.center,s=new r({xmin:o.x-e.x/2,xmax:o.x+e.x/2,ymin:o.y-e.y/2,ymax:o.y+e.y/2,spatialReference:a}),c=T.execute(s,t,{geographicTransformation:i}),l=q(t);return c==null||l!=null&&c.width>=l?j(e,a,t):{x:c.width,y:c.height}}function j(e,t,n){let r=u(t)/u(n);return{x:e.x*r,y:e.y*r}}function M(e,t,n){let{spatialReference:r}=n;if(!r||!t||r.equals(t))return e;if(r.isGeographic&&t.isGeographic)return j(e,r,t);if(g(),!D)throw new c(`raster-projection-helper:project-dataset-resolution`,`geometry engine is not loaded`);let{x:i,y:a}=e,o=(i+a)/2*u(r),s=1;o>30&&(s=30/o,i*=s,a*=s);let l=i*256/2,d=a*256/2,{x:p,y:m}=n.center,h=[];for(let e=0;e<=256;e++)h.push([p-l,m-d+e*a]);for(let e=1;e<=256;e++)h.push([p-l+e*i,m+d]);for(let e=1;e<=256;e++)h.push([p+l,m+d-e*a]);for(let e=1;e<256;e++)h.push([p+l-e*i,m-d]);h.push(h[0]);let _=new f({rings:[h],spatialReference:r}),v=T.execute(_,t);if(!v)return j(e,r,t);let y=v.extent,b=q(t);if(y==null||b!=null&&y.width>=b)return j(e,r,t);let x=de(v.rings),S=i*a*256*256,C=Math.sqrt(x/S)/s,w={x:y.width/s/256,y:y.height/s/256},E={x:i*C,y:a*C},O=w.x*w.y;return Math.abs(O-E.x*E.y)/O<.1?w:E}function N(e,t){return(typeof e==`number`?e:(e.x+e.y)/2)*u(t)*C*S}function P(e,t){let{pixelSize:n,extent:r}=e;return N(M(n,t,r),t)}function F(e,t=.01){return u(e)?t/u(e):0}function I(e,t,n,r=!0){let i=e.spatialReference;if(i.equals(t))return e;g();let a=T.execute(e,t,{geographicTransformation:n});return r&&a&&L([e],[a],i,t),a}function L(e,t,n,r){let i=J(n,!0),a=J(r,!0),o=F(n,x),s=F(r,x);if(o&&i!=null&&a!=null)for(let n=0;n<e.length;n++){let r=t[n];if(!r)continue;let{x:c}=e[n],{x:l}=r;l>=a[1]-s&&Math.abs(c-i[0])<o?r.x-=a[1]-a[0]:l<=a[0]+s&&Math.abs(c-i[1])<o&&(r.x+=a[1]-a[0])}}function R(e){let{inSR:t,outSR:n,preferPE:r}=e;if(t.equals(n)){let{points:t}=U(e,null);return t}return t.isWebMercator&&n.isWGS84||t.isWGS84&&n.isWebMercator?ee(e):r&&(t.isGeographic||V(t)!=null)?B(e):z(e)}function z(t){let{points:n}=U(t,null),{inSR:r,outSR:i,datumTransformation:a}=t,o=n.map(t=>new e(t[0],t[1],r)),s=T.executeMany(o,i,{geographicTransformation:a});return a&&L(o,s,r,i),s.map(e=>e?[e.x,e.y]:[NaN,NaN])}function B(e){let{inSR:t,outSR:r,datumTransformation:i}=e,a=V(t),{points:s,mask:c}=U(e,a);if(!t.isGeographic){let e=t.wkid?o.coordsys(t.wkid):o.fromString(t.isGeographic?d.PE_TYPE_GEOGCS:d.PE_TYPE_PROJCS,t.wkt2||t.wkt);n.projToGeog(e,s.length,s)}if(i!=null&&i.steps.length){let e,t=179.9955;if(r.isGeographic&&(e=s.map(([e])=>e>t?1:e<-t?-1:0)),i.steps.forEach(e=>{let t=e.wkid?o.geogtran(e.wkid):o.fromString(d.PE_TYPE_GEOGTRAN,e.wkt);h.geogToGeog(t,s.length,s,null,e.isInverse?d.PE_TRANSFORM_2_TO_1:d.PE_TRANSFORM_1_TO_2)}),e)for(let n=0;n<s.length;n++){let r=e[n],i=s[n][0],a=i>t?1:i<-t?-1:0;r&&a&&r!==a&&(s[n][0]=r>0?i+360:i-360)}}if(!r.isGeographic){let e=V(r,!0),t=e!=null&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90];te(s,t);let i=r.wkid?o.coordsys(r.wkid):o.fromString(r.isGeographic?d.PE_TYPE_GEOGCS:d.PE_TYPE_PROJCS,r.wkt2||r.wkt);n.geogToProj(i,s.length,s)}let l=s;if(c&&s.length!==c.length){l=[];for(let e=0,t=0;e<c.length;e++)c[e]?l.push(s[t++]):l.push([NaN,NaN])}return l}function ee(t){let{cols:n,rows:r,xres:i,yres:a,usePixelCenter:o,inSR:s,outSR:c}=t,{xmin:u,ymax:d}=t;o&&(u+=i/2,d-=a/2);let f=[],p=[],m=Math.max(n,r);for(let t=0;t<m;t++){let o=u+i*Math.min(n,t),m=d-a*Math.min(r,t),h=l(new e({x:o,y:m,spatialReference:s}),s,c);t<=n&&f.push(h.x),t<=r&&p.push(h.y)}let h=[];for(let e=0;e<n;e++)for(let t=0;t<r;t++)h.push([f[e],p[t]]);return h}function V(e,t=!1){let n=e.wkid||e.wkt2||e.wkt;if(!n||e.isGeographic)return null;if(n=String(n),y.has(n)){let e=y.get(n);return t?e?.gcs:e?.pcs}let r=e.wkid?o.coordsys(e.wkid):o.fromString(e.isGeographic?d.PE_TYPE_GEOGCS:d.PE_TYPE_PROJCS,e.wkt2||e.wkt),i=H(r,F(e,1e-4)),a=H(r,0,!0);return y.set(n,{pcs:i,gcs:a}),t?a:i}function H(e,t=0,n=!1){let r=s.generate(e),i=n?e.horizonGcsGenerate():e.horizonPcsGenerate();if(!r||!i?.length)return null;let a=!1,o=i.find(e=>e.getInclusive()===1&&e.getKind()===1);if(!o){if(o=i.find(e=>e.getInclusive()===1&&e.getKind()===0),!o)return null;a=!0}let c=n?0:(r.getNorthPoleLocation()===2?1:0)|(r.getSouthPoleLocation()===2?2:0),l=r.isPannableRectangle(),u=o.getCoord();if(a)return{isEnvelope:a,isPannable:l,vertices:u,coef:null,bbox:[u[0][0]-t,u[0][1]-t,u[1][0]+t,u[1][1]+t],poleLocation:c};let d=0,f=[],[p,m]=u[0],[h,g]=u[0];for(let e=0,t=u.length;e<t;e++){d++,d===t&&(d=0);let[n,r]=u[e],[i,a]=u[d];if(a===r)f.push([n,i,r,a,2]);else{let e=(i-n)/(a-r||1e-4),t=n-e*r;r<a?f.push([e,t,r,a,0]):f.push([e,t,a,r,1])}p=p<n?p:n,m=m<r?m:r,h=h>n?h:n,g=g>r?g:r}return{isEnvelope:!1,isPannable:l,vertices:u,coef:f,bbox:[p,m,h,g],poleLocation:c}}function U(e,t){let n=[],{cols:r,rows:i,xres:a,yres:o,usePixelCenter:s}=e,{xmin:c,ymax:l}=e;if(s&&(c+=a/2,l-=o/2),t==null){for(let e=0;e<r;e++)for(let t=0;t<i;t++)n.push([c+a*e,l-o*t]);return{points:n}}let u=new Uint8Array(r*i);if(t.isEnvelope){let{bbox:[e,s,d,f]}=t;for(let p=0,m=0;p<r;p++){let r=c+a*p,h=t.isPannable||r>=e&&r<=d;for(let e=0;e<i;e++,m++){let t=l-o*e;h&&t>=s&&t<=f&&(n.push([r,t]),u[m]=1)}}return{points:n,mask:u}}let d=t.coef,f=[];for(let e=0;e<i;e++){let t=l-o*e,n=[],r=[];for(let e=0;e<d.length;e++){let[i,a,o,s,c]=d[e];if(t===o&&o===s)n.push(i),n.push(a),r.push(2),r.push(2);else if(t>=o&&t<=s){let e=i*t+a;n.push(e),r.push(c)}}let i=n;if(n.length>2){let e=r[0]===2?0:r[0],t=n[0];i=[];for(let a=1;a<r.length;a++)r[a]===2&&a!==r.length-1||(r[a]!==e&&(i.push(e===0?Math.min(t,n[a-1]):Math.max(t,n[a-1])),e=r[a],t=n[a]),a===r.length-1&&i.push(r[a]===0?Math.min(t,n[a]):Math.max(t,n[a])));i.sort((e,t)=>e-t)}else n[0]>n[1]&&(i=[n[1],n[0]]);f.push(i)}for(let e=0,t=0;e<r;e++){let r=c+a*e;for(let e=0;e<i;e++,t++){let i=l-o*e,a=f[e];if(a.length===2)r>=a[0]&&r<=a[1]&&(n.push([r,i]),u[t]=1);else if(a.length>2){let e=!1;for(let t=0;t<a.length;t+=2)if(r>=a[t]&&r<=a[t+1]){e=!0;break}e&&(n.push([r,i]),u[t]=1)}}}return{points:n,mask:u}}function te(e,t){let[n,r]=t;for(let t=0;t<e.length;t++){let i=e[t][1];(i<n||i>r)&&(e[t]=[NaN,NaN])}}function W(e,t){let n=q(e[0].spatialReference);if(e.length<2||n==null||(t??=F(e[0].spatialReference),(e=e.filter(e=>e.width>t)).length===1))return e[0];let{xmin:i,xmax:a,ymin:o,ymax:s}=e[0];for(let t=1;t<e.length;t++){let r=e[t];a=r.xmax+n*t,o=Math.min(o,r.ymin),s=Math.max(s,r.ymax)}return new r({xmin:i,xmax:a,ymin:o,ymax:s,spatialReference:e[0].spatialReference})}function G(e,t,n=null,i=!0){let a=e.spatialReference;if(a.equals(t)||!t)return e;let o=X(e),s=q(a,!0),c=q(t);if(o===0||s==null||c==null){let r=K(e,t,n,i);if(r&&s==null&&c!=null&&Math.abs(r.width-c)<F(t)&&T.isLoaded()){let n=V(a);if(n!=null&&n.poleLocation===0&&e.width<(n.bbox[2]-n.bbox[0])/2)return re(e,t)||r}return r}let l=e.clone().normalize();if(l.length===1&&e.xmax<s&&e.xmax-s/2>F(a)){let{xmin:t,xmax:n}=e;for(let i=0;i<=o;i++){let c=i===0?t:-s/2,u=i===o?n-s*i:s/2;l[i]=new r({xmin:c,xmax:u,ymin:e.ymin,ymax:e.ymax,spatialReference:a})}}let u=l.map(e=>K(e,t,n,i)).filter(m);return u.length===0?null:W(u)}function ne(e,t,n){if(e.type===`extent`){let{xmin:t,ymin:n,xmax:r,ymax:i,spatialReference:a}=e;e=new f({rings:[[[t,i],[r,i],[r,n],[t,n],[t,i]]],spatialReference:a})}return e.spatialReference.equals(t)?e:(g(),T.execute(e,t,{geographicTransformation:n}))}function re(e,t){let n=q(t);if(n==null)return null;let{xmin:i,ymin:a,xmax:o,ymax:s}=e,c=e.spatialReference,l=new f({spatialReference:c,rings:[[[i,a],[o,a],[o,s],[i,s],[i,a]]]}),u=T.execute(l,t);if(u.rings.length!==2||!u.rings[0].length||!u.rings[1].length)return null;let{rings:d}=u,p=F(c),m=new r({spatialReference:t});for(let e=0;e<2;e++){i=o=d[e][0][0],a=s=d[e][0][1];for(let t=0;t<d[e].length;t++)i=i>d[e][t][0]?d[e][t][0]:i,o=o<d[e][t][0]?d[e][t][0]:o,a=a>d[e][t][1]?d[e][t][1]:a,s=s<d[e][t][1]?d[e][t][1]:s;if(e===0)m.ymin=a,m.ymax=s,m.xmin=i,m.xmax=o;else if(m.ymin=Math.min(m.ymin,a),m.ymax=Math.max(m.ymax,s),Math.abs(o-n/2)<p)m.xmin=i,m.xmax+=n;else{if(!(Math.abs(i+n/2)<p))return null;m.xmax=o+n}}return m}function K(t,n,r,i=!0,a=!0){let o=t.spatialReference;if(o.equals(n)||!n)return t;g();let s=T.execute(t,n,{geographicTransformation:r});if(a&&n.isWebMercator&&s&&(s.ymax=Math.min(20037508.342787,s.ymax),s.ymin=Math.max(-20037508.342787,s.ymin),s.ymin>=s.ymax))return null;if(!i||!s)return s;let c=J(o,!0),l=J(n,!0);if(c==null||l==null)return s;let u=F(o,.001),d=F(o,x),f=F(n,.001);if(Math.abs(s.xmin-l[0])<f&&Math.abs(s.xmax-l[1])<f){let i=Math.abs(t.xmin-c[0]),a=Math.abs(c[1]-t.xmax);if(i<u&&a>d){s.xmin=l[0];let i=[];i.push(new e(t.xmax,t.ymin,o)),i.push(new e(t.xmax,(t.ymin+t.ymax)/2,o)),i.push(new e(t.xmax,t.ymax,o));let a=i.map(e=>I(e,n,r)).filter(e=>!isNaN(e?.x)).map(e=>e.x);s.xmax=Math.max.apply(null,a)}if(a<u&&i>d){s.xmax=l[1];let i=[];i.push(new e(t.xmin,t.ymin,o)),i.push(new e(t.xmin,(t.ymin+t.ymax)/2,o)),i.push(new e(t.xmin,t.ymax,o));let a=i.map(e=>I(e,n,r)).filter(e=>!isNaN(e?.x)).map(e=>e.x);s.xmin=Math.min.apply(null,a)}}else{let e=F(n,.001);Math.abs(s.xmin-l[0])<e&&(s.xmin=l[0]),Math.abs(s.xmax-l[1])<e&&(s.xmax=l[1])}return s}function q(e,t=!1){if(!e)return null;let n=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*n:e.wkid&&e.isGeographic?360:2*v[e.wkid]||null}function J(e,t=!1){if(e.isGeographic)return[-180,180];let n=q(e,t);return n==null?null:[-n/2,n/2]}function Y(e,t,n,r){let i=(e-t)/n;return i-Math.floor(i)===0?r&&--i:i=Math.floor(i),i}function X(e,t=!1){let n=q(e.spatialReference);if(n==null)return 0;let r=t?0:-(n/2),i=F(e.spatialReference),a=!t&&Math.abs(e.xmax-n/2)<i?n/2:e.xmax,o=!t&&Math.abs(e.xmin+n/2)<i?-n/2:e.xmin;return Y(a,r,n,!0)-Y(o,r,n,!1)}function ie(e){let t=e.storageInfo.origin.x,n=q(e.spatialReference,!0);if(n==null)return{originX:t,halfWorldWidth:null,pyramidsInfo:null};let r=n/2,{nativePixelSize:i,storageInfo:a,extent:o}=e,{maximumPyramidLevel:s,blockWidth:c,pyramidScalingFactor:l}=a,u=i.x,d=[],f=e.transform!=null&&e.transform.type===`gcs-shift`,p=t+(f?0:r),m=f?n-t:r-t;for(let e=0;e<=s;e++){let e=(o.xmax-t)/u/c,n=e-Math.floor(e)===0?e:Math.ceil(e),r=m/u/c,i=r-Math.floor(r)===0?r:Math.ceil(r),a=Math.floor(p/u/c),s=Math.round(p/u)%c,f=(c-Math.round(m/u)%c)%c;d.push({resolutionX:u,blockWidth:c,datasetColumnCount:n,worldColumnCountFromOrigin:i,leftMargin:s,rightPadding:f,originColumnOffset:a}),u*=l}return{originX:t,halfWorldWidth:r,pyramidsInfo:d,hasGCSSShiftTransform:f}}function ae(e){if(!e||e.isGeographic)return e;let t=String(e.wkid||e.wkt2||e.wkt),n;return b.has(t)?n=b.get(t):(n=(e.wkid?o.coordsys(e.wkid):o.fromString(d.PE_TYPE_PROJCS,e.wkt2||e.wkt)).getGeogcs().getCode(),b.set(t,n)),new i({wkid:n})}function oe(e){let t=e.isAdaptive&&e.spacing==null,n=e.spacing||[32,32],r=Z(e),i={cols:r.size[0]+1,rows:r.size[1]+1},a=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2,o=r.outofBoundPointCount===r.offsets.length/2||t&&a?[0,0]:_(r.offsets,i,n,4),s=(o[0]+o[1])/2,c=e.projectedExtent.spatialReference,l=e.srcBufferExtent.spatialReference;if(t&&(a||s>4)&&(c.isGeographic||V(c),n=[4,4],r=Z({...e,spacing:n}),i={cols:r.size[0]+1,rows:r.size[1]+1},o=_(r.offsets,i,n,4)),r.error=o,n[0]>1&&(r.coefficients=Q(r.offsets,i,a)),e.includeGCSGrid&&!c.isGeographic&&!c.isWebMercator)if(l.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:n};else{let t=V(c);if(t!=null&&!t.isEnvelope){let t=ae(c),o=G(e.projectedExtent,t),{offsets:s}=Z({...e,srcBufferExtent:o,spacing:n}),l=Q(s,i,a);r.gcsGrid={offsets:s,coefficients:l,spacing:n}}}return r}function Z(t){let{projectedExtent:n,srcBufferExtent:r,pixelSize:i,datumTransformation:a,rasterTransform:o}=t,s=n.spatialReference,c=r.spatialReference;g();let{xmin:l,ymin:u,xmax:d,ymax:f}=n,p=q(c),m=p!=null&&(t.hasWrapAround||o?.type===`gcs-shift`),h=t.spacing||[32,32],_=h[0]*i.x,v=h[1]*i.y,y=h[0]===1,b=Math.ceil((d-l)/_-.1/h[0])+(y?0:1),S=Math.ceil((f-u)/v-.1/h[1])+(y?0:1),C=R({cols:b,rows:S,xmin:l,ymax:f,xres:_,yres:v,inSR:s,outSR:c,datumTransformation:a,preferPE:h[0]<=4,usePixelCenter:y}),w=[],T,E=0,D=y?-1:NaN,{xmin:O,xmax:k,ymax:A,width:j,height:M}=r,N=F(c,x),P=p!=null&&O>0&&k>p/2,I=V(s),L=I!=null&&I.poleLocation>0;for(let t=0;t<b;t++){let n=[];for(let r=0;r<S;r++){let i=C[t*S+r];if(m&&i[0]>k&&i[0]>p/2-N?i[0]-=p:m&&t===0&&i[0]<0&&P&&!o&&(i[0]+=p),!i||isNaN(i[0])||isNaN(i[1]))w.push(D),w.push(D),n.push(null),E++;else{if(o){let t=o.inverseTransform(new e({x:i[0],y:i[1],spatialReference:c}));i=[t.x,t.y]}n.push(i),t>0&&m&&T[r]&&i[0]<T[r][0]&&(i[0]+=p,L&&i[0]>k&&i[0]>p&&(i[0]-=p)),w.push((i[0]-O)/j),w.push((A-i[1])/M)}}T=n}return{offsets:w,error:null,coefficients:null,outofBoundPointCount:E,spacing:h,size:y?[b,S]:[b-1,S-1]}}function Q(e,t,n){let{cols:r,rows:i}=t,a=new Float32Array((r-1)*(i-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),s=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let t=0;t<r-1;t++){for(let n=0;n<i-1;n++){let c=t*i*2+2*n,l=e[c],u=e[c+1],d=e[c+2],f=e[c+3];c+=2*i;let p=e[c],m=e[c+1],h=e[c+2],g=e[c+3],_=0,v=12*(n*(r-1)+t);for(let e=0;e<3;e++)a[v++]=o[_++]*l+o[_++]*d+o[_++]*h;_=0;for(let e=0;e<3;e++)a[v++]=o[_++]*u+o[_++]*f+o[_++]*g;_=0;for(let e=0;e<3;e++)a[v++]=s[_++]*l+s[_++]*p+s[_++]*h;_=0;for(let e=0;e<3;e++)a[v++]=s[_++]*u+s[_++]*m+s[_++]*g}if(n)for(let e=0;e<a.length;e++)isNaN(a[e])&&(a[e]=-1)}return a}function se(e,t){let n=e.clone().normalize();return n.length===1?n[0]:W(n,t)}function ce(e){let{spatialReference:t}=e,n=p(t);if(!n)return e;let[i,a]=n.valid,o=a-i,s=0;if(e.xmin<i){let t=i-e.xmin;s=Math.ceil(t/o)}else if(e.xmin>a){let t=e.xmin-a;s=-Math.ceil(t/o)}return new r({spatialReference:e.spatialReference,xmin:e.xmin+s*o,ymin:e.ymin,xmax:e.xmax+s*o,ymax:e.ymax})}function le(t,n,r){let{storageInfo:i,pixelSize:a}=n,o=0,s=!1,{pyramidResolutions:c}=i,l=i.tileInfo.format?.toLowerCase()===`mixed`?Math.max(1,Math.min(3,i.tileInfo.dpi/96)):1,d=(t.x+t.y)/2/l;if(c!=null&&c.length){let t=c[c.length-1],i=(t.x+t.y)/2,l=(a.x+a.y)/2;if(d<=l)o=0;else if(d>=i)o=c.length,s=d/i>8;else{let e,t=l;for(let n=1;n<=c.length;n++){if(e=(c[n-1].x+c[n-1].y)/2,d<=e){d===e?o=n:r===`down`?(o=n-1,s=d/t>8):o=r===`up`||d-t>e-d||d/t>2?n:n-1;break}t=e}}let f=o===0?a:c[o-1];return s&&Math.min(f.x,f.y)*u(n.spatialReference)>19567&&(s=!1),{pyramidLevel:o,pyramidResolution:new e({x:f.x,y:f.y,spatialReference:n.spatialReference}),excessiveReading:s}}let f=Math.log(t.x/a.x)/Math.LN2,p=Math.log(t.y/a.y)/Math.LN2,m=n.storageInfo.maximumPyramidLevel||0;o=r===`down`?Math.floor(Math.min(f,p)):r===`up`?Math.ceil(Math.max(f,p)):Math.round((f+p)/2),o<0?o=0:o>m&&(s=o>m+3,o=m);let h=2**o;return{pyramidLevel:o,pyramidResolution:new e({x:h*n.nativePixelSize.x,y:h*n.nativePixelSize.y,spatialReference:n.spatialReference}),excessiveReading:s}}function $(e,t,n=!1){let{pixelSize:r,extent:i}=e,a=k(i,t,!1),o=G(se(i,(r.x+r.y)/16),t,a);return!o||n||X(o)===0?o:K(i,t,a)}function ue(e,t,n){let r=n?.tileSize??512,a=n?.alignGlobalDatasetWithAGOL??!0,o=!!n?.limitToSrcResolution,{extent:s,spatialReference:c,pixelSize:l}=e,u=M(l,t,s);if(u==null)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};let d=(u.x+u.y)/2,f=N(d,t),p=t.isGeographic?256/r*295828763.7958547:256/r*591657527.591555,m=e.dataType===`vector-magdir`||e.dataType===`vector-uv`,h=$(e,t,!0),g=Math.min(Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),Math.ceil(Math.log(p/2/f)/Math.LN2));if(!m&&h&&a&&(t.isGeographic||t.isWebMercator)){let n=q(t);if(m=X(h)>0||n!=null&&h.width>n/4,!m&&n!=null){let t=-1;if(g<3)t=2**g*d*r;else if(e.storageInfo){let{maximumPyramidLevel:n=0,pyramidScalingFactor:i=2}=e.storageInfo;t=i**n*d*r}let i=Math.ceil(n/t);m=i===1||i===2&&n/2-h.xmax<t}}let _,v=f,y=1.001,b=Math.min(2,Math.max(1.414,e.storageInfo?.pyramidScalingFactor||2));if(m){v=p;let n=t.isGeographic?1341104507446289e-21:.29858214164761665,r=N(n,t),a=t.isGeographic?4326:3857;_=M({x:n,y:n},c,$(e,new i({wkid:a}),!0)),_.x*=v/r,_.y*=v/r}else{_={x:l.x,y:l.y};let e=0;for(;v<p*(y/2)&&e<g;)e++,v*=b,_.x*=b,_.y*=b;Math.max(v,p)/Math.min(v,p)<=y&&(v=p)}let x=[v],S=[{x:_.x,y:_.y}],C=Math.min(70.5310735,f)/y;for(;v>=C;)v/=b,_.x/=b,_.y/=b,x.push(v),S.push({x:_.x,y:_.y});if(o){let e=.001*l.x,t=S.findIndex(t=>t.x>=l.x-e&&t.x<=l.x+e);t>-1?(S.length=t+1,x.length=t+1):(t=S.findIndex(t=>t.x<=l.x+e),t>0&&(S.length=t,x.length=t))}return{projectedPixelSize:u,scales:x,srcResolutions:S,isCustomTilingScheme:!m}}function de(e){let t=0;for(let n of e){let e=n.length,r=n[0][0]*(n[1][1]-n[e-2][1]);for(let t=1;t<e-1;t++)r+=n[t][0]*(n[t+1][1]-n[t-1][1]);t+=r/2}return Math.abs(t)}export{ne as a,le as c,ue as d,X as f,k as h,P as i,ie as l,$ as m,A as n,I as o,oe as p,G as r,ce as s,q as t,O as u};