import{Il as e,Jg as t,Jl as n,Qg as r,Wl as i,Xl as a,ab as o,au as s,iu as c,ru as l}from"./index-BqmCqmfp.js";import{t as u}from"./vectorStacks-CKtslZxP.js";import{k as d}from"./sphere-CicnK0Bn.js";function f(e){return e?{origin:r(e.origin),vector:r(e.vector)}:{origin:t(),vector:t()}}function p(e,t){let n=T.get();return n.origin=e,n.vector=t,n}function m(e,t=f()){return h(e.origin,e.vector,t)}function h(e,t,n=f()){return l(n.origin,e),l(n.vector,t),n}function g(e,t,n=f()){return l(n.origin,e),i(n.vector,t,e),n}function _(t,r){let a=i(u.get(),r,t.origin),s=e(t.vector,a),c=e(t.vector,t.vector),l=o(s/c,0,1),d=i(u.get(),n(u.get(),t.vector,l),a);return e(d,d)}function v(e,t,n){return b(e,t,0,1,n)}function y(e,t,r){return c(r,e.origin,n(r,e.vector,t))}function b(t,r,s,l,d){let{vector:f,origin:p}=t,m=i(u.get(),r,p),h=e(f,m)/a(f);return n(d,f,o(h,s,l)),c(d,d,t.origin)}function x(e,t){if(C(e,p(t.origin,t.direction),!1,w)){let{tA:t,pB:n,distance2:r}=w;if(t>=0&&t<=1)return r;if(t<0)return s(e.origin,n);if(t>1)return s(c(u.get(),e.origin,e.vector),n)}return null}function S(e,t,n){return!!C(e,t,!0,w)&&(l(n,w.pA),!0)}function C(e,t,n,r){let i=1e-6,a=e.origin,l=c(u.get(),a,e.vector),d=t.origin,f=c(u.get(),d,t.vector),p=u.get(),m=u.get();if(p[0]=a[0]-d[0],p[1]=a[1]-d[1],p[2]=a[2]-d[2],m[0]=f[0]-d[0],m[1]=f[1]-d[1],m[2]=f[2]-d[2],Math.abs(m[0])<i&&Math.abs(m[1])<i&&Math.abs(m[2])<i)return!1;let h=u.get();if(h[0]=l[0]-a[0],h[1]=l[1]-a[1],h[2]=l[2]-a[2],Math.abs(h[0])<i&&Math.abs(h[1])<i&&Math.abs(h[2])<i)return!1;let g=p[0]*m[0]+p[1]*m[1]+p[2]*m[2],_=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],v=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],y=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],b=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*y-_*_;if(Math.abs(b)<i)return!1;let x=(g*_-v*y)/b,S=(g+_*x)/y;n&&(x=o(x,0,1),S=o(S,0,1));let C=u.get(),w=u.get();return C[0]=a[0]+x*h[0],C[1]=a[1]+x*h[1],C[2]=a[2]+x*h[2],w[0]=d[0]+S*m[0],w[1]=d[1]+S*m[1],w[2]=d[2]+S*m[2],r.tA=x,r.tB=S,r.pA=C,r.pB=w,r.distance2=s(C,w),!0}var w={tA:0,tB:0,pA:t(),pB:t(),distance2:0},T=new d(()=>f());export{x as a,y as c,f as d,g as i,p as l,S as n,h as o,_ as r,v as s,b as t,m as u};