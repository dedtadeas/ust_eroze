const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bundle-BhivahkI.js","assets/bundle-BMKKOu1E.js"])))=>i.map(i=>d[i]);
import{$T as e,Cw as t,Sw as n,_E as r,nC as i}from"./index-BqmCqmfp.js";import{t as a}from"./QueueProcessor-C8_CgXms.js";import{c as o,d as s,o as c,s as l}from"./bundle-BMKKOu1E.js";var u=null;async function d(){return u||=f(),u}async function f(){let e=await t(()=>import(`./bundle-BhivahkI.js`),__vite__mapDeps([0,1]));return await e.default({module_or_path:i(`esri/libs/parquet/pkg/bundle_bg.wasm`)}),e}var p=new a({concurrency:8,process:async e=>{let{data:t}=await n(e.url,e.options);return t}}),m=e=>async function(t,n,r,i){let a=e?.()??{};return await p.push({url:t,options:{responseType:`array-buffer`,query:a,headers:{range:`bytes=${n}-${r}`}}})},h=t=>async function(r){if(e(r)){let{data:e}=await n(r,{responseType:`blob`});return e.size}let{data:i}=await n(r,{responseType:`native`,method:`head`,query:t?.()}),a=i.headers.get(`Content-Length`);if(a==null)throw Error(`Unable to parse content length`);return parseInt(a,10)};function g(e){switch(e){case`esriGeometryPoint`:return c.Point;case`esriGeometryPolygon`:return c.Polygon;case`esriGeometryPolyline`:return c.Polyline;case`esriGeometryMultipoint`:return c.Multipoint;default:throw new r(`parquet`,`Found unexpected GeometryType: ${e}`)}}function _(e){switch(e.encoding.type){case`wkb`:return s.fromWkb(e.encoding.primaryFieldName);case`location`:{let{latitudeFieldName:t,longitudeFieldName:n}=e.encoding;return s.fromLocation(t,n)}}}function v(e,t){let n=e.spatialReference.wkid,i=t.wkid;if(!n||!i)throw new r(`parquet`,`Unable to create ParquetFile, in and out wkid must be specified`);let a=g(e.geometryType),s=_(e),c=[];if(e.displayOptimization?.mode===`xz`){let t=e.displayOptimization.multiscale;for(let e of t.levels??[]){let[t,n]=e.transform.translate,[r,i]=e.transform.scale,a=new Float64Array([t,n]),s=new Float64Array([r,i]);c.push(o.new(e.level,e.column,a,s))}}return l.new(a,n,i,s,c)}async function y(e,t={}){let{ParquetFile:n}=await d(),r=m(t.getCustomParameters),i=h(t.getCustomParameters),a=t.geometryInfo?v(t.geometryInfo,t.outSpatialReference??t.geometryInfo.spatialReference):null;return n.fromUrl(e,r,i,a)}function b(e){let t=e.keyValueMetadata(`geo`);return t==null?null:JSON.parse(t)}function x(e){let t=e.keyValueMetadata(`esri`);return t==null?null:JSON.parse(t)}export{x as n,b as r,y as t};