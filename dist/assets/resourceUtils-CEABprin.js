import{Sw as e,XT as t,YT as n,_E as r}from"./index-BqmCqmfp.js";async function i(e,n={},r){await e.load(r);let i=t(e.itemUrl,`resources`),{start:a=1,num:o=10,sortOrder:s=`asc`,sortField:c=`resource`}=n,l={query:{start:a,num:o,sortOrder:s,sortField:c,token:e.apiKey},signal:r?.signal},u=await e.portal.request(i,l);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map(({created:t,size:n,resource:r})=>({created:new Date(t),size:n,resource:e.resourceFromPath(r)}))}}async function a(e,n,i,a){let o=new Map;for(let{resource:e,content:t,compress:a,access:s}of n){if(!e.hasPath())throw new r(`portal-item-resource-${i}:invalid-path`,`Resource does not have a valid path`);let[n,l]=c(e.path),u=`${n}/${a??``}/${s??``}`;o.has(u)||o.set(u,{prefix:n,compress:a,access:s,files:[]}),o.get(u).files.push({fileName:l,content:t})}await e.load(a);let s=t(e.userItemUrl,i===`add`?`addResources`:`updateResources`);for(let{prefix:t,compress:n,access:r,files:i}of o.values())for(let o=0;o<i.length;o+=25){let c=i.slice(o,o+25),l=new FormData;t&&t!==`.`&&l.append(`resourcesPrefix`,t),n&&l.append(`compress`,`true`),r&&l.append(`access`,r);let u=0;for(let{fileName:e,content:t}of c)l.append(`file`+ ++u,t,e);l.append(`f`,`json`),await e.portal.request(s,{method:`post`,body:l,signal:a?.signal})}}async function o(e,n,i){if(!n.hasPath())throw new r(`portal-item-resources-remove:invalid-path`,`Resource does not have a valid path`);await e.load(i);let a=t(e.userItemUrl,`removeResources`);await e.portal.request(a,{method:`post`,query:{resource:n.path},signal:i?.signal}),n.portalItem=null}async function s(e,n){await e.load(n);let r=t(e.userItemUrl,`removeResources`);return e.portal.request(r,{method:`post`,query:{deleteAll:!0},signal:n?.signal})}function c(e){let t=e.lastIndexOf(`/`);return t===-1?[`.`,e]:[e.slice(0,t),e.slice(t+1)]}function l(e){let[t,n]=u(e),[r,i]=c(t);return[r,i,n]}function u(e){let t=n(e);return t==null?[e,``]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function d(t){return t.type===`blob`?t.blob:t.type===`json`?new Blob([t.jsonString],{type:`application/json`}):(await e(t.url,{responseType:`blob`})).data}function f(e,n){if(!e.hasPath())return null;let[r,,i]=l(e.path);return e.portalItem.resourceFromPath(t(r,n+i))}export{o as a,f as i,s as n,i as o,l as r,d as s,a as t};