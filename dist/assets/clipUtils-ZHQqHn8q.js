const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/intersectsOperator-Bn_EeLF_.js","assets/UnitFactory-J9WMNXdY.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css","assets/Envelope2D-BNwQDrOT.js","assets/Point2D-UYEfE6HP.js","assets/OperatorDefinitions-DQQu7-BK.js","assets/SimpleGeometryCursor-CI9GIWKa.js","assets/Transformation2D-DVoPQwGC.js","assets/OperatorIntersects-2BeH-u8U.js","assets/intersectsOperator-BvtmyepE.js","assets/apiConverter-DVPFZqjR.js","assets/jsonConverter-DiNOXEUJ.js","assets/containsOperator-va-rM7Xc.js","assets/containsOperator-B0cSEe_K.js"])))=>i.map(i=>d[i]);
import{Ax as e,Cw as t,Sx as n,aS as r}from"./index-BqmCqmfp.js";import{t as i}from"./PixelBlock-CjVaas_l.js";function a(e,t){if(e.spatialReference.equals(t))return e;let n=r(e.spatialReference),i=r(t);if(n===i)return e;let a=n/i;return{x:e.x*a,y:e.y*a}}async function o(e,n,r){if(r.type===`extent`)return u(e,n,r);let{width:a,height:o}=e,c=new Uint8Array(a*o);return(await t(async()=>{let{execute:e}=await import(`./intersectsOperator-Bn_EeLF_.js`);return{execute:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))).execute(n,r)?r.type===`polyline`?d(e,n,r):(await t(async()=>{let{execute:e}=await import(`./containsOperator-va-rM7Xc.js`);return{execute:e}},__vite__mapDeps([13,1,2,3,4,5,6,7,8,14,11,12]))).execute(r,n)?e:s(e,n,r):new i({pixelType:e.pixelType,width:a,height:o,mask:c,maskIsAlpha:!1,pixels:[...e.pixels]})}function s(e,t,n){if(!e)return e;let{width:r,height:a}=e,o=c({geometry:n,size:[r,a],srcExtent:t,srcMask:e.mask});return new i({pixelType:e.pixelType,width:r,height:a,mask:o,maskIsAlpha:!1,pixels:[...e.pixels]})}function c(e){let{geometry:t,size:n,srcExtent:r,srcMask:i}=e,[a,o]=n,s,c=r.width/a,u=r.height/o,{xmin:d,ymax:f}=r;if(t.type===`extent`){let e=(t.xmin-d)/c,n=(t.xmax-d)/c,r=(f-t.ymax)/u,i=(f-t.ymin)/u;s=[[[e,r],[e,i],[n,i],[n,r],[e,r]]]}else s=t.rings.map(e=>e.map(([e,t])=>[(e-d)/c,(f-t)/u]));return l(s,n,i)}function l(e,t,n){let[r,i]=t,a=new OffscreenCanvas(r,i).getContext(`2d`);a.fillStyle=`#f00`,a.beginPath(),e.forEach(e=>{a.moveTo(e[0][0],e[0][1]);for(let t=0;t<e.length;t++)a.lineTo(e[t][0],e[t][1]);a.closePath()}),a.fill();let o=a.getImageData(0,0,r,i).data,s=r*i,c=new Uint8Array(s),l=!1;for(let e=0;e<s;e++)n&&!n[e]||(o[4*e+3]>127?c[e]=255:l=!0);return l||n?c:void 0}function u(e,t,n){let{width:r,height:a}=e,o=new Uint8Array(r*a),s=t.width/r,c=t.height/a;if(n.width/s<.5||n.height/c<.5)return new i({pixelType:e.pixelType,width:r,height:a,mask:o,pixels:[...e.pixels]});let{xmin:l,xmax:u,ymin:d,ymax:f}=t,{xmin:p,xmax:m,ymin:h,ymax:g}=n,_=Math.max(l,p),v=Math.min(u,m),y=Math.max(d,h),b=Math.min(f,g),x=.5*s,S=.5*c;if(v-_<x||b-y<S||v<l+x||_>u-x||y>f-S||b<d+S)return new i({pixelType:e.pixelType,width:r,height:a,mask:o,pixels:[...e.pixels]});let C=Math.max(0,(_-l)/s),w=Math.min(r,Math.max(0,(v-l)/s)),T=Math.max(0,(f-b)/c),E=Math.min(a,Math.max(0,(f-y)/c)),D=Math.round(C),O=Math.round(w)-1,k=Math.round(T),A=Math.round(E)-1;if(D===O&&C%1>.5&&w%1<.5||k===A&&T%1>.5&&E%1<.5)return new i({pixelType:e.pixelType,width:r,height:a,mask:o,pixels:[...e.pixels]});if(D===0&&k===0&&O===r&&A===a)return e;let j=e.mask;for(let e=k;e<=A;e++)for(let t=D;t<=O;t++){let n=e*r+t;o[n]=j?j[n]:255}return new i({pixelType:e.pixelType,width:r,height:a,mask:o,pixels:[...e.pixels]})}function d(e,t,n){let{width:r,height:a}=e,o=new Uint8Array(r*a),s=t.width/r,c=t.height/a,{xmin:l,ymax:u}=t,{paths:d}=n,f=e.mask;for(let e=0;e<d.length;e++){let t=d[e];for(let e=0;e<t.length-1;e++){let[n,i]=t[e],[d,p]=t[e+1],m=Math.min(i,p),h=Math.max(i,p),g=Math.max(0,Math.floor((u-h)/c)),_=Math.min(a-1,Math.floor((u-m)/c));if(!(_<g))if(g===_){let e=Math.min(n,d),t=Math.max(n,d),i=Math.max(0,Math.floor((e-l)/s)),a=Math.min(r-1,Math.floor((t-l)/s));if(a<i)continue;let c=g*r;for(let e=c+i;e<=c+a;e++)o[e]=f?f[e]:255}else{let e=(n-l)/s,t=(d-n)/(p-i)/s,a=c*t;for(let n=g;n<=_;n++){let s=t*(u-n*c-i)+e,l=Math.max(0,Math.floor(a>0?s-a:s)),d=Math.min(r-1,Math.floor(a>0?s:s-a));if(d<l)continue;let p=n*r;for(let e=p+l;e<=p+d;e++)o[e]=f?f[e]:255}}}}return new i({pixelType:e.pixelType,width:r,height:a,mask:o,pixels:[...e.pixels]})}function f(t,n){let{extent:r}=p(t,n,new e({x:t.pixelSize.x,y:t.pixelSize.y,spatialReference:t.spatialReference})),{extent:i}=t.extent;if(r.xmax=Math.min(r.xmax,i.xmax),r.ymax=Math.min(r.ymax,i.ymax),r.xmin<r.xmax&&r.ymin<r.ymax){let{x:e,y:n}=t.pixelSize,i=Math.round(r.width/e),a=Math.round(r.height/n);t.extent=r,t.width=i,t.height=a}}function p(e,t,r,i=!0){let{spatialReference:o}=e,{x:s,y:c}=a(r,o),l,u,d,{xmin:f,xmax:p,ymax:m,ymin:h}=t.type===`extent`?t:t.extent,{xmin:g,ymax:_}=e.extent;return i?(f=g+(f>g?s*Math.round((f-g)/s):0),m=_-(m<_?c*Math.round((_-m)/c):0),p=g+(p>g?s*Math.round((p-g)/s):0),h=_-(h<_?c*Math.round((_-h)/c):0),l=new n({xmin:f,ymax:m,xmax:p,ymin:h,spatialReference:o}),u=Math.round(l.width/s),d=Math.round(l.height/c)):(u=Math.floor((p-f)/s+.8),d=Math.floor((m-h)/c+.8),f=g+(f>g?s*Math.floor((f-g)/s+.1):0),m=_-(m<_?c*Math.floor((_-m)/c+.1):0),p=f+u*s,h=m-d*c,l=new n({xmin:f,ymax:m,xmax:p,ymin:h,spatialReference:o})),{extent:l,width:u,height:d}}export{o as i,f as n,p as r,c as t};