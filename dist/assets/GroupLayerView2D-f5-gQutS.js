import{CD as e,Kb as t,MC as n,SC as r,Vb as i,bC as a,kC as o,xC as s}from"./index-BqmCqmfp.js";import"./layerViewUtils-Bbe7IKvz.js";import"./Container-DgT8F3N0.js";import"./EffectView-CvH-XuUh.js";import{t as c}from"./LayerView2D-DVE2Teoj.js";import{t as l}from"./LayerView-DKEUJRIQ.js";var u=class extends l{constructor(e){super(e),this.type=`group`,this.layerViews=new r}destroy(){this.layerViews.length=0}_allLayerViewVisibility(e){this.layerViews.forEach(t=>{t.visible=e})}initialize(){this.addHandles([this.layerViews.on(`change`,e=>this._layerViewsChangeHandler(e)),t(()=>this.layer?.visibilityMode,()=>{this.layer&&this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(null))},i),t(()=>this.visible,e=>{this._applyVisibility(()=>this._allLayerViewVisibility(e),()=>{})},i)],`grouplayerview`),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}get creatingLayerViews(){return this.view?.layerViewManager?.isCreatingLayerViewsForLayer(this.layer)??!1}set layerViews(e){this._set(`layerViews`,s(e,this._get(`layerViews`)))}get updatingProgress(){return this.layerViews.length===0?1:this.layerViews.reduce((e,t)=>e+t.updatingProgress,0)/this.layerViews.length}isUpdating(){return this.creatingLayerViews||this.layerViews.some(e=>e.updating)}_hasLayerViewVisibleOverrides(){return this.layerViews.some(e=>e._isOverridden(`visible`))}_findLayerViewForLayer(e){return e&&this.layerViews.find(t=>t.layer===e)}_firstVisibleOnLayerOrder(){let e=this.layer.layers.find(e=>!!this._findLayerViewForLayer(e)?.visible);return e&&this._findLayerViewForLayer(e)}_applyExclusiveVisibility(e){e==null&&(e=this._firstVisibleOnLayerOrder())==null&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.at(0))),this.layerViews.forEach(t=>{t.visible=t===e})}_layerViewsChangeHandler(e){this.removeHandles(`grouplayerview:visible`),this.addHandles(this.layerViews.map(e=>t(()=>e.visible,t=>this._applyVisibility(()=>{t!==this.visible&&(e.visible=this.visible)},()=>this._applyExclusiveVisibility(t?e:null)),i)).toArray(),`grouplayerview:visible`);let n=e.added[e.added.length-1];this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(n?.visible?n:null))}_applyVisibility(e,t){this._hasLayerViewVisibleOverrides()&&(this.layer?.visibilityMode===`inherited`?e():this.layer?.visibilityMode===`exclusive`&&t())}};e([n({readOnly:!0})],u.prototype,`creatingLayerViews`,null),e([n({cast:a})],u.prototype,`layerViews`,null),e([n({readOnly:!0})],u.prototype,`updatingProgress`,null),e([n()],u.prototype,`view`,void 0),u=e([o(`esri.views.layers.GroupLayerView`)],u);var d=class extends c(u){attach(){this._updateStageChildren(),this.addAttachHandles(this.layerViews.on(`after-changes`,()=>this._updateStageChildren()))}detach(){this.container.removeAllChildren()}update(e){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,t)=>this.container.addChildAt(e.container,t))}};d=e([o(`esri.views.2d.layers.GroupLayerView2D`)],d);var f=d;export{f as default};