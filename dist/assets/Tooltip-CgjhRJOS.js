import{D as e,Tt as t,V as n,Yt as r,d as i,i as a,lt as o,n as s,z as c,zt as l}from"./Theme-Dpr4FPaR.js";var u=class extends i{_beforeChanged(){super._beforeChanged(),(this.isDirty(`pointerBaseWidth`)||this.isDirty(`cornerRadius`)||this.isDirty(`pointerLength`)||this.isDirty(`pointerX`)||this.isDirty(`pointerY`)||this.isDirty(`width`)||this.isDirty(`height`))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){this.markDirtyBounds();let t=this.width(),n=this.height();if(t>0&&n>0){let r=this.get(`cornerRadius`,8);r=e(r,0,Math.min(t/2,n/2));let i=this.get(`pointerX`,0),a=this.get(`pointerY`,0),o=this.get(`pointerBaseWidth`,15)/2,s=t,c=t,l=n,u=n,d=(i-0)*(l-0)-(a-0)*(c-0),f=(i-0)*(0-u)-(a-u)*(s-0),p=this._display;if(p.moveTo(r,0),d>0&&f>0){let n=Math.round(e(i,r+o,t-o-r));a=e(a,-1/0,0),p.lineTo(n-o,0),p.lineTo(i,a),p.lineTo(n+o,0)}if(p.lineTo(t-r,0),p.arcTo(t,0,t,r,r),d>0&&f<0){let s=Math.round(e(a,r+o,n-o-r));i=e(i,t,1/0),p.lineTo(t,r),p.lineTo(t,Math.max(s-o,r)),p.lineTo(i,a),p.lineTo(t,s+o)}if(p.lineTo(t,n-r),p.arcTo(t,n,t-r,n,r),d<0&&f<0){let s=Math.round(e(i,r+o,t-o-r));a=e(a,n,1/0),p.lineTo(t-r,n),p.lineTo(s+o,n),p.lineTo(i,a),p.lineTo(s-o,n)}if(p.lineTo(r,n),p.arcTo(0,n,0,n-r,r),d<0&&f>0){let t=Math.round(e(a,r+o,n-r-o));i=e(i,-1/0,0),p.lineTo(0,n-r),p.lineTo(0,t+o),p.lineTo(i,a),p.lineTo(0,Math.max(t-o,r))}p.lineTo(0,r),p.arcTo(0,0,r,0,r),p.closePath()}}}};Object.defineProperty(u,`className`,{enumerable:!0,configurable:!0,writable:!0,value:`PointedRectangle`}),Object.defineProperty(u,`classNames`,{enumerable:!0,configurable:!0,writable:!0,value:i.classNames.concat([u.className])});var d=class extends a{constructor(e,t,n,r=[]){super(e,t,n,r),Object.defineProperty(this,`_fx`,{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,`_fy`,{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,`_label`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_fillDp`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_fillGrDp`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_strokeDp`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_labelDp`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_w`,{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,`_h`,{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,`_keepHoverDp`,{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,`_htmlContentHovered`,{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._settings.themeTags=o(this._settings.themeTags,[`tooltip`]),super._afterNew(),this._setDefaultFn(`background`,()=>u.new(this._root,{})).set(`themeTags`,[`tooltip`,`background`]),this._label=this.children.push(s.new(this._root,{})),this._disposers.push(this._label.events.on(`boundschanged`,()=>{this._updateBackground()})),this._disposers.push(this.on(`bounds`,()=>{this._updateBackground()})),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate(`htmlElement`,e=>{e&&(this._disposers.push(n(e,`pointerover`,e=>{this._htmlContentHovered=!0})),this._disposers.push(n(e,`pointerout`,e=>{this._htmlContentHovered=!1})))})),this.on(`visible`,e=>{this._handleReaderAnnouncement()}),this.label.events.on(`dataitemchanged`,e=>{this._handleReaderAnnouncement()}),this._root._tooltips.push(this)}_handleReaderAnnouncement(){this.get(`readerAnnounce`)&&this.isVisibleDeep()&&this._root.readerAlert(this.label.getAccessibleText())}get label(){return this._label}_dispose(){super._dispose(),l(this._root._tooltips,this)}_updateChildren(){super._updateChildren(),(this.isDirty(`pointerOrientation`)||this.isPrivateDirty(`minWidth`)||this.isPrivateDirty(`minHeight`))&&this.get(`background`)._markDirtyKey(`width`),this.get(`labelText`)!=null&&this.label.set(`text`,this.get(`labelText`)),this.get(`labelHTML`)!=null&&this.label.set(`html`,this.get(`labelHTML`)),this.get(`labelAriaLabel`)!=null&&this.label.set(`ariaLabel`,this.get(`labelAriaLabel`))}_changed(){if(super._changed(),(this.isDirty(`pointTo`)||this.isDirty(`pointerOrientation`))&&this._updateBackground(),this.isDirty(`tooltipTarget`)&&this.updateBackgroundColor(),this.isDirty(`keepTargetHover`))if(this.get(`keepTargetHover`)){let e=this.get(`background`);this._keepHoverDp=new t([e.events.on(`pointerover`,e=>{let t=this.get(`tooltipTarget`);t&&(t.parent&&t.parent.getPrivate(`tooltipTarget`)==t&&(t=t.parent),t.hover())}),e.events.on(`pointerout`,e=>{let t=this.get(`tooltipTarget`);t&&(t.parent&&t.parent.getPrivate(`tooltipTarget`)==t&&(t=t.parent),this._htmlContentHovered||t.unhover())})]),this.label.onPrivate(`htmlElement`,t=>{this._keepHoverDp&&t&&this._keepHoverDp.disposers.push(n(t,`pointerleave`,t=>{let n=this.root._renderer.getEvent(t);e.events.dispatch(`pointerout`,{type:`pointerout`,originalEvent:n.event,point:n.point,simulated:!1,target:e})}))})}else this._keepHoverDp&&=(this._keepHoverDp.dispose(),void 0)}_onShow(){super._onShow(),this.updateBackgroundColor()}updateBackgroundColor(){let e=this.get(`tooltipTarget`),t=this.get(`background`),n,r;if(e&&t){if(n=e.get(`fill`),r=e.get(`stroke`),n??=r,this.get(`getFillFromSprite`)&&(this._fillDp&&this._fillDp.dispose(),n!=null&&t.set(`fill`,n),this._fillDp=e.on(`fill`,e=>{e!=null&&(t.set(`fill`,e),this._updateTextColor(e))}),this._disposers.push(this._fillDp)),this.get(`getFillGradientFromSprite`)){this._fillGrDp&&this._fillGrDp.dispose();let n=e.get(`fillGradient`);n!=null&&t.set(`fillGradient`,n),this._fillGrDp=e.on(`fillGradient`,e=>{e!=null&&t.set(`fillGradient`,e)}),this._disposers.push(this._fillGrDp)}this.get(`getStrokeFromSprite`)&&(this._strokeDp&&this._strokeDp.dispose(),n!=null&&t.set(`stroke`,n),this._strokeDp=e.on(`fill`,e=>{e!=null&&t.set(`stroke`,e)}),this._disposers.push(this._strokeDp)),this.get(`getLabelFillFromSprite`)&&(this._labelDp&&this._labelDp.dispose(),n!=null&&this.label.set(`fill`,n),this._labelDp=e.on(`fill`,e=>{e!=null&&this.label.set(`fill`,e)}),this._disposers.push(this._labelDp))}this._updateTextColor(n)}_updateTextColor(e){this.get(`autoTextColor`)&&(e??=this.get(`background`).get(`fill`),e??=this._root.interfaceColors.get(`background`),e instanceof c&&this.label.set(`fill`,c.alternative(e,this._root.interfaceColors.get(`alternativeText`),this._root.interfaceColors.get(`text`))))}_setDataItem(e){super._setDataItem(e),this.label._setDataItem(e)}_updateBackground(){super.updateBackground();let t=this._root.container;if(t){let n=.5,i=.5,a=this.get(`centerX`);a instanceof r&&(n=a.value);let o=this.get(`centerY`);o instanceof r&&(i=o.value);let s=t.width(),c=t.height(),l=this.parent,d=0,f=0;if(l){d=l.x(),f=l.y();let e=l.get(`layerMargin`);e&&(d+=e.left||0,f+=e.top||0,s+=(e.left||0)+(e.right||0),c+=(e.top||0)+(e.bottom||0))}let p=this.get(`bounds`,{left:-d,top:-f,right:s-d,bottom:c-f});this._updateBounds();let m=this.width(),h=this.height();m===0&&(m=this._w),h===0&&(h=this._h);let g=this.get(`pointTo`,{x:s/2,y:c/2}),_=g.x,v=g.y,y=this.get(`pointerOrientation`),b=this.get(`background`),x=0,S=0,C=0;b instanceof u&&(x=b.get(`pointerLength`,0),S=b.get(`strokeWidth`,0)/2,C=S,b.set(`width`,m),b.set(`height`,h));let w=0,T=0,E=p.right-p.left,D=p.bottom-p.top;y==`horizontal`||y==`left`||y==`right`?(S=0,y==`horizontal`?_>p.left+E/2?(_-=m*(1-n)+x,C*=-1):_+=m*n+x:y==`left`?_+=m*(1-n)+x:(_-=m*n+x,C*=-1)):(C=0,y==`vertical`?v>p.top+h/2+x?v-=h*(1-i)+x:(v+=h*i+x,S*=-1):y==`down`?v-=h*(1-i)+x:(v+=h*i+x,S*=-1)),_=e(_,p.left+m*n,p.left+E-m*(1-n))+C,v=e(v,p.top+h*i,p.top+D-h*(1-i))-S,w=g.x-_+m*n+C,T=g.y-v+h*i-S,this._fx=_,this._fy=v;let O=this.get(`animationDuration`,0);if(O>0&&this.get(`visible`)&&this.get(`opacity`)>.1){let e=this.get(`animationEasing`);this.animate({key:`x`,to:_,duration:O,easing:e}),this.animate({key:`y`,to:v,duration:O,easing:e})}else this.set(`x`,_),this.set(`y`,v);b instanceof u&&(b.set(`pointerX`,w),b.set(`pointerY`,T)),m>0&&(this._w=m),h>0&&(this._h=h)}}};Object.defineProperty(d,`className`,{enumerable:!0,configurable:!0,writable:!0,value:`Tooltip`}),Object.defineProperty(d,`classNames`,{enumerable:!0,configurable:!0,writable:!0,value:a.classNames.concat([d.className])});export{d as t};