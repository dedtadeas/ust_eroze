const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/calcite-button-DeHTsYH-.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css","assets/controllers-DZ7pbtKF.js","assets/useSetFocus-BOgV9A-L.js","assets/dom-atD5WAsR.js","assets/form-CYe_Hdps.js","assets/guid-D8BoG5RM.js","assets/interactive-C1Xh6Lv0.js","assets/label-CbTib4du.js","assets/logger-N52NEE_B.js","assets/observers-Ca90Dkfx.js","assets/useT9n-bRfAARgx.js","assets/calcite-icon-DU8UXGam.js","assets/calcite-loader-C2BnVEC6.js","assets/static-CFhWbVpa.js","assets/calcite-flow-D4rd49Lr.js","assets/calcite-flow-item-B58QADYb.js","assets/FloatingArrow-B1y4p2MR.js","assets/keyed-CU6bsPrA.js","assets/calcite-action-menu-CKG8WFN_.js","assets/array-GwTbyvCf.js","assets/floating-ui-bSZlirwY.js","assets/debounce-JuHvylml.js","assets/key-UZzOT_rp.js","assets/openCloseComponent-C1bAqVbv.js","assets/calcite-panel-Dcr_8l-E.js","assets/calcite-action-CVrDQiWf.js","assets/calcite-scrim-ChNbuBJA.js","assets/calcite-list-CgWjPxHf.js","assets/calcite-input-C8DWvaD7.js","assets/useCancelable-CRHa62_S.js","assets/utils2-B1dhLot4.js","assets/calcite-input-message-BD7sw1wZ.js","assets/calcite-progress-B9qY8ZRX.js","assets/calcite-notice-CvAfSaDY.js","assets/calcite-tooltip-DOISgjum.js","assets/TableList-CmmMZ0AV.js"])))=>i.map(i=>d[i]);
import{CD as e,Cw as t,Hb as n,Kb as r,MC as i,OC as a,Pd as o,SC as s,TC as c,Wb as l,_o as u,a as d,c as f,d as p,f as m,g as h,go as g,h as _,ho as v,kC as y,mo as b,n as x,os as S,po as C,s as w,t as T,zb as E}from"./index-BqmCqmfp.js";var D={layerListMode:`layer-list-mode`},O=`hide`,k=s.ofType(x),A=class extends c{constructor(e){super(e),this.catalogItems=new k,this.checkPublishStatusEnabled=!1,this.catalogLayer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.view=null}initialize(){this.addHandles([r(()=>[this.catalogLayer?.loaded,this.view?.ready],()=>this._compileList(),l),n(()=>this.catalogLayer?.dynamicGroupLayer.layers,`change`,()=>this._compileList()),r(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList())])}destroy(){this.view=null,this._removeAllItems()}get state(){let{view:e,catalogLayer:t}=this;return e?.ready&&t?.loaded?`ready`:e&&t?`loading`:`disabled`}get totalItems(){return this.catalogItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit(`trigger-action`,{action:e,item:t})}_createListItem(e){let{view:t,listItemCreatedFunction:n,checkPublishStatusEnabled:r,listModeDisabled:i}=this;return new x({checkPublishStatusEnabled:r,listModeDisabled:i,layer:e,listItemCreatedFunction:n,view:t})}_removeAllItems(){this.catalogItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(e=>h(e)!==O):void 0}_watchLayersListMode(e){this.removeHandles(D.layerListMode),e&&!this.listModeDisabled&&this.addHandles(r(()=>e.filter(e=>`listMode`in e).map(e=>e.listMode).toArray(),()=>this._compileList()),D.layerListMode)}_compileList(){let{catalogLayer:e}=this;if(!e?.loaded)return;let t=e?.dynamicGroupLayer.layers;this._watchLayersListMode(t);let n=this._getViewableLayers(t);n?.length?(this._createNewItems(n),this._removeItems(n),this._sortItems(n)):this._removeAllItems()}_createNewItems(e){let{catalogItems:t}=this;e.forEach(e=>{t.some(t=>t.layer===e)||t.add(this._createListItem(e))})}_removeItems(e){let{catalogItems:t}=this,n=[];t.forEach(t=>{t&&e?.includes(t.layer)||n.push(t)}),t.destroyMany(n)}_sortItems(e){let{catalogItems:t}=this;t.sort((t,n)=>{let r=e.indexOf(t.layer),i=e.indexOf(n.layer);return r>i?-1:r<i?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}};e([i({type:k})],A.prototype,`catalogItems`,void 0),e([i()],A.prototype,`checkPublishStatusEnabled`,void 0),e([i()],A.prototype,`catalogLayer`,void 0),e([i()],A.prototype,`listItemCreatedFunction`,void 0),e([i({nonNullable:!0})],A.prototype,`listModeDisabled`,void 0),e([i({readOnly:!0})],A.prototype,`state`,null),e([i()],A.prototype,`totalItems`,null),e([i()],A.prototype,`view`,void 0),A=e([y(`esri.widgets.CatalogLayerList.CatalogLayerListViewModel`)],A);var j=class extends a{constructor(){super(...arguments),this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};e([i({type:Boolean,nonNullable:!0})],j.prototype,`closeButton`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`collapseButton`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`errors`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`filter`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`flow`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`heading`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`statusIndicators`,void 0),e([i({type:Boolean,nonNullable:!0})],j.prototype,`temporaryLayerIndicators`,void 0),j=e([y(`esri.widgets.CatalogLayerList.CatalogLayerListVisibleElements`)],j);var M=`esri-catalog-layer-list`,N=`${M}__item`,P={base:M,actionMenu:`${M}__action-menu`,actionGroup:`${M}__action-group`,filterNoResults:`${M}__filter-no-results`,item:N,itemActive:`${N}--active`,itemContentBottom:`${N}-content-bottom`,itemMessage:`${N}-message`,itemActionIcon:`${N}-action-icon`,itemActionImage:`${N}-action-image`,itemTemporaryIcon:`${N}-temporary-icon`,itemTableIcon:`${N}-table-icon`,statusIndicator:`${M}__status-indicator`,publishing:`${M}__publishing`,updating:`${M}__updating`,connectionStatus:`${M}__connection-status`,connectionStatusConnected:`${M}__connection-status--connected`,visibleToggle:`${M}__visible-toggle`,visibleIcon:`${M}__visible-icon`},F,I=s.ofType(x),L=`nested`,R=F=class extends E(g){constructor(e,t){super(e,t),this._rootListEl=null,this._activeItem=null,this._tooltipReferenceMap=new o,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new o,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.filterPlaceholder=``,this.filterPredicate=null,this.filterText=``,this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new s([`knowledge-graph`]),this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minFilterItems=10,this.openedLayers=new s,this.openedLayerLists=new s,this.selectedItems=new I,this.selectionMode=`none`,this.tableList=null,this.tileOptions=null,this.viewModel=new A,this.visibilityAppearance=`default`,this.visibleElements=new j,this._onTablesOpen=e=>{this.onTablesOpen?this.onTablesOpen(e):(this.openedLayers.push(e.layer),this._focusLayerFlowItem=e.layer?.uid)},this._onCatalogOpen=e=>{this.onCatalogOpen?this.onCatalogOpen(e):(this.openedLayers.push(e.layer?.parent),this._focusLayerFlowItem=e.layer?.uid)},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onTooltipReferenceChange=(e,t)=>{t?this._tooltipReferenceMap.set(e,t):this._tooltipReferenceMap.delete(e)},this._onTriggerAction=(e,t)=>{this.triggerAction(e,t)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=e=>{if(this.visibilityAppearance!==`default`)return;let t=Array.from(e.composedPath()).find(e=>e.classList?.contains(P.item));this._activeItem=f(t)}}initialize(){this.addHandles([n(()=>this.openedLayers,`change`,()=>this._handleOpenedLayersChange(),l),n(()=>this.viewModel.catalogItems,`change`,()=>_(this.selectedItems),l),r(()=>[this.filterPredicate,this._rootListEl],()=>p(this._rootListEl,this.filterPredicate))])}loadDependencies(){return u({button:()=>t(()=>import(`./calcite-button-DeHTsYH-.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])),flow:()=>t(()=>import(`./calcite-flow-D4rd49Lr.js`),__vite__mapDeps([16,1,2,3,4,5,7,10,11])),"flow-item":()=>t(()=>import(`./calcite-flow-item-B58QADYb.js`),__vite__mapDeps([17,1,2,3,18,19,20,21,4,5,22,23,7,24,11,25,12,15,6,8,10,26,27,13,14,28])),list:()=>t(()=>import(`./calcite-list-CgWjPxHf.js`),__vite__mapDeps([29,1,2,3,30,4,5,6,8,24,9,12,19,15,7,10,11,31,32,13,33,14,34,28,23])),notice:()=>t(()=>import(`./calcite-notice-CvAfSaDY.js`),__vite__mapDeps([35,1,2,3,4,5,7,10,11,25,12,13])),tooltip:()=>t(()=>import(`./calcite-tooltip-DOISgjum.js`),__vite__mapDeps([36,1,2,18,19,5,22,23,7,25]))})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _filterEnabled(){return this.viewModel.totalItems>=this.minFilterItems&&this.visibleElements.filter}get _visibleItems(){return this.catalogItems?.filter(e=>!e.hidden&&(this.visibleElements.errors||!e.error))}get _openedPanelItems(){return this._visibleItems.flatten(e=>e.children).filter(({hidden:e,panel:t})=>!e&&t?.open&&!t.disabled&&t.flowEnabled)}get _renderedOpenLayerFlowItems(){let{openedLayers:e}=this;return e.toArray().map((t,n)=>this._renderLayerFlowItem(t,n===e.length-1))}get catalogItems(){return this.viewModel.catalogItems}set catalogItems(e){this.viewModel.catalogItems=e}get catalogLayer(){return this.viewModel.catalogLayer}set catalogLayer(e){this.viewModel.catalogLayer=e}get icon(){return`catalog-dataset`}set icon(e){this._overrideIfSome(`icon`,e)}get label(){return this.messages?.widgetLabel??``}set label(e){this._overrideIfSome(`label`,e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){let e=this.viewModel?.state,t={[v.hidden]:e===`loading`,[v.disabled]:e===`disabled`};return C(`div`,{class:this.classes(P.base,v.widget,v.panel,t)},this._renderItemTooltips(),this._renderItems())}async _createFlowList(e,t){let{_layerListMap:n}=this,r=n.get(e);if(r)return r;let i=e.type===`catalog`?this._createCatalogLayerList(e):await this._createTableList(e);return t.aborted||n.set(e,i),i}async _handleOpenedLayersChange(){let{_layerListMap:e,openedLayers:t,openedLayerLists:n}=this;this._openedLayersController?.abort();let r=new AbortController,{signal:i}=r;this._openedLayersController=r,e.forEach((n,r)=>{t.includes(r)||(n.destroy(),e.delete(r))});let a=await Promise.all(t.map(e=>this._createFlowList(e,i)));if(i.aborted)return;n.removeAll(),n.addMany(a);let o=n.at(-1);o?`catalogLayer`in o?(this._set(`catalogLayerList`,o),this._set(`tableList`,null)):(this._set(`catalogLayerList`,null),this._set(`tableList`,o)):(this._set(`catalogLayerList`,null),this._set(`tableList`,null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.forEach(e=>e.destroy()),this._layerListMap.clear()}_renderItemTooltip(e){let{_tooltipReferenceMap:t,messages:n}=this;return e?.layer?C(`calcite-tooltip`,{key:`tooltip-${e.layer.uid}`,overlayPositioning:`fixed`,referenceElement:t.get(e.layer.uid)},n.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){return e.incompatible?this._renderItemTooltip(e):e.children?.filter(e=>!e.hidden).toArray().map(e=>this._renderItemTooltipNodes(e))}_renderItemTooltips(){return this._visibleItems?.toArray().map(e=>this._renderItemTooltipNodes(e))}_renderNoItemsMessage(){return C(`div`,{slot:`message`},this.messages.noItemsToDisplay)}_renderNoItems(){return C(`div`,{class:P.itemMessage,key:`esri-layer-list__no-items`},C(`calcite-notice`,{icon:`information`,kind:`info`,open:!0,width:`full`},this._renderNoItemsMessage()))}_renderPanelFlowItems(){let{_openedPanelItems:e,openedLayers:t}=this;return e.toArray().map(({title:n,panel:r},i)=>{let a=()=>this._handlePanelFlowItemBack(r);return C(`calcite-flow-item`,{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:n,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,selected:!t.length&&i===e.length-1,onCalciteFlowItemBack:e=>{e.preventDefault(),a()}},r.render(),C(`calcite-button`,{appearance:`transparent`,onclick:a,slot:`footer-actions`,width:`full`},this.messagesCommon.back))})}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,S(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,S(e))}_renderItems(){let{visible:e,collapsed:t,_visibleItems:n,_filterEnabled:r,_rootGroupUid:i,visibleElements:{closeButton:a,collapseButton:o,heading:s,flow:c},selectionMode:l,filterText:u,filterPlaceholder:d,messages:f,openedLayers:p,_openedPanelItems:m}=this,h=[C(`calcite-flow-item`,{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:a,closed:!e,collapsed:t,collapsible:o,heading:s?f.widgetLabel:void 0,headingLevel:this.headingLevel,key:`root-flow-item`,selected:!p.length&&!m.length,onCalciteFlowItemClose:()=>this.visible=!1},n?.length?null:this._renderNoItems(),C(`calcite-list`,{afterCreate:e=>{this._rootListEl=e,e.addEventListener(`focusin`,this._setActiveItem),e.addEventListener(`focusout`,this._clearActiveItem)},afterRemoved:e=>{this._rootListEl=null,e.removeEventListener(`focusin`,this._setActiveItem),e.removeEventListener(`focusout`,this._clearActiveItem)},"data-layer-type":i,displayMode:L,filterEnabled:r,filterPlaceholder:d,filterProps:T,filterText:r?u:``,group:i,key:`root-list`,label:f.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:`border`,selectionMode:l,onCalciteListChange:e=>this._handleCalciteListChange(e),onCalciteListFilter:e=>this.filterText=e.currentTarget?.filterText??``},n.toArray().map(e=>this._renderItem(e)),r?C(`div`,{class:P.filterNoResults,slot:`filter-no-results`},C(`calcite-notice`,{kind:`info`,open:!0,width:`full`},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(),this._renderedOpenLayerFlowItems];return e?c?C(`calcite-flow`,{key:`root-flow`},h):h:null}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,S(e))}_renderLayerFlowItem(e,t){let{messages:n,openedLayers:r}=this,i=e.title||this.messages.untitledLayer;return C(`calcite-flow-item`,{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:i,heading:n[e.type===`catalog`?`catalogLayers`:`tables`],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,selected:t,onCalciteFlowItemBack:e=>{e.preventDefault(),r.pop();let t=r.at(-1);t?this._focusLayerFlowItem=t.uid:this._focusRootFlowItem=!0}},this._layerListMap.get(e)?.render())}_createCatalogLayerList(e){let{headingLevel:t,catalogOptions:n,view:r,filterPlaceholder:i,listItemCreatedFunction:a,minFilterItems:o,selectionMode:s,visibilityAppearance:c,onCatalogOpen:l,onTablesOpen:u}=this;return new F({headingLevel:t,view:r,filterPlaceholder:i,listItemCreatedFunction:a,minFilterItems:o,selectionMode:s,visibilityAppearance:c,...n,catalogLayer:e,onCatalogOpen:l,onTablesOpen:u})}_getTableListParams(e){switch(e.type){case`knowledge-graph`:return{...this.knowledgeGraphOptions,tables:e.tables};case`map-image`:return{...this.mapImageOptions,tables:e.subtables};case`tile`:return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){let{default:n}=await t(async()=>{let{default:e}=await import(`./TableList-CmmMZ0AV.js`);return{default:e}},__vite__mapDeps([37,1,2])),{headingLevel:r,selectionMode:i}=this;return new n({headingLevel:r,selectionMode:i,...this._getTableListParams(e)})}_renderItem(e,t,n){return C(w,{activeItem:this._activeItem,css:P,displayMode:L,dragEnabled:!1,item:e,key:`layerListItem-${e.layer?.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:t,parentTitles:n,rootGroupUid:this._rootGroupUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_handleCalciteListChange(e){let{selectionMode:t,selectedItems:n}=this;if(t===`none`)return;let r=e.target.selectedItems.map(e=>f(e)).filter(Boolean);n.removeAll(),n.addMany(r)}};e([i()],R.prototype,`_rootListEl`,void 0),e([i()],R.prototype,`_activeItem`,void 0),e([i()],R.prototype,`_tooltipReferenceMap`,void 0),e([i()],R.prototype,`_focusRootFlowItem`,void 0),e([i()],R.prototype,`_focusPanelFlowItem`,void 0),e([i()],R.prototype,`_focusLayerFlowItem`,void 0),e([i()],R.prototype,`_layerListMap`,void 0),e([i()],R.prototype,`_filterEnabled`,null),e([i()],R.prototype,`_visibleItems`,null),e([i()],R.prototype,`_openedPanelItems`,null),e([i()],R.prototype,`_renderedOpenLayerFlowItems`,null),e([i()],R.prototype,`catalogItems`,null),e([i()],R.prototype,`catalogLayer`,null),e([i({readOnly:!0})],R.prototype,`catalogLayerList`,void 0),e([i()],R.prototype,`catalogOptions`,void 0),e([i()],R.prototype,`collapsed`,void 0),e([i()],R.prototype,`filterPlaceholder`,void 0),e([i()],R.prototype,`filterPredicate`,void 0),e([i()],R.prototype,`filterText`,void 0),e([i()],R.prototype,`headingLevel`,void 0),e([i()],R.prototype,`icon`,null),e([i()],R.prototype,`knowledgeGraphOptions`,void 0),e([i()],R.prototype,`label`,null),e([i()],R.prototype,`layerTablesEnabled`,void 0),e([i()],R.prototype,`listItemCreatedFunction`,null),e([i()],R.prototype,`mapImageOptions`,void 0),e([i(),b(`esri/widgets/CatalogLayerList/t9n/CatalogLayerList`)],R.prototype,`messages`,void 0),e([i(),b(`esri/t9n/common`)],R.prototype,`messagesCommon`,void 0),e([i()],R.prototype,`minFilterItems`,void 0),e([i({readOnly:!0})],R.prototype,`openedLayers`,void 0),e([i({readOnly:!0})],R.prototype,`openedLayerLists`,void 0),e([i()],R.prototype,`onCatalogOpen`,void 0),e([i()],R.prototype,`onTablesOpen`,void 0),e([i({type:I})],R.prototype,`selectedItems`,void 0),e([i()],R.prototype,`selectionMode`,void 0),e([i({readOnly:!0})],R.prototype,`tableList`,void 0),e([i()],R.prototype,`tileOptions`,void 0),e([i()],R.prototype,`view`,null),e([d(`trigger-action`),i({type:A})],R.prototype,`viewModel`,void 0),e([i()],R.prototype,`visibilityAppearance`,void 0),e([i({type:j,nonNullable:!0})],R.prototype,`visibleElements`,void 0),R=F=e([y(`esri.widgets.CatalogLayerList`)],R);var z=R;export{z as default};