import{Hu as e,Qm as t,Uu as n,Wu as r,Xm as i,Ym as a,Zm as o,Zv as s,by as c,eh as l,gE as u,jS as d,kS as f,r_ as p}from"./index-BqmCqmfp.js";function m(e){return g(e,!0)}function h(e){return g(e,!1)}function g(s,c){if(s==null)return null;let m=s.spatialReference,h=d(m),g=u(s)?s.toJSON():s;if(!h)return g;let y=f(m)?102100:4326,b=n[y].maxX,x=n[y].minX;if(a(g))return v(g,b,x);if(t(g))return g.points=g.points.map(e=>v(e,b,x)),g;if(i(g))return _(g,h);if(l(g)||o(g)){let t=p(T,g),n={xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3]},i=e(n.xmin,x)*(2*b),a=i===0?g:r(g,i);return n.xmin+=i,n.xmax+=i,n.xmax>b?C(a,b,c):n.xmin<x?C(a,x,c):a}return g}function _(e,t){if(!t)return e;let n=y(e,t).map(e=>e.extent);return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map(e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]])}}function v(t,n,r){if(Array.isArray(t)){let i=t[0];if(i>n){let r=e(i,n);t[0]=i+r*(-2*n)}else if(i<r){let n=e(i,r);t[0]=i+n*(-2*r)}}else{let i=t.x;if(i>n){let r=e(i,n);t.x+=r*(-2*n)}else if(i<r){let n=e(i,r);t.x+=n*(-2*r)}}return t}function y(e,t){let n=[],{ymin:r,ymax:i,xmin:a,xmax:o}=e,s=e.xmax-e.xmin,[c,l]=t.valid,{x:u,frameId:d}=b(e.xmin,t),{x:f,frameId:p}=b(e.xmax,t),m=u===f&&s>0;if(s>2*l){let e={xmin:a<o?u:f,ymin:r,xmax:l,ymax:i},t={xmin:c,ymin:r,xmax:a<o?f:u,ymax:i},s={xmin:0,ymin:r,xmax:l,ymax:i},m={xmin:c,ymin:r,xmax:0,ymax:i},h=[],g=[];x(e,s)&&h.push(d),x(e,m)&&g.push(d),x(t,s)&&h.push(p),x(t,m)&&g.push(p);for(let e=d+1;e<p;e++)h.push(e),g.push(e);n.push(new w(e,[d]),new w(t,[p]),new w(s,h),new w(m,g))}else u>f||m?n.push(new w({xmin:u,ymin:r,xmax:l,ymax:i},[d]),new w({xmin:c,ymin:r,xmax:f,ymax:i},[p])):n.push(new w({xmin:u,ymin:r,xmax:f,ymax:i},[d]));return n}function b(e,t){let[n,r]=t.valid,i=2*r,a,o=0;return e>r?(a=Math.ceil(Math.abs(e-r)/i),e-=a*i,o=a):e<n&&(a=Math.ceil(Math.abs(e-n)/i),e+=a*i,o=-a),{x:e,frameId:o}}function x(e,t){let{xmin:n,ymin:r,xmax:i,ymax:a}=t;return S(e,n,r)&&S(e,n,a)&&S(e,i,a)&&S(e,i,r)}function S(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}function C(e,t,n=!0){let r=!o(e);if(r&&c(e),n)return new E().cut(e,t);let i=r?e.rings:e.paths,a=r?4:2,s=i.length,l=-2*t;for(let e=0;e<s;e++){let t=i[e];if(t&&t.length>=a){let e=[];for(let n of t)e.push([n[0]+l,n[1]]);i.push(e)}}return r?e.rings=i:e.paths=i,e}var w=class{constructor(e,t){this.extent=e,this.frameIds=t}},T=s(),E=class{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let n;if(this._xCut=t,e.rings)this._closed=!0,n=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,n=e.paths,this._minPts=2}for(let e of n){if(!e||e.length<this._minPts)continue;let t=!0;for(let n of e)t?(this.moveTo(n),t=!1):this.lineTo(n);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),n=[];for(let e of this._linesIn)e&&e.length>=this._minPts&&n.push(e);let r=-2*this._xCut;for(let e of this._linesOut)if(e&&e.length>=this._minPts){for(let t of e)t[0]+=r;n.push(e)}return this._closed?e.rings=n:e.paths=n,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){let t=this._side(e[0]);if(t*this._prevSide===-1){let n=this._intersect(this._prevPt,e);this._lineTo(this._xCut,n,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){let e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,n){this._closed?(this._lineIn.push([n<=0?e:this._xCut,t]),this._lineOut.push([n>=0?e:this._xCut,t])):(n<=0&&this._lineIn.push([e,t]),n>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,n){this._closed?(D(this._lineIn,n<=0?e:this._xCut,t),D(this._lineOut,n>=0?e:this._xCut,t)):n<0?(this._prevSide===0&&this._pushLineOut(),this._lineIn.push([e,t])):n>0?(this._prevSide===0&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_checkClosingPt(e){let t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){let n=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+n*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}};function D(e,t,n){let r=e.length;r>1&&e[r-1][0]===t&&e[r-2][0]===t?e[r-1][1]=n:e.push([t,n])}export{m as n,h as t};