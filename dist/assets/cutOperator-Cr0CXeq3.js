import{nD as e}from"./index-BqmCqmfp.js";import{n as t}from"./SimpleGeometryCursor-CI9GIWKa.js";import{cn as n,ln as r,vn as i}from"./Point2D-UYEfE6HP.js";import{Jt as a,Q as o,Qt as s,X as c,at as l,c as u,ct as d,p as f,pn as p,qt as m,sn as h,yn as g}from"./UnitFactory-J9WMNXdY.js";import{i as _,l as v,p as y,s as b,t as x}from"./apiConverter-DVPFZqjR.js";var S=d;function C(e,t){return{m_geometry:e,m_side:t}}function w(e,t,n,r,i,s){if(t.isEmpty()){let e=C(t,0);i.push(e);return}if(n.isEmpty()){let e=C(t,0);i.push(e);return}let d=[],p=new a;{let a=p.createGeometryUserIndex(),m=p.addGeometry(t),h=p.addGeometry(n),g=new f(s),_=0,v=null;if(p.hasCurves()){v=new S;let e=p.getEnvelope2D(s);_=l(r.total());let t=c(r.total(),e);o(p,t,r.total(),12e3,v,null,s)}p.dbgVerifyCurves(),g.setEditShapeCrackAndCluster(p,r),g.cut(e,a,m,h,d);for(let e of d){v!==null&&v.stitchCurves(p,e,_,!1);let t=C(p.getGeometry(e),u(p.getGeometryUserIndex(e,a)));i.push(t)}v!==null&&v.clearStitcher(p)}}function T(e,t,n,r,i,s){if(t.isEmpty()){let e=C(t,0);i.push(e);return}if(n.isEmpty()){let e=C(t,0);i.push(e);return}let u=[],d=new a;{let e=d.createGeometryUserIndex(),p=d.addGeometry(t),m=d.addGeometry(n),g=new f(s),_=0,v=null;if(d.hasCurves()){v=new S;let e=d.getEnvelope2D(s);_=l(r.total());let t=c(r.total(),e);o(d,t,r.total(),12e3,v,null,s)}d.dbgVerifyCurves(),g.setEditShapeCrackAndCluster(d,r),g.cut(!1,e,p,m,u),v!==null&&v.stitchCurves(d,-1,_,!0);let y=d.getGeometry(p),b=new h,x=new h,w=[];for(let t=0;t<u.length;t++){let n=null;{let i=new a,f=i.addGeometry(y),p=i.addGeometry(d.getGeometry(u[t]));if(i.hasCurves()){let e=i.getEnvelope2D(s);_=l(r.total());let t=c(r.total(),e);o(i,t,r.total(),12e3,v,null,s)}g.setEditShapeCrackAndCluster(i,r);let m=g.intersection(f,p);if(v!==null&&v.stitchCurves(i,-1,_,!0),n=i.getGeometry(m),n.isEmpty())continue;let h=d.getGeometryUserIndex(u[t],e);h===2?b.add(n,!1):h===1?x.add(n,!1):w.push(n)}{let e=new a,n=e.addGeometry(y),i=e.addGeometry(d.getGeometry(u[t]));if(e.hasCurves()){let t=e.getEnvelope2D(s);_=l(r.total());let n=c(r.total(),t);o(e,n,r.total(),12e3,v,null,s)}g.setEditShapeCrackAndCluster(e,r);let f=g.difference(n,i);v!==null&&v.stitchCurves(e,-1,_,!0),y=e.getGeometry(f)}}if(!y.isEmpty()&&u.length>0&&w.push(y),b.isEmpty()&&x.isEmpty())return;if(!b.isEmpty()){let e=C(b,1);i.push(e)}if(!x.isEmpty()){let e=C(x,2);i.push(e)}for(let e=0,t=w.length;e<t;++e){let t=C(w[e],3);i.push(t)}}}var E=class{getOperatorType(){return 10005}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,r,i){return new D(e,t,n,r,i)}},D=class extends t{constructor(e,t,n,r,i){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=i,this.m_cuttee=t.clone(),this.m_cutter=new m({copy:n}),this.m_bConsiderTouch=e;let a=g(t,n);this.m_tolerance=p(r,a,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case n.enumPolyline:this.generatePolylineCuts();break;case n.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){let e=new m,t=new m,n=new m;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(t);let i=[];w(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,i,this.m_progressTracker);for(let a=0;a<i.length;a++){let o=i[a];o.m_side===1?e.add(o.m_geometry,!1):o.m_side===2||o.m_side===4?t.add(o.m_geometry,!1):o.m_side===3?this.m_cuts.push(o.m_geometry):o.m_side===0?n.add(o.m_geometry,!1):r(``)}n.isEmpty()||e.isEmpty()&&t.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(n),e.isEmpty()&&t.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){let e=new h,t=new h,n=new h;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(t);let a=[];T(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,a,this.m_progressTracker);for(let i=0;i<a.length;i++){let o=a[i];o.m_side===1?e.add(o.m_geometry,!1):o.m_side===2?t.add(o.m_geometry,!1):o.m_side===3?this.m_cuts.push(o.m_geometry):o.m_side===0?n.add(o.m_geometry,!1):r(``)}i(n.isEmpty()||a.length===1),e.isEmpty()&&t.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}},O=new E;function k(e,t,n){let r=O.execute(!0,e,t,n,null);return Array.from(r)}function A(){return O.supportsCurves()}function j(t,n){let r=x(t);return k(y(t),_(n),b(r)).map(e=>v(e,r)).filter(e)}var M=A(),N=Object.freeze(Object.defineProperty({__proto__:null,execute:j,supportsCurves:M},Symbol.toStringTag,{value:`Module`}));export{N as n,j as r,M as t};