import{E_ as e,Gy as t,T_ as n,Xv as r,Zv as i,b_ as a,f_ as o,s_ as s,uD as c,w_ as l,x_ as u,xy as d,y_ as f}from"./index-BqmCqmfp.js";import{r as p}from"./GraphicManipulator-3bzgkt2P.js";function m(e,t,n,r){if(r==null||e.hasZ||(r=void 0),e.type===`point`)return e.x+=t,e.y+=n,e.hasZ&&r!=null&&(e.z+=r),e;if(e.type===`multipoint`){let i=e.points;for(let e=0;e<i.length;e++)i[e]=_(i[e],t,n,r);return e}if(e.type===`extent`)return e.xmin+=t,e.xmax+=t,e.ymin+=n,e.ymax+=n,r!=null&&(e.zmin??=0,e.zmin+=r,e.zmax??=0,e.zmax+=r),e;let i=e.type===`polyline`?e.curvePaths??e.paths:e.curveRings??e.rings,a=u(e);for(let e=0;e<i.length;e++){let a=i[e];for(let e=0;e<a.length;e++)a[e]=v(a[e],t,n,r)}return`paths`in e?a?e.curvePaths=i:e.paths=i:a?e.curveRings=i:e.rings=i,e}function h(e,t,n,r,i){let a=e.clone();if(i){let{resolution:e}=r;m(a,t*e,-n*e)}else{let{dxMap:e,dyMap:i}=g(t,n,r);m(a,e,i)}return a}function g(e,t,n){let r=n.state.inverseTransform;return{dxMap:r[0]*e+r[2]*t,dyMap:r[1]*e+r[3]*t}}function _(e,t,n,r){return w(e,e[0]+t,e[1]+n,e[2]!=null&&r!=null?e[2]+r:void 0)}function v(e,t,r,i){let o=_(f(e),t,r,i);if(a(e))return o;if(l(e)){let[,n,i]=e.b;return{b:[o,[n[0]+t,n[1]+r],[i[0]+t,i[1]+r]]}}if(n(e)){let[,n]=e.c;return{c:[o,[n[0]+t,n[1]+r]]}}let[,s,...c]=e.a;return{a:[o,[s[0]+t,s[1]+r],...c]}}function y(e,t,n,a){if(e.type===`point`){let{x:r,y:i}=e,o=a?a[0]:r,s=a?a[1]:i,c=e.clone(),l=(r-o)*t+o,u=(i-s)*n+s;return c.x=l,c.y=u,c}if(e.type===`extent`){let{xmin:r,xmax:i,ymin:o,ymax:s}=e,c=a?a[0]:(r+i)/2,l=a?a[1]:(s+o)/2,u=e.clone();if(u.xmin=(r-c)*t+c,u.ymax=(s-l)*n+l,u.xmax=(i-c)*t+c,u.ymin=(o-l)*n+l,u.xmin>u.xmax){let e=u.xmin;u.xmin=u.xmax,u.xmax=e}if(u.ymin>u.ymax){let e=u.ymin;u.ymin=u.ymax,u.ymax=e}return u}let o=null;if(!a){o=d(e);let t=i(),n=s(t,o);if(!n)return e.clone();let[r,c,l,u]=n;a=[(r+l)/2,(c+u)/2]}let[l,u]=a;if(e.type===`multipoint`){let r=e.clone(),i=r.points;for(let e=0;e<i.length;e++){let r=i[e],[a,o]=r,s=(a-l)*t+l,c=(o-u)*n+u;i[e]=w(r,s,c,void 0)}return r.points=i,r}let p=e.clone();o??=d(e);let m=p.type===`polygon`,h=m?p.curveRings??p.rings:p.curvePaths??p.paths;if(!a){let e=i(),t=s(e,h,!1,!1);if(!t)return p;a=r(t)}for(let e of h){let r=null,i=m&&e.length>0&&c(f(e[0]),f(e.at(-1)));for(let i=0;i<e.length;i++){let a=e[i];e[i]=x(a,t,n,l,u,r),r=a}i&&(e[0]=[...f(e.at(-1))])}return p}function b(e,t,n,r,i){let[a,o,...s]=e;return[(a-r)*t+r,(o-i)*n+i,...s]}function x(t,r,i,s,c,u){if(a(t))return b(t,r,i,s,c);if(l(t)){let[e,n,a]=t.b.map(e=>b(e,r,i,s,c));return{b:[e,n,a]}}if(!u)return t;let d=f(u),[m,h,g,_,v,y,x]=(n(t)?e(d,t):t).a,S=v??0,C=y??Math.hypot(m[0]-h[0],m[1]-h[1]),w=x??1,T=p(s,c,1,0,0,1,r,i);return o(d,{a:[[...m],[...h],g,_,S,C,w]},T)}function S(e,t,n,r,i,a){let o=Math.sqrt((n-e)*(n-e)+(r-t)*(r-t));return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t))/o}function C(e,n,r,i=!1){let a=Math.atan2(n.y-r.y,n.x-r.x)-Math.atan2(e.y-r.y,e.x-r.x),o=Math.atan2(Math.sin(a),Math.cos(a));return i?o:t(o)}function w(e,t,n,r){let i=[t,n];return e.length>2&&i.push(r??e[2]),e.length>3&&i.push(e[3]),i}export{h as a,g as i,S as n,C as r,y as t};