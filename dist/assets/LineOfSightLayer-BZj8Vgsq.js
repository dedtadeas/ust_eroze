import{Ax as e,Ay as t,Bf as n,CD as r,Ff as i,Kb as a,MC as o,Mb as s,Nf as c,OC as l,Ry as u,SC as d,_C as f,ao as p,bC as m,bg as h,dT as g,kC as _,qb as v,ra as y,rt as b,uD as x,xC as S,zy as C}from"./index-BqmCqmfp.js";import"./quatf64-CJzmL3cc.js";import"./vectorStacks-CKtslZxP.js";import"./sphere-CicnK0Bn.js";import{g as w}from"./elevationInfoUtils-Df_uYU_q.js";import{t as T}from"./Analysis-CyK6mGNi.js";import"./HUDIntersectorResult-CCf93UUm.js";import"./Intersector-DrVIdDEe.js";import{n as E,t as D}from"./featureReferenceUtils-B_QvVrE5.js";var O=class extends f(C(l)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return g(this.position,e.position)&&g(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};r([o({type:e,json:{write:{isRequired:!0}}})],O.prototype,`position`,void 0),r([o({type:y}),t()],O.prototype,`elevationInfo`,void 0),r([o(E)],O.prototype,`feature`,void 0),O=r([_(`esri.analysis.LineOfSightAnalysisObserver`)],O);var k=O,A=class extends f(u){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return g(this.position,e.position)&&g(this.elevationInfo,e.elevationInfo)&&D(this.feature,e.feature)}};r([o({type:e,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),t()],A.prototype,`position`,void 0),r([o({type:y}),t()],A.prototype,`elevationInfo`,void 0),r([o(E)],A.prototype,`feature`,void 0),A=r([_(`esri.analysis.LineOfSightAnalysisTarget`)],A);var j=d.ofType(A),M=class extends T{constructor(e){super(e),this.type=`line-of-sight`,this.observer=null,this.extent=null}initialize(){this.addHandles(a(()=>this._computeExtent(),e=>{e?.pending??this._set(`extent`,e==null?null:e.extent)},v))}get targets(){return this._get(`targets`)||new j}set targets(e){this._set(`targets`,S(e,this.targets,j))}get spatialReference(){return this.observer?.position==null?null:this.observer.position.spatialReference}get valid(){return this.observer?.position!=null}async waitComputeExtent(){let e=this._computeExtent();return e==null?Promise.resolve():e.pending}_computeExtent(){let e=this.spatialReference;if(this.observer?.position==null||e==null)return null;let t=e=>w(e.position,e.elevationInfo)===`absolute-height`,r=this.observer.position,a=c(r.x,r.y,r.z,r.x,r.y,r.z);for(let t of this.targets)if(t.position!=null){let r=h(t.position,e);if(r.pending!=null)return{pending:r.pending,extent:null};if(r.geometry!=null){let{x:e,y:t,z:i}=r.geometry;n(a,[e,t,i])}}let o=i(a,e);return t(this.observer)&&this.targets.every(t)||(o.zmin=void 0,o.zmax=void 0),{pending:null,extent:o}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&g(this.observer,e.observer)&&x(this.targets.toArray(),e.targets.toArray(),(e,t)=>e.equals(t))}};r([o({type:[`line-of-sight`]})],M.prototype,`type`,void 0),r([o({type:k,json:{read:!0,write:!0}})],M.prototype,`observer`,void 0),r([o({cast:m,type:j,nonNullable:!0,json:{read:!0,write:!0}})],M.prototype,`targets`,null),r([o({value:null,readOnly:!0})],M.prototype,`extent`,void 0),r([o()],M.prototype,`spatialReference`,null),r([o({readOnly:!0})],M.prototype,`valid`,null),M=r([_(`esri.analysis.LineOfSightAnalysis`)],M);var N=d.ofType(A),P=class extends b(p(s)){constructor(e){super(e),this.type=`line-of-sight`,this.operationalLayerType=`LineOfSightLayer`,this.analysis=new M,this.opacity=1}initialize(){this.addHandles(a(()=>this.analysis,(e,t)=>{t!=null&&t.parent===this&&(t.parent=null),e!=null&&(e.parent=this)},v))}async load(){return this.analysis!=null&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(e){let{analysis:t}=this;t&&(t.observer=e)}get targets(){return this.analysis==null?new d:this.analysis.targets}set targets(e){S(e,this.analysis?.targets)}get fullExtent(){return this.analysis==null?null:this.analysis.extent}get spatialReference(){return this.analysis==null?null:this.analysis.spatialReference}releaseAnalysis(e){this.analysis===e&&(this.analysis=new M)}};r([o({json:{read:!1},readOnly:!0})],P.prototype,`type`,void 0),r([o({type:[`LineOfSightLayer`]})],P.prototype,`operationalLayerType`,void 0),r([o({type:k,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],P.prototype,`observer`,null),r([o({type:N,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],P.prototype,`targets`,null),r([o({type:M,nonNullable:!0,json:{read:!1,write:!1}})],P.prototype,`analysis`,void 0),r([o({readOnly:!0})],P.prototype,`fullExtent`,null),r([o({readOnly:!0})],P.prototype,`spatialReference`,null),r([o({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],P.prototype,`opacity`,void 0),r([o({type:[`show`,`hide`]})],P.prototype,`listMode`,void 0),P=r([_(`esri.layers.LineOfSightLayer`)],P);var F=P;export{F as default};