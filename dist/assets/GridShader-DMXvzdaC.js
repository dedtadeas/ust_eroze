import{$l as e,Av as t,Ax as n,Bm as r,CD as i,Eu as a,Ev as o,Jg as s,Jh as c,Jl as l,MC as u,Mu as d,OC as f,Ou as p,TD as m,Tu as ee,Ub as te,Xg as ne,Xh as re,ab as ie,bD as ae,do as oe,id as se,iw as ce,ju as le,kC as h,ku as ue,kv as de,ll as fe,lu as pe,mT as me,nu as he,rw as g,wC as ge,wm as _e,wu as ve}from"./index-BqmCqmfp.js";import{f as _}from"./WGLContainer-Caxzva6E.js";import{A as ye,B as be,D as xe,H as v,I as Se,It as y,J as Ce,L as we,M as b,Mt as x,Tt as S,U as C,W as Te,Y as Ee,_ as w,_t as De,a as T,c as E,ct as Oe,dt as D,gt as ke,h as Ae,i as je,it as Me,j as Ne,jt as Pe,k as Fe,kt as Ie,l as O,mt as Le,n as k,ot as Re,q as A,r as j,s as M,st as ze,t as N,tt as Be,u as P,v as F,wt as Ve,x as He,y as Ue,z as I}from"./GraphShaderModule-D5xwSwIQ.js";import{c as We}from"./constants-BOI_CTg-.js";import{a as L,l as Ge,o as Ke,s as qe}from"./utils-CY7cI7hp.js";import{t as Je}from"./CircularArray-Bnt6GPkP.js";import{t as Ye}from"./DisjointTimerQuery-DmiPM9r5.js";import{t as Xe}from"./SymbolFader-sQMZEde1.js";var Ze={vertexShader:_(`bitBlit/bitBlit.vert`),fragmentShader:_(`bitBlit/bitBlit.frag`)},Qe={vertexShader:_(`stencil/stencil.vert`),fragmentShader:_(`stencil/stencil.frag`)},$e=class extends N{};i([T(0,I)],$e.prototype,`position`,void 0);var et=class extends k{},R=class extends P{};i([E(b)],R.prototype,`layerTexture`,void 0),i([E(b)],R.prototype,`backbufferTexture`,void 0),i([E(w)],R.prototype,`opacity`,void 0),i([E(w)],R.prototype,`inFadeOpacity`,void 0);var tt=class extends j{constructor(){super(...arguments),this.type=`BlendShader`}vertex(e){return{uv:e.position,glPosition:new A(Ge(e.position),0,1)}}fragment(e){let t=new O,n=x(this.config.layerTexture,e.uv),r=x(this.config.backbufferTexture,e.uv),i=y(F(n.a,new w(0)),n.rgb,n.rgb.divide(n.a)),a=y(F(r.a,new w(0)),r.rgb,r.rgb.divide(r.a)),o=this.config.opacity.multiply(n.a),s=r.a;switch(this.blendMode){case`destination-over`:t.fragColor=new A(i.multiply(o).multiply(L(s)).add(a.multiply(s)),o.add(s).subtract(o.multiply(s)));break;case`source-in`:{let e=new A(i.multiply(o).multiply(s),o.multiply(s)),n=new A(a.multiply(s),s).multiply(L(this.config.opacity)).multiply(this.config.inFadeOpacity);t.fragColor=e.add(n)}break;case`destination-in`:{let e=new A(a.multiply(s).multiply(o),s.multiply(o)),n=new A(a.multiply(s),s).multiply(new A(L(this.config.opacity).multiply(this.config.inFadeOpacity)));t.fragColor=e.add(n)}break;case`source-out`:t.fragColor=new A(i.multiply(o).multiply(L(s)),o.multiply(L(s)));break;case`destination-out`:t.fragColor=new A(a.multiply(s).multiply(L(o)),s.multiply(L(o)));break;case`source-atop`:t.fragColor=new A(i.multiply(o).multiply(s).add(a.multiply(s.multiply(L(o)))),s);break;case`destination-atop`:t.fragColor=new A(i.multiply(o.multiply(L(s))).add(a.multiply(s).multiply(o)),o);break;case`xor`:t.fragColor=new A(i.multiply(o.multiply(L(s))).add(a.multiply(s.multiply(L(o)))),o.multiply(L(s)).add(s.multiply(L(o))));break;case`multiply`:t.fragColor=new A(i.multiply(o).multiply(a.multiply(s)).add(i.multiply(o).multiply(L(s))).add(a.multiply(s).multiply(L(o))),o.add(s.multiply(L(o))));break;case`screen`:t.fragColor=new A(i.add(a).subtract(i.multiply(a)).multiply(o.multiply(s)).add(i.multiply(o).multiply(L(s))).add(a.multiply(s).multiply(L(o))),o.add(s.multiply(L(o))));break;case`overlay`:{let e=new v(nt(a.r,i.r),nt(a.g,i.g),nt(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`darken`:{let e=C(i,a);t.fragColor=z(e,i,a,o,s)}break;case`lighter`:t.fragColor=new A(i.multiply(o).add(a.multiply(s)),o.add(s));break;case`lighten`:{let e=be(i,a);t.fragColor=z(e,i,a,o,s)}break;case`color-dodge`:{let e=S(new v(rt(a.r,i.r),rt(a.g,i.g),rt(a.b,i.b)),new v(0),new v(1));t.fragColor=z(e,i,a,o,s)}break;case`color-burn`:{let e=new v(it(a.r,i.r),it(a.g,i.g),it(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`hard-light`:{let e=new v(at(a.r,i.r),at(a.g,i.g),at(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`soft-light`:{let e=new v(ot(a.r,i.r),ot(a.g,i.g),ot(a.b,i.b));t.fragColor=z(e,i,a,o,s)}break;case`difference`:{let e=xe(a.subtract(i));t.fragColor=z(e,i,a,o,s)}break;case`exclusion`:{let e=i.add(a).subtract(new w(2).multiply(i).multiply(a));t.fragColor=z(e,i,a,o,s)}break;case`invert`:t.fragColor=new A(new v(1).subtract(a).multiply(o).multiply(s).add(a.multiply(s).multiply(L(o))),s);break;case`vivid-light`:{let e=new v(S(st(a.r,i.r),new w(0),new w(1)),S(st(a.g,i.g),new w(0),new w(1)),S(st(a.b,i.b),new w(0),new w(1)));t.fragColor=z(e,i,a,o,s)}break;case`hue`:{let e=mt(i,a,a);t.fragColor=z(e,i,a,o,s)}break;case`saturation`:{let e=mt(a,i,a);t.fragColor=z(e,i,a,o,s)}break;case`color`:{let e=pt(i,a);t.fragColor=z(e,i,a,o,s)}break;case`luminosity`:{let e=pt(a,i);t.fragColor=z(e,i,a,o,s)}break;case`plus`:t.fragColor=S(new A(n.r.add(a.r),n.g.add(a.g),n.b.add(a.b),o.add(s)),new A(0),new A(1));break;case`minus`:t.fragColor=new A(S(new v(a.r.subtract(n.r),a.g.subtract(n.g),a.b.subtract(n.b)),new v(0),new v(1)),s.multiply(o));break;case`average`:{let e=a.add(i).divide(2);t.fragColor=z(e,i,a,o,s)}break;case`reflect`:{let e=S(new v(ht(a.r,i.r),ht(a.g,i.g),ht(a.b,i.b)),new v(0),new v(1));t.fragColor=z(e,i,a,o,s)}break;default:t.fragColor=n.multiply(this.config.opacity)}return t}};function z(e,t,n,r,i){return new A(e.multiply(r).multiply(i).add(t.multiply(r).multiply(L(i))).add(n.multiply(i).multiply(L(r))),r.add(i.multiply(L(r))))}function nt(e,t){return new w(1).subtract(D(new w(.5),t)).multiply(L(new w(2).multiply(L(t).multiply(L(e))))).add(D(new w(.5),t).multiply(new w(2).multiply(t).multiply(e)))}function rt(e,t){return y(F(e,new w(0)),new w(0),y(F(t,new w(1)),new w(1),C(new w(1),e.divide(new w(1).subtract(t)))))}function it(e,t){return y(F(e,new w(1)),new w(1),y(F(t,new w(0)),new w(0),L(C(new w(1),L(e).divide(t)))))}function at(e,t){return new w(1).subtract(D(new w(.5),t)).multiply(new w(2).multiply(t).multiply(e)).add(D(new w(.5),t).multiply(L(new w(2).multiply(L(t).multiply(L(e))))))}function ot(e,t){return Ne([Ee(t,new w(.5)),()=>{let n=new w(2).multiply(t),r=L(n),i=L(e);return e.subtract(r.multiply(e).multiply(i))}],[Ee(e,new w(.25)),()=>{let n=new w(2).multiply(t),r=Ke(n).multiply(e),i=new w(16).multiply(e).subtract(new w(12)).multiply(e).add(new w(3));return e.add(r.multiply(i))}],[!0,()=>{let n=new w(2).multiply(t),r=Ke(n),i=Me(e).subtract(e);return e.add(r.multiply(i))}])}function st(e,t){let n=L(D(new w(.5),t)).multiply(it(e,new w(2).multiply(t))),r=D(new w(.5),t).multiply(rt(e,new w(2).multiply(qe(t,.5))));return n.add(r)}function ct(e){return C(C(e.r,e.g),e.b)}function lt(e){return be(be(e.r,e.g),e.b)}function ut(e){return Pe(e,new v(.3,.59,.11))}function dt(e){return lt(e).subtract(ct(e))}function ft(e){let t=ut(e),n=ct(e),r=lt(e);return Ne([Te(n,new w(0)),()=>{let r=e.subtract(t).multiply(t),i=t.subtract(n);return t.add(r.divide(i))}],[He(r,new w(1)),()=>{let n=e.subtract(t),i=L(t),a=n.multiply(i),o=r.subtract(t);return t.add(a.divide(o))}],[!0,e])}function pt(e,t){let n=ut(e),r=ut(t).subtract(n);return ft(e.add(new v(r)))}function mt(e,t,n){let r=ct(e),i=dt(e),a=dt(t);return pt(y(He(i,new w(0)),()=>e.subtract(r).multiply(a).divide(i),new v(0)),n)}function ht(e,t){return y(F(t,new w(1)),t,()=>{let n=L(t),r=e.multiply(e).divide(n);return C(r,new w(1))})}i([je],tt.prototype,`blendMode`,void 0),i([E(R)],tt.prototype,`config`,void 0),i([m(0,M($e))],tt.prototype,`vertex`,null),i([m(0,M(et))],tt.prototype,`fragment`,null);var gt=class extends N{};i([T(0,I)],gt.prototype,`position`,void 0);var _t=class extends k{},vt=class extends P{};i([E(b)],vt.prototype,`layerTexture`,void 0),i([E(w)],vt.prototype,`opacity`,void 0);var yt=class extends j{constructor(){super(...arguments),this.type=`OpacityShader`}vertex(e){return{uv:e.position,glPosition:new A(e.position.subtract(new I(.5)).multiply(2),0,1)}}fragment(e){let t=new O;return t.fragColor=x(this.config.layerTexture,e.uv).multiply(this.config.opacity),t}};i([E(vt)],yt.prototype,`config`,void 0),i([m(0,M(gt))],yt.prototype,`vertex`,null),i([m(0,M(_t))],yt.prototype,`fragment`,null);var bt={vertexShader:_(`highlight/textured.vert`),fragmentShader:_(`highlight/highlight.frag`)},xt={vertexShader:_(`highlight/textured.vert`),fragmentShader:_(`highlight/blur.frag`)},St=class extends N{};i([T(0,I)],St.prototype,`position`,void 0);var B=class extends k{},V=class extends j{constructor(){super(...arguments),this.type=`PostProcessingShader`}vertex(e){return{uv:e.position,glPosition:new A(Ge(e.position),0,1)}}};i([m(0,M(St))],V.prototype,`vertex`,null);var Ct=class extends P{};i([E(b)],Ct.prototype,`blitTexture`,void 0);var wt=class extends V{fragment(e){let t=new O;return t.fragColor=x(this.blitConfig.blitTexture,e.uv),t}};i([E(Ct)],wt.prototype,`blitConfig`,void 0),i([m(0,M(B))],wt.prototype,`fragment`,null);var H=class extends P{};i([E(b)],H.prototype,`luminosityTexture`,void 0),i([E(v)],H.prototype,`defaultColor`,void 0),i([E(w)],H.prototype,`defaultOpacity`,void 0),i([E(w)],H.prototype,`luminosityThreshold`,void 0),i([E(w)],H.prototype,`smoothWidth`,void 0);var Tt=class extends V{constructor(){super(...arguments),this.type=`LuminosityHighPassShader`}fragment(e){let t=new O,n=x(this.luminosityHighPassConfig.luminosityTexture,e.uv),r=new v(.299,.587,.114),i=Pe(n.xyz,r),a=new A(this.luminosityHighPassConfig.defaultColor.rgb,this.luminosityHighPassConfig.defaultOpacity),o=De(this.luminosityHighPassConfig.luminosityThreshold,this.luminosityHighPassConfig.luminosityThreshold.add(this.luminosityHighPassConfig.smoothWidth),i);return t.fragColor=Ce(a,n,o),t}};i([E(H)],Tt.prototype,`luminosityHighPassConfig`,void 0),i([m(0,M(B))],Tt.prototype,`fragment`,null);var U=class extends P{};i([E(b)],U.prototype,`blurTexture1`,void 0),i([E(b)],U.prototype,`blurTexture2`,void 0),i([E(b)],U.prototype,`blurTexture3`,void 0),i([E(b)],U.prototype,`blurTexture4`,void 0),i([E(b)],U.prototype,`blurTexture5`,void 0),i([E(w)],U.prototype,`bloomStrength`,void 0),i([E(w)],U.prototype,`bloomRadius`,void 0),i([E(Ae.ofType(w,5))],U.prototype,`bloomFactors`,void 0),i([E(v)],U.prototype,`bloomTintColor`,void 0);var Et=class extends V{constructor(){super(...arguments),this.type=`CompositeShader`}fragment(e){let t=new O,{blurTexture1:n,blurTexture2:r,blurTexture3:i,blurTexture4:a,blurTexture5:o,bloomStrength:s,bloomFactors:c,bloomTintColor:l}=this.compositeConfig,u=this._lerpBloomFactor(c[0]).multiply(new A(l,1).multiply(x(n,e.uv))),d=this._lerpBloomFactor(c[1]).multiply(new A(l,1).multiply(x(r,e.uv))),f=this._lerpBloomFactor(c[2]).multiply(new A(l,1).multiply(x(i,e.uv))),p=this._lerpBloomFactor(c[3]).multiply(new A(l,1).multiply(x(a,e.uv))),m=this._lerpBloomFactor(c[4]).multiply(new A(l,1).multiply(x(o,e.uv))),ee=s.multiply(u.add(d.add(f.add(p.add(m)))));return t.fragColor=S(ee,new w(0),new w(1)),t}_lerpBloomFactor(e){let t=new w(1.2).subtract(e);return Ce(e,t,this.compositeConfig.bloomRadius)}};i([je],Et.prototype,`numMips`,void 0),i([E(U)],Et.prototype,`compositeConfig`,void 0),i([m(0,M(B))],Et.prototype,`fragment`,null);var Dt=class extends P{};i([E(b)],Dt.prototype,`texture`,void 0),i([E(I)],Dt.prototype,`texSize`,void 0),i([E(I)],Dt.prototype,`direction`,void 0),i([E(w)],Dt.prototype,`sigma`,void 0);var Ot=class extends V{constructor(){super(...arguments),this.type=`GaussianBlurShader`}fragment(e){let t=new O,n=new w(1).divide(this.gaussianBlurConfig.texSize),r=this.gaussianBlurConfig.sigma,i=kt(new w(0),r),a=x(this.gaussianBlurConfig.texture,e.uv).multiply(i);for(let t=1;t<this.kernelRadius;t++){let o=new w(t),s=kt(o,r),c=this.gaussianBlurConfig.direction.multiply(n).multiply(o),l=x(this.gaussianBlurConfig.texture,e.uv.add(c)),u=x(this.gaussianBlurConfig.texture,e.uv.subtract(c));a=a.add(l.multiply(s)).add(u.multiply(s)),i=i.add(new w(2).multiply(s))}return t.fragColor=a.divide(i),t}};function kt(e,t){return new w(.39894).multiply(Be(new w(-.5).multiply(e).multiply(e).divide(t.multiply(t))).divide(t))}i([je],Ot.prototype,`kernelRadius`,void 0),i([E(Dt)],Ot.prototype,`gaussianBlurConfig`,void 0),i([m(0,M(B))],Ot.prototype,`fragment`,null);var At=class extends P{};i([E(b)],At.prototype,`texture`,void 0);var jt=1,Mt=2.2,Nt=[-.08,-.05,-.03,-.02,-.01,.01,.02,.03,.05,.08],Pt=class extends V{constructor(){super(...arguments),this.type=`RadialBlurShader`}fragment(e){let t=new O,n=new w(.5).subtract(e.uv),r=Me(n.x.multiply(n.y).add(n.y.multiply(n.y)));n=n.divide(r);let i=x(this.radialBlurConfig.texture,e.uv),a=i;for(let t=0;t<10;t++){let r=x(this.radialBlurConfig.texture,e.uv.add(n).multiply(new w(Nt[t]).multiply(jt)));a=a.add(r)}let o=new w(1).divide(new w(11));a=a.multiply(o);let s=r.multiply(Mt);return s=S(s,new w(0),new w(1)),t.fragColor=Ce(i,a,s),t}};i([je],Pt.prototype,`kernelRadius`,void 0),i([E(At)],Pt.prototype,`radialBlurConfig`,void 0),i([m(0,M(B))],Pt.prototype,`fragment`,null);var Ft=class extends P{};i([E(b)],Ft.prototype,`colorTexture`,void 0),i([E(ze)],Ft.prototype,`coefficients`,void 0);var It=class extends V{constructor(){super(...arguments),this.type=`FilterEffectShader`}fragment(e){let t=new O,n=x(this.filterEffectConfig.colorTexture,e.uv),r=y(He(n.a,new w(0)),n.rgb.divide(n.a),new v(0)),i=this.filterEffectConfig.coefficients.multiply(new A(r,1)),a=n.a;return t.fragColor=new A(a.multiply(i.rgb),a),t}};i([E(Ft)],It.prototype,`filterEffectConfig`,void 0),i([m(0,M(B))],It.prototype,`fragment`,null);var W=class extends P{};i([E(b)],W.prototype,`layerFBOTexture`,void 0),i([E(b)],W.prototype,`blurTexture`,void 0),i([E(A)],W.prototype,`shadowColor`,void 0),i([E(I)],W.prototype,`shadowOffset`,void 0),i([E(Ve)],W.prototype,`displayViewMat3`,void 0);var Lt=class extends V{constructor(){super(...arguments),this.type=`CompositeShader`}fragment(e){let t=new O,{layerFBOTexture:n,blurTexture:r,shadowColor:i,shadowOffset:a,displayViewMat3:o}=this.compositeConfig,s=o.multiply(new v(a,new w(0))),c=x(n,e.uv);return t.fragColor=x(r,e.uv.subtract(s.xy.divide(2))).a.multiply(i).multiply(new w(1).subtract(c.a)).add(c),t}};i([E(W)],Lt.prototype,`compositeConfig`,void 0),i([m(0,M(B))],Lt.prototype,`fragment`,null);var G=!!ae(`esri-2d-profiler`),Rt=class{constructor(e,t){if(this._events=new ge,this._entries=new Map,this._timings=new Je(10),this._currentContainer=null,this._currentPass=null,this._currentBrush=null,this._currentSummary=null,!G)return;this._ext=Ye(e.gl,{}),this._debugOutput=t;let n=e.gl;if(!this.enableCommandLogging)return;let r;for(r in n)if(typeof n[r]==`function`){let e=n[r],t=r.includes(`draw`);n[r]=(...i)=>(this._events.emit(`command`,{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:r,args:i,isDrawCommand:t}),this._currentSummary&&(this._currentSummary.commands++,t&&this._currentSummary.drawCommands++),e.apply(n,i))}}get enableCommandLogging(){return typeof G==`object`&&G.commandLogging}get enableTimeLogging(){return typeof G==`object`&&G.timeLogging}get lastTime(){return this._timings.peekLast()}recordContainerStart(e){G&&(this._currentContainer=e)}recordContainerEnd(){G&&(this._currentContainer=null)}recordPassStart(e){G&&(this._currentPass=e,this._initSummary())}recordPassEnd(){G&&(this._currentPass=null,this._emitSummary())}recordBrushStart(e){G&&(this._currentBrush=e)}recordBrushEnd(){G&&(this._currentBrush=null)}recordStart(e){if(G&&this._ext!=null){if(this._entries.has(e)){let t=this._entries.get(e),n=this._ext.resultAvailable(t.query),r=this._ext.disjoint();if(n&&!r){let n=this._ext.getResult(t.query)/1e6,r=0;if(this._timings.enqueue(n)!=null&&this.enableTimeLogging){let e=this._timings.entries,t=e.length,n=0;for(let t of e)n+=t;r=n/t}let i=n.toFixed(2),a=r?r.toFixed(2):`--`;this.enableCommandLogging?(this.enableTimeLogging?console.groupCollapsed(`Frame report for ${e}, ${i} ms (${a} last 10 avg)\n              ${t.commandsLen} Commands (${t.drawCommands} draw)`):console.groupCollapsed(`Frame report for ${e}\n              ${t.commandsLen} Commands (${t.drawCommands} draw)`),console.log(`RenderPass breakdown: `),console.table(t.summaries),console.log(`Commands: `,t.commands),console.groupEnd()):this.enableTimeLogging&&console.log(`Frame report for ${e}, ${i} ms (${a} last 10 avg)`),this.enableTimeLogging&&(this._debugOutput.innerHTML=`${i} (${a})`)}for(let e of t.handles)e.remove();this._ext.deleteQuery(t.query),this._entries.delete(e)}let t={name:e,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(t.handles.push(this._events.on(`command`,e=>{t.commandsLen++,t.commands.push(e),e.isDrawCommand&&t.drawCommands++})),t.handles.push(this._events.on(`summary`,e=>{t.summaries.push(e)}))),this._ext.beginTimeElapsed(t.query),this._entries.set(e,t)}}recordEnd(e){G&&this._ext!=null&&this._entries.has(e)&&this._ext.endTimeElapsed()}_initSummary(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})}_emitSummary(){this.enableCommandLogging&&this._currentSummary&&this._events.emit(`summary`,this._currentSummary)}},zt=class extends N{};i([T(0,I)],zt.prototype,`position`,void 0),i([T(1,I)],zt.prototype,`texcoord`,void 0),i([T(2,w)],zt.prototype,`w`,void 0);var Bt=class extends k{},Vt=class extends P{};i([E(b)],Vt.prototype,`texture`,void 0),i([E(w)],Vt.prototype,`opacity`,void 0);var Ht=class extends j{constructor(){super(...arguments),this.type=`VideoScreenShader`}vertex(e){let{position:t,texcoord:n,w:r}=e;return{glPosition:new A(t,0,r),texcoord:n}}fragment(e){let t=new O;return t.fragColor=x(this.config.texture,e.texcoord).multiply(this.config.opacity),t}};i([E(Vt)],Ht.prototype,`config`,void 0),i([m(0,M(zt))],Ht.prototype,`vertex`,null),i([m(0,M(Bt))],Ht.prototype,`fragment`,null);var Ut=7e6,Wt=class{constructor(){this.styles=new Map,this.layerContexts=new Map}get cachedStyles(){return this.styles}setLabelClassStyle(e,t,n){this.layerContexts.set(e,t),this.styles.set(e,n)}removeContainer(e){for(let[t,n]of this.layerContexts.entries())n===e&&this.layerContexts.delete(t)}},K=class extends f{constructor(e){super(e),this._faderWorkingSet=[],this._styleRepository=new Wt,this.lastUpdateId=-1,this.updateRequested=!1,this.view=null,this.symbolFader=new Xe(`feature-tile`,this._styleRepository,(e,t)=>{e.updateLabelVisibility(),e.requestRender(),e.isReady&&(e.decluttered=!0)},this._faderWorkingSet,512,Ut)}get updating(){return ae(`esri-2d-log-updating`)&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`),this.updateRequested}viewChange(){this.requestUpdate()}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view?.requestUpdate())}processUpdate(e){this.doUpdate(e)?this.updateRequested=!1:(this.updateRequested=!0,this.view?.requestUpdate())}setLabelSchemaStyles(e,t){let n;switch(e.type){case`label`:n=e.classes;break;case`subtype`:n=Array.from(Object.values(e.renderers).flatMap(e=>e.classes));break;case`cluster`:n=[...e.cluster.classes,...e.feature.classes];break;case`track`:n=[...e.latestObservation.classes,...e.previousObservation.classes,...e.trackLine.classes]}for(let e of n){let n=Gt(e);this._styleRepository.setLabelClassStyle(e.labelClassId,t,n)}}removeContainer(e){this._styleRepository.removeContainer(e),this.requestUpdate()}doUpdate(e){this._faderWorkingSet.length=0;let t=this.view;if(!t)return!1;let n=t.allLayerViews.map(e=>e.featureContainer).filter(e=>!!e&&e?.hasLabels);if(n.length>0){for(let t of n)for(let n of t.tiles||[])n.setTransform(e.state),this._faderWorkingSet.push(n);let r=e.state.scale,i=t.featuresTilingScheme.scaleToZoom(r);return this.symbolFader.update(i,e.state)}return!0}};function Gt(e){let t=e.geometryType===`esriGeometryPolyline`?0:1,n=e.geometryType===`esriGeometryPolyline`?0:1;return{geometryType:e.geometryType,iconAllowOverlap:!e.deconflictionEnabled,iconIgnorePlacement:!1,textAllowOverlap:!e.deconflictionEnabled,textIgnorePlacement:!1,iconRotationAlignment:t,textRotationAlignment:t,iconTranslateAnchor:n,iconTranslate:[0,0],textTranslateAnchor:n,textTranslate:[0,0]}}i([u()],K.prototype,`updateRequested`,void 0),i([u()],K.prototype,`updating`,null),i([u()],K.prototype,`view`,void 0),K=i([h(`esri.views.2d.LabelManager`)],K);var Kt=`esri-zoom-box`,qt={container:`${Kt}__container`,overlay:`${Kt}__overlay`,background:`${Kt}__overlay-background`,box:`${Kt}__outline`},Jt={zoom:`Shift`,counter:`Control`},Yt=class extends f{constructor(e){super(e),this._container=null,this._overlay=null,this._backgroundShape=null,this._boxShape=null,this._box={x:0,y:0,width:0,height:0},this._rafId=null,this._redraw=this._redraw.bind(this)}destroy(){this.view=null}set view(e){this.removeAllHandles(),this._destroyOverlay(),this._set(`view`,e),e&&this.addHandles([e.on(`drag`,[Jt.zoom],e=>this._handleDrag(e,1),_e.INTERNAL),e.on(`drag`,[Jt.zoom,Jt.counter],e=>this._handleDrag(e,-1),_e.INTERNAL)])}_start(){this._createContainer(),this._createOverlay(),this.navigation.begin()}_update(e,t,n,r){this._box.x=e,this._box.y=t,this._box.width=n,this._box.height=r,this._rafId||=requestAnimationFrame(this._redraw)}_end(e,t,n,r,i){let a=this.view,o=a.toMap(re(e+.5*n,t+.5*r)),s=Math.max(n/a.width,r/a.height);i===-1&&(s=1/s),this._destroyOverlay(),this.navigation.end(),a.goTo({center:o,scale:a.scale*s},{animationMode:`always`,duration:oe()})}_updateBox(e,t,n,r){let i=this._boxShape;i.setAttributeNS(null,`x`,``+e),i.setAttributeNS(null,`y`,``+t),i.setAttributeNS(null,`width`,``+n),i.setAttributeNS(null,`height`,``+r),i.setAttributeNS(null,`class`,qt.box)}_updateBackground(e,t,n,r){this._backgroundShape.setAttributeNS(null,`d`,this._toSVGPath(e,t,n,r,this.view.width,this.view.height))}_createContainer(){let e=document.createElement(`div`);e.className=qt.container,this.view.root.appendChild(e),this._container=e}_createOverlay(){let e=this.view.width,t=this.view.height,n=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);n.setAttributeNS(null,`d`,`M 0 0 L `+e+` 0 L `+e+` `+t+` L 0 `+t+` Z`),n.setAttributeNS(null,`class`,qt.background);let r=document.createElementNS(`http://www.w3.org/2000/svg`,`rect`),i=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);i.setAttributeNS(`http://www.w3.org/2000/xmlns/`,`xmlns:xlink`,`http://www.w3.org/1999/xlink`),i.setAttributeNS(null,`class`,qt.overlay),i.appendChild(n),i.appendChild(r),this._container.appendChild(i),this._backgroundShape=n,this._boxShape=r,this._overlay=i}_destroyOverlay(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null}_toSVGPath(e,t,n,r,i,a){let o=e+n,s=t+r;return`M 0 0 L `+i+` 0 L `+i+` `+a+` L 0 `+a+` ZM `+e+` `+t+` L `+e+` `+s+` L `+o+` `+s+` L `+o+` `+t+` Z`}_handleDrag(e,t){let n=e.x,r=e.y,i=e.origin.x,a=e.origin.y,o,s,c,l;switch(n>i?(o=i,c=n-i):(o=n,c=i-n),r>a?(s=a,l=r-a):(s=r,l=a-r),e.action){case`start`:this._start();break;case`update`:this._update(o,s,c,l);break;case`end`:this._end(o,s,c,l,t)}e.stopPropagation()}_redraw(){if(!this._rafId||(this._rafId=null,!this._overlay))return;let{x:e,y:t,width:n,height:r}=this._box;this._updateBox(e,t,n,r),this._updateBackground(e,t,n,r),this._rafId=requestAnimationFrame(this._redraw)}};i([u()],Yt.prototype,`navigation`,void 0),i([u()],Yt.prototype,`view`,null),Yt=i([h(`esri.views.2d.navigation.ZoomBox`)],Yt);var q=class{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){let t=this.computeDelta(e);this._updateDelta(t)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return this.lastValue!==void 0}hasFilteredDelta(){return this.filteredDelta!==void 0}computeDelta(e){return this.lastValue===void 0?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta===void 0?this.filteredDelta=e:this.filteredDelta=(1-this._gain)*this.filteredDelta+this._gain*e}},Xt=class{constructor(e,t,n){this._initialVelocity=e,this._stopVelocity=t,this._friction=n,this._duration=g(Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction)))}get duration(){return this._duration}isFinished(e){return e>this.duration}get friction(){return this._friction}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,t){let n=this.value(e);return this.value(e+t)-n}valueFromInitialVelocity(e,t){t=Math.min(t,this.duration);let n=1-this.friction;return e*(n**t-1)/Math.log(n)}},Zt=class extends Xt{constructor(e,t,n,r,i){super(e,t,n),this._sceneVelocity=r,this.direction=i}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}},Qt=class{constructor(e=300,t=12,n=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this.enabled=!0,this._time=new q(.6),this._screen=[new q(.4),new q(.4)],this._scene=[new q(.6),new q(.6),new q(.6)],this._tmpDirection=s()}add(e,t,n){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(n)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(n)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;let e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,n=e==null||t==null?0:Math.sqrt(e*e+t*t),r=this._time.filteredDelta,i=r==null||n==null?0:n/r;return Math.abs(i)<this._minimumInitialVelocity?null:this.createMomentum(i,this._stopVelocity,this._friction)}createMomentum(t,n,r){e(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);let i=he(this._tmpDirection);i>0&&l(this._tmpDirection,this._tmpDirection,1/i);let a=this._time.filteredDelta;return new Zt(t,n,r,a==null?0:i/a,this._tmpDirection)}},J=class extends f{constructor(e){super(e),this.animationTime=g(0),this.momentumEstimator=new Qt(500,6,.92),this.momentum=null,this.tmpMomentum=s(),this.momentumFinished=!1,this.viewpoint=new r({targetGeometry:new n,scale:0,rotation:0}),this._previousDrag=null,this.addHandles(te(()=>this.momentumFinished,()=>this.navigation.stop()))}begin(e,t){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(t),this._previousDrag=t}update(e,t){this.addToEstimator(t);let n=t.center.x,r=t.center.y,i=this._previousDrag;n=i?i.center.x-n:-n,r=i?r-i.center.y:r,e.viewpoint=ue(this.viewpoint,e.viewpoint,[n||0,r||0]),this._previousDrag=t}end(e,t){this.addToEstimator(t),this.momentum=e.navigation.momentumEnabled&&!pe()?this.momentumEstimator.evaluateMomentum():null,this.animationTime=g(0),this.momentum&&this.onAnimationUpdate(e),this._previousDrag=null,this.navigation.end()}addToEstimator(e){let t=e.center.x,n=e.center.y,r=c(-t,n),i=ne(-t,n,0);this.momentumEstimator.add(r,i,.001*e.timestamp)}onAnimationUpdate(e){this.navigation.animationManager?.animateContinuous(e.viewpoint,(t,n)=>{let{momentum:r,animationTime:i,tmpMomentum:a}=this,o=this.momentumFinished=!r||r.isFinished(i),s=ce(n);if(!o){let n=r.valueDelta(i,s);l(a,r.direction,n),ue(t,t,a),e.constraints.constrainByGeometry(t)}this.animationTime=g(this.animationTime+s)})}stopMomentumNavigation(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())}};i([u()],J.prototype,`momentumFinished`,void 0),i([u()],J.prototype,`viewpoint`,void 0),i([u()],J.prototype,`navigation`,void 0),J=i([h(`esri.views.2d.navigation.actions.Pan`)],J);var $t=class{constructor(e=2.5,t=.01,n=.95,r=12){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this._maxVelocity=r,this.enabled=!0,this.value=new q(.8),this.time=new q(.3)}add(e,t){if(this.enabled&&t!=null){if(this.time.hasLastValue()){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta()){let t=this.value.computeDelta(e);this.value.filteredDelta*t<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=ie(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,t,n){return new Xt(e,t,n)}},en=class extends $t{constructor(e=3,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){let n=this.value.lastValue;if(n!=null){let t=e-n;for(;t>Math.PI;)t-=2*Math.PI;for(;t<-Math.PI;)t+=2*Math.PI;e=n+t}super.add(e,t)}},tn=class extends Xt{constructor(e,t,n){super(e,t,n)}value(e){let t=super.value(e);return Math.exp(t)}valueDelta(e,t){let n=super.value(e),r=super.value(e+t)-n;return Math.exp(r)}},nn=class extends $t{constructor(e=2.5,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){super.add(Math.log(e),t)}createMomentum(e,t,n){return new tn(e,t,n)}},Y=class extends f{constructor(e){super(e),this._animationTime=g(0),this._momentumFinished=!1,this._previousAngle=0,this._previousRadius=0,this._previousCenter=null,this._rotationMomentumEstimator=new en(.6,.15,.95),this._rotationDirection=1,this._startAngle=0,this._startRadius=0,this._updateTimestamp=null,this._zoomDirection=1,this._zoomMomentumEstimator=new nn,this._zoomOnly=null,this.viewpoint=new r({targetGeometry:new n,scale:0,rotation:0}),this.zoomMomentum=null,this.rotateMomentum=null,this.addHandles(te(()=>this._momentumFinished,()=>this.navigation.stop()))}begin(e,t){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=t.angle,this._previousRadius=this._startRadius=t.radius,this._previousCenter=t.center,this._updateTimestamp=null,e.constraints.rotationEnabled&&this.addToRotateEstimator(0,t.timestamp),this.addToZoomEstimator(t,1)}update(e,t){this._updateTimestamp===null&&(this._updateTimestamp=t.timestamp);let n=t.angle,r=t.radius,i=t.center,a=Math.abs(180*(n-this._startAngle)/Math.PI),o=Math.abs(r-this._startRadius),s=this._startRadius/r;if(this._previousRadius&&this._previousCenter){let c=r/this._previousRadius,l=180*(n-this._previousAngle)/Math.PI;this._rotationDirection=l>=0?1:-1,this._zoomDirection=c>=1?1:-1,e.constraints.rotationEnabled?(this._zoomOnly===null&&t.timestamp-this._updateTimestamp>200&&(this._zoomOnly=o-a>0),this._zoomOnly===null||this._zoomOnly?l=0:this.addToRotateEstimator(n-this._startAngle,t.timestamp)):l=0,this.addToZoomEstimator(t,s),this.navigation.setViewpoint([i.x,i.y],1/c,l,[this._previousCenter.x-i.x,i.y-this._previousCenter.y])}this._previousAngle=n,this._previousRadius=r,this._previousCenter=i}end(e){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=g(0),(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(e),this.navigation.end()}addToRotateEstimator(e,t){this._rotationMomentumEstimator.add(e,.001*t)}addToZoomEstimator(e,t){this._zoomMomentumEstimator.add(t,.001*e.timestamp)}canZoomIn(e){let t=e.scale,n=e.constraints.effectiveMaxScale;return n===0||t>n}canZoomOut(e){let t=e.scale,n=e.constraints.effectiveMinScale;return n===0||t<n}onAnimationUpdate(e){this.navigation.animationManager?.animateContinuous(e.viewpoint,(n,r)=>{let i=!this.canZoomIn(e)&&this._zoomDirection>1||!this.canZoomOut(e)&&this._zoomDirection<1,a=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime),s=i||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime),c=ce(r);if(this._momentumFinished=a&&s,!this._momentumFinished){let r=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,c))*this._rotationDirection*180/Math.PI:0,i=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,c)):1,a=se(),s=se();if(this._previousCenter){o(a,this._previousCenter.x,this._previousCenter.y),d(s,e.size,e.padding),t(a,a,s);let{constraints:c,scale:l}=e,u=l*i;i<1&&!c.canZoomInTo(u)?(i=l/c.effectiveMaxScale,this.zoomMomentum=null,this.rotateMomentum=null):i>1&&!c.canZoomOutTo(u)&&(i=l/c.effectiveMinScale,this.zoomMomentum=null,this.rotateMomentum=null),ee(n,e.viewpoint,i,r,a,e.size),e.constraints.constrainByGeometry(n)}}this._animationTime=g(this._animationTime+c)})}stopMomentumNavigation(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&=(this._rotationMomentumEstimator.reset(),null),this.zoomMomentum&&=(this._zoomMomentumEstimator.reset(),null),this.navigation.stop())}};i([u()],Y.prototype,`_momentumFinished`,void 0),i([u()],Y.prototype,`viewpoint`,void 0),i([u()],Y.prototype,`navigation`,void 0),Y=i([h(`esri.views.2d.navigation.actions.Pinch`)],Y);var rn=se(),an=se(),on=class extends f{constructor(e){super(e),this._previousCenter=se(),this.viewpoint=new r({targetGeometry:new n,scale:0,rotation:0})}begin(e,t){this.navigation.begin(),o(this._previousCenter,t.center.x,t.center.y)}update(e,t){let{state:{size:n,padding:r}}=e;o(rn,t.center.x,t.center.y),ve(an,n,r),e.viewpoint=p(this.viewpoint,e.state.paddedViewState.viewpoint,le(an,this._previousCenter,rn)),de(this._previousCenter,rn)}end(){this.navigation.end()}};i([u()],on.prototype,`viewpoint`,void 0),i([u()],on.prototype,`navigation`,void 0),on=i([h(`esri.views.2d.navigation.actions.Rotate`)],on);var X=10,sn=1,cn=new r({targetGeometry:new n}),ln=[0,0],un=250,Z=class extends f{constructor(e){super(e),this._endTimer=null,this._lastEventTimestamp=null,this.animationManager=null,this.interacting=!1}initialize(){this.pan=new J({navigation:this}),this.rotate=new on({navigation:this}),this.pinch=new Y({navigation:this}),this.zoomBox=new Yt({view:this.view,navigation:this})}destroy(){this.pan=me(this.pan),this.rotate=me(this.rotate),this.pinch=me(this.pinch),this.zoomBox=me(this.zoomBox),this.animationManager=null}begin(){this.stop(),this._set(`interacting`,!0)}end(){this._lastEventTimestamp=performance.now(),this._startTimer(un)}async zoom(e,t=this._getDefaultAnchor()){if(this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return e<1?this.zoomIn(t):this.zoomOut(t);this.setViewpoint(t,e,0,[0,0])}async zoomIn(e){let t=this.view,n=t.constraints.snapToNextScale(t.scale);return this._zoomToScale(n,e)}async zoomOut(e){let t=this.view,n=t.constraints.snapToPreviousScale(t.scale);return this._zoomToScale(n,e)}setViewpoint(e,t,n,r){this.begin(),this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,e,t,n,r),this.end()}setViewpointImmediate(e,t=0,n=[0,0],r=this._getDefaultAnchor()){this.view.stateManager.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,r,e,t,n)}continuousRotateClockwise(){let e=this.view.viewpoint;this.animationManager?.animateContinuous(e,e=>{p(e,e,-sn)})}continuousRotateCounterclockwise(){let e=this.view.viewpoint;this.animationManager?.animateContinuous(e,e=>{p(e,e,sn)})}resetRotation(){this.view.constraints.rotationEnabled&&(this.view.rotation=0)}continuousPanLeft(){this._continuousPan([-X,0])}continuousPanRight(){this._continuousPan([X,0])}continuousPanUp(){this._continuousPan([0,X])}continuousPanDown(){this._continuousPan([0,-X])}continuousPanVector({x:e,y:t}){this._continuousPan([e*X,t*X])}stop(){this.pan.stopMomentumNavigation(),this.animationManager?.stop(),this.end(),this._endTimer!==null&&(clearTimeout(this._endTimer),this._endTimer=null,this._set(`interacting`,!1))}_continuousPan(e){let t=this.view.viewpoint;this.animationManager?.animateContinuous(t,t=>{ue(t,t,e),this.view.constraints.constrainByGeometry(t)})}_startTimer(e){return this._endTimer!==null||(this._endTimer=setTimeout(()=>{this._endTimer=null;let e=performance.now()-(this._lastEventTimestamp??0);e<un?this._endTimer=this._startTimer(e):this._set(`interacting`,!1)},e)),this._endTimer}_getDefaultAnchor(){let{size:e,padding:{left:t,right:n,top:r,bottom:i}}=this.view;return ln[0]=.5*(e[0]-n+t),ln[1]=.5*(e[1]-i+r),ln}async _zoomToScale(e,t=this._getDefaultAnchor()){let{view:n}=this,{constraints:r,scale:i,viewpoint:o,size:s,padding:c}=n,l=r.canZoomInTo(e),u=r.canZoomOutTo(e);if(!(e<i&&!l||e>i&&!u))return a(cn,o,e/i,0,t,s,c),r.constrainByGeometry(cn),n.goTo(cn,{animate:!0,animationMode:`always`,duration:oe(),pickClosestTarget:!1})}_scaleRotateTranslateViewpoint(e,t,n,r,i){let{view:o}=this,{size:s,padding:c,constraints:l,scale:u,viewpoint:d}=o,f=u*n,p=l.canZoomInTo(f),m=l.canZoomOutTo(f);return(n<1&&!p||n>1&&!m)&&(n=1),ue(d,d,i),a(e,d,n,r,t,s,c),l.constrainByGeometry(e)}};i([u()],Z.prototype,`animationManager`,void 0),i([u({type:Boolean,readOnly:!0})],Z.prototype,`interacting`,void 0),i([u()],Z.prototype,`pan`,void 0),i([u()],Z.prototype,`pinch`,void 0),i([u()],Z.prototype,`rotate`,void 0),i([u()],Z.prototype,`view`,void 0),i([u()],Z.prototype,`zoomBox`,void 0),Z=i([h(`esri.views.2d.navigation.MapViewNavigation`)],Z);var dn=Z,fn=class extends N{};i([T(0,I)],fn.prototype,`position`,void 0);var pn=class extends k{},Q=class extends P{};i([E(b)],Q.prototype,`readbackTexture`,void 0),i([E(b)],Q.prototype,`maskTexture`,void 0),i([E(b)],Q.prototype,`overlayTexture`,void 0),i([E(A)],Q.prototype,`background`,void 0),i([E(A)],Q.prototype,`drawPos`,void 0),i([E(w)],Q.prototype,`maskEnabled`,void 0),i([E(w)],Q.prototype,`overlayEnabled`,void 0);var mn=class extends j{constructor(){super(...arguments),this.type=`MagnifierShader`}vertex(e){let t=e.position,n=e.position.subtract(new I(.5)).multiply(this.config.drawPos.zw),r=this.config.drawPos.xy.add(n);return{glPosition:new A(r,0,1),texCoord:t}}fragment(e){let t=x(this.config.readbackTexture,hn(e.texCoord));t=t.add(new w(1).subtract(t.a)).multiply(this.config.background);let n=y(F(this.config.maskEnabled,new w(1)),x(this.config.maskTexture,e.texCoord).a,new w(1));t=t.multiply(n);let r=y(F(this.config.overlayEnabled,new w(1)),x(this.config.overlayTexture,e.texCoord),new A(0)),i=new O;return i.fragColor=r.add(new w(1).subtract(r.a).multiply(t)),i}};function hn(e){let t=e.multiply(new I(2)).subtract(1);return y(F(t.x,new w(0)).and(F(t.y,new w(0))),new I(.5),()=>{let e=Re(t.y,t.x),n=we(Oe(t),new w(We)),r=new I(ke(e),Ie(e));return n.multiply(r).multiply(new I(.5)).add(new w(.5))})}i([E(Q)],mn.prototype,`config`,void 0),i([m(0,M(fn))],mn.prototype,`vertex`,null),i([m(0,M(pn))],mn.prototype,`fragment`,null);var gn=class extends N{};i([T(0,I)],gn.prototype,`position`,void 0);var _n=class extends k{},vn=class extends P{};i([E(Ve)],vn.prototype,`dvs`,void 0);var $=class extends P{};i([E(w)],$.prototype,`halfWidth`,void 0),i([E(w)],$.prototype,`aaWidth`,void 0),i([E(w)],$.prototype,`pxPerCell`,void 0),i([E(A)],$.prototype,`minorLineColor`,void 0),i([E(A)],$.prototype,`majorLineColor`,void 0),i([E(Se)],$.prototype,`majorLineInterval`,void 0);var yn=class extends j{constructor(){super(...arguments),this.type=`GridShader`}vertex(e){let t=e.position.multiply(2).subtract(1);return{gridPos:this.transform.dvs.multiply(new v(t,1)).xy,glPosition:new A(t,0,1)}}fragment(e){let t=xe(e.gridPos),n=ye(t),r=C(n.x,new w(1).subtract(n.x)),i=C(n.y,new w(1).subtract(n.y)),a=new I(r,i).multiply(this.config.pxPerCell).subtract(this.config.halfWidth),o=C(a.x,a.y),s=new w(1).subtract(De(new w(0),this.config.aaWidth,o)),c=new Se(Le(t.x)),l=new Se(Le(t.y)),u=new w(Fe(c,this.config.majorLineInterval)),d=new w(Fe(l,this.config.majorLineInterval)),f=y(Te(a.x,a.y),u,d),p=He(Ue(D(a.x,this.config.aaWidth),D(a.y,this.config.aaWidth)),new w(.5)),m=C(u,d),ee=y(p,m,f),te=Ce(this.config.majorLineColor,this.config.minorLineColor,C(ee,new w(1))),ne=new O;return ne.fragColor=te.multiply(s),ne}};i([E(vn)],yn.prototype,`transform`,void 0),i([E($)],yn.prototype,`config`,void 0),i([m(0,M(gn))],yn.prototype,`vertex`,null),i([m(0,M(_n))],yn.prototype,`fragment`,null);export{tt as _,Ht as a,It as c,Et as d,Tt as f,yt as g,xt as h,K as i,Pt as l,bt as m,mn as n,Rt as o,wt as p,dn as r,Lt as s,yn as t,Ot as u,Qe as v,Ze as y};