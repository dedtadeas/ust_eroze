import{AE as e,Ax as t,Bw as n,CD as r,ET as i,Ea as a,El as o,GE as s,GT as c,HS as l,Hx as u,IT as d,LT as f,Lx as p,MC as m,Ma as h,Mb as g,NS as _,Na as ee,Nm as te,Q as ne,QT as v,Qw as y,Sw as b,Sx as x,Ux as S,WE as re,WT as C,X as ie,XT as w,Xw as T,Ya as ae,Z as oe,Zw as se,_E as E,ao as D,fC as O,hE as ce,iE as k,iT as A,jm as j,kC as le,ka as ue,mT as de,ms as M,nE as N,oC as fe,oT as pe,qT as P,rE as F,rt as I,ta as L,vE as R}from"./index-BqmCqmfp.js";import"./memoryEstimations-O7VgDRVG.js";import"./TileInfoTilemapCache-CuMyse4g.js";import{t as z}from"./TilemapCache-C88wwB2j.js";import{t as B}from"./ArcGISCachedService-B2iHwO5Q.js";import"./colorUtils-uG2qTogT.js";import"./constants-gtdOjz1K.js";import"./GeometryUtils-DBkUrkz1.js";import{t as me}from"./StyleRepository-Dv4t_iVw.js";import"./VertexAttributeLocations-IAhvKZqd.js";import"./VertexElementDescriptor-BGWnA0Rs.js";var V=null;function he(e){if(V)return V;let t={lossy:`UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA`,lossless:`UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==`,alpha:`UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==`,animation:`UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA`};return V=new Promise(n=>{let r=new Image;r.onload=()=>{r.onload=r.onerror=null,n(r.width>0&&r.height>0)},r.onerror=()=>{r.onload=r.onerror=null,n(!1)},r.src=`data:image/webp;base64,`+t[e]}),V}var H=1.15,U=class{constructor(e,t){this._spriteSource=e,this._maxTextureSize=t,this.devicePixelRatio=1,this._spriteImageFormat=`png`,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus=`not-loaded`,e.type===`url`&&e.spriteFormat&&(this._spriteImageFormat=e.spriteFormat),e.pixelRatio&&(this.devicePixelRatio=e.pixelRatio),this.baseURL=e.spriteUrl}get spriteNames(){let e=[];for(let t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData?this._spritesData[e]:null}async load(e){if(this.baseURL){this.loadStatus=`loading`;try{await this._loadSprites(e),this.loadStatus=`loaded`}catch{this.loadStatus=`failed`}}else this.loadStatus=`failed`}async _loadSprites(e){this._isRetina=this.devicePixelRatio>H;let{width:t,height:n,data:r,json:i}=await this._getSpriteData(this._spriteSource,e),a=Object.keys(i);if(!a||a.length===0||!r)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=i,this.width=t,this.height=n;let o=Math.max(this._maxTextureSize,4096);if(t>o||n>o){let e=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${o} pixels}`;throw R.getLogger(`esri.layers.support.SpriteSource`).error(e),new E(`SpriteSource`,e)}let s;for(let e=0;e<r.length;e+=4)s=r[e+3]/255,r[e]=r[e]*s,r[e+1]=r[e+1]*s,r[e+2]=r[e+2]*s;this.image=r}async _getSpriteData(e,t){if(e.type===`image`){let t,n;if(this.devicePixelRatio<H){if(!e.spriteSource1x)throw new E(`SpriteSource`,`no image data provided for low resolution sprites!`);t=e.spriteSource1x.image,n=e.spriteSource1x.json}else{if(!e.spriteSource2x)throw new E(`SpriteSource`,`no image data provided for high resolution sprites!`);t=e.spriteSource2x.image,n=e.spriteSource2x.json}return`width`in t&&`height`in t&&`data`in t&&(re(t.data)||s(t.data))?{width:t.width,height:t.height,data:new Uint8Array(t.data),json:n}:{...W(t),json:n}}let n=C(this.baseURL),r=n.query?`?`+d(n.query):``,i=this._isRetina?`@2x`:``,a=`${n.path}${i}.${this._spriteImageFormat}${r}`,o=`${n.path}${i}.json${r}`,[c,l]=await Promise.all([b(o,t),b(a,{responseType:`image`,...t})]);return{...W(l.data),json:c.data}}};function W(e){let t=document.createElement(`canvas`),n=t.getContext(`2d`);t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(r.data)}}var ge=class{constructor(e){this.url=e}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||=b(this.url).then(e=>e.data.index),this._tileIndexPromise}async dataKey(e,t){let n=await this.fetchTileIndex();return A(t),this._getIndexedDataKey(n,e)}_getIndexedDataKey(e,t){let n=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return null;let r=t;for(;r.level!==0;)r=new o(r.level-1,r.row>>1,r.col>>1,r.world),n.push(r);let i,a,s=e,c=n.pop();if(s===1)return c;for(;n.length;)if(i=n.pop(),a=(1&i.col)+((1&i.row)<<1),s){if(s[a]===0){c=null;break}if(s[a]===1){c=i;break}c=i,s=s[a]}return c}},_e=class{constructor(e,t){this._tilemap=e,this._tileIndexUrl=t}destroy(){this._tilemap=de(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(e){return this._tileIndexPromise||=b(this._tileIndexUrl,{query:{...e?.query}}).then(e=>e.data.index),this._tileIndexPromise}dataKey(e,t){let{level:n,row:r,col:i}=e,a=new o(e);return this._tilemap.fetchAvailabilityUpsample(n,r,i,a,t).then(()=>(a.world=e.world,a)).catch(e=>{if(se(e))throw e;return null})}},ve=class{constructor(e){this._tileUrl=e,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(t){(this._promise==null||T(this._abortController?.signal))&&(this._promise=this._makeRequest(this._tileUrl));let n=this._abortOptions;return n.push(t),pe(t,()=>{n.every(e=>T(e))&&this._abortController.abort()}),this._promise.then(t=>e(t))}async _makeRequest(e){this._abortController=new AbortController;let{data:t}=await b(e,{responseType:`array-buffer`,signal:this._abortController.signal});return t}},G=new Map;function ye(e,t,n,r,i){let a=C(e),o=a.query;if(o)for(let[e,i]of Object.entries(o))switch(i){case`{x}`:o[e]=r.toString();break;case`{y}`:o[e]=n.toString();break;case`{z}`:o[e]=t.toString()}let s=a.path;return be(f(s.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,n.toString()).replaceAll(/\{x\}/gi,r.toString()),{...a.query}),i)}function be(e,t){return i(G,e,()=>new ve(e)).getData(t).finally(()=>G.delete(e))}var xe=class{constructor(t,n,r){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=t,this.sourceUrl=n;let i=C(this.sourceUrl),a=e(r),o=a.tiles;if(i)for(let e=0;e<o.length;e++){let t=C(o[e]);t&&(v(t.path)||(t.path=w(i.path,t.path)),o[e]=f(t.path,{...i.query,...t.query}))}this.tileServers=o;let s=r.capabilities&&r.capabilities.split(`,`).map(e=>e.toLowerCase().trim()),c=!0===r?.exportTilesAllowed,l=!0===s?.includes(`tilemap`),u=c&&r.hasOwnProperty(`maxExportTilesCount`)?r.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:c,supportsTileMap:l},exportTiles:c?{maxExportTilesCount:+u}:null},this.tileInfo=j.fromJSON(a.tileInfo);let d=r.tileMap?f(w(i.path,r.tileMap),i.query??{}):null;l?(this.type=`vector-tile`,this.tilemap=new _e(new z({layer:{parsedUrl:i,tileInfo:this.tileInfo},minLOD:a.minLOD??this.tileInfo.lods[0].level,maxLOD:a.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),d)):d&&(this.tilemap=new ge(d)),this.fullExtent=x.fromJSON(r.fullExtent),this.initialExtent=x.fromJSON(r.initialExtent)}destroy(){this.tilemap?.destroy()}async getRefKey(e,t){return this.tilemap?this.tilemap.dataKey(e,t):e}requestTile(e,t,n,r){let i=this.tileServers[t%this.tileServers.length];return ye(i,e,t,n,r)}isCompatibleWith(e){let t=this.tileInfo,n=e.tileInfo;if(!t.spatialReference.equals(n.spatialReference)||!t.origin.equals(n.origin)||Math.round(t.dpi)!==Math.round(n.dpi))return!1;let r=t.lods,i=n.lods,a=Math.min(r.length,i.length);for(let e=0;e<a;e++){let t=r[e],n=i[e];if(t.level!==n.level||Math.round(t.scale)!==Math.round(n.scale))return!1}return!0}};async function Se(e,t){let n={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:``,spriteFormat:`png`},[r,i]=typeof e==`string`?[e,null]:[null,e.jsonUrl];return await q(n,`esri`,e,i,t),{layerDefinition:n.validatedSource,url:r,serviceUrl:n.sourceUrl,style:n.style,styleUrl:n.styleUrl,spriteUrl:n.style&&n.style.sprite&&K(n.styleBase,n.style.sprite),spriteFormat:n.spriteFormat,glyphsUrl:n.style&&n.style.glyphs&&K(n.styleBase,n.style.glyphs),sourceNameToSource:n.sourceNameToSource,primarySourceName:n.primarySourceName}}function K(...e){let t;for(let n of e)n!=null&&(N(n)?t&&=t.split(`://`)[0]+`:`+n.trim():t=v(n)?n:w(t,n));return t?k(t):void 0}async function q(e,t,n,r,i){let a,o,s;if(A(i),typeof n==`string`){let e=c(n);s=await b(e,{...i,responseType:`json`,query:{f:`json`,...i?.query}}),s.ssl&&(a&&=a.replace(/^http:/i,`https:`),o&&=o.replace(/^http:/i,`https:`)),a=e,o=e}else n!=null&&(s={data:n},a=n.jsonUrl||null,o=r);let l=s?.data;if(Y(l))return e.styleUrl=a||null,we(e,l,o,i);if(Ce(l))return e.sourceUrl?X(e,l,o,!1,t,i):(e.sourceUrl=a||null,J(l)&&e.style==null&&(t=`tilejson`),X(e,l,o,!0,t,i));throw Error(`You must specify the URL or the JSON for a service or for a style.`)}function J(e){return typeof e==`object`&&!!e&&`tilejson`in e&&e.tilejson!=null}function Y(e){return!!e&&`sources`in e&&!!e.sources}function Ce(e){return!Y(e)}async function we(e,t,n,r){let i=n?P(n):F();e.styleBase=i,e.style=t,t[`sprite-format`]&&t[`sprite-format`].toLowerCase()===`webp`&&(e.spriteFormat=`webp`);let a=[];if(t.sources&&t.sources.esri){let n=t.sources.esri;n.url?await q(e,`esri`,K(i,n.url),void 0,r):a.push(q(e,`esri`,n,i,r))}for(let n of Object.keys(t.sources))n!==`esri`&&n!==`tilejson`&&t.sources[n].type===`vector`&&(t.sources[n].url?a.push(q(e,n,K(i,t.sources[n].url),void 0,r)):t.sources[n].tiles&&a.push(q(e,n,t.sources[n],i,r)));await Promise.all(a)}async function X(e,t,n,r,i,a){let o=n?k(n)+`/`:F(),s=Te(t,e),c=new xe(i,f(o,a?.query??{}),s);if(!r&&e.primarySourceName in e.sourceNameToSource){let t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(c))return;c.fullExtent!=null&&(t.fullExtent==null?t.fullExtent=c.fullExtent.clone():t.fullExtent.union(c.fullExtent)),t.tileInfo&&c.tileInfo&&t.tileInfo.lods.length<c.tileInfo.lods.length&&(t.tileInfo=c.tileInfo)}if(r&&(e.sourceBase=o,e.source=t,e.validatedSource=s,e.primarySourceName=i),e.sourceNameToSource[i]=c,!J(e)&&`defaultStyles`in t&&!e.style){if(t.defaultStyles==null)throw Error();return typeof t.defaultStyles==`string`?q(e,``,K(o,t.defaultStyles,`root.json`),void 0,a):q(e,``,t.defaultStyles,K(o,`root.json`),a)}if(J(t)&&e.style==null&&s.defaultStyles)return q(e,``,s.defaultStyles,K(o,`root.json`),a)}function Te(t,n){if(Ee(t)){let e=t?.tileInfo;return e!=null&&(e.rows??=512,e.cols??=512),t}let r={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100,latestWkid:3857}},i,a=null;if(J(t)){let{bounds:r,vector_layers:o}=t;if(r){let t=p({x:r[0],y:r[1],spatialReference:e(_)}),n=p({x:r[2],y:r[3],spatialReference:e(_)});a={xmin:t.x,ymin:t.y,xmax:n.x,ymax:n.y,spatialReference:e(l)}}if(o&&o.length>0)i={version:8,sprite:``,glyphs:``,sources:{tilejson:{type:`vector`,url:t.tilejson}},layers:De(o)};else if(n.style==null)throw Error(`The TileJSON source does not contain any vector_layers. This VectorTileLayer cannot be loaded.`)}a===null&&(a=r);let o=78271.51696400007,s=295828763.7957775,c=[],u=t.hasOwnProperty(`maxzoom`)&&t.maxzoom!=null?Math.abs(+t.maxzoom):22;for(let e=0;e<=u;e++)c.push({level:e,scale:s,resolution:o}),o/=2,s/=2;return{capabilities:`TilesOnly`,initialExtent:a,fullExtent:r,minScale:0,maxScale:0,tiles:t.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:`pbf`,origin:{x:-20037508.342787,y:20037508.342787},lods:c,spatialReference:e(l)},defaultStyles:i}}function Ee(e){return e.hasOwnProperty(`tileInfo`)}function De(e){let t=[];for(let n of e)n.geometry_type?t.push(Z(n.geometry_type.toLowerCase(),n,!1)):(t.push(Z(`polygon`,n,!0)),t.push(Z(`line`,n,!0)),t.push(Z(`circle`,n,!0)));return t}function Z(e,t,n){let{id:r,minzoom:i,maxzoom:a}=t,o={type:e===`polygon`||e===`polygons`?`fill`:e===`line`||e===`lines`?`line`:`circle`,id:r,source:`tilejson`,"source-layer":r,minzoom:i,maxzoom:a};switch(e){case`fill`:n&&(o.id+=`_polygon`,o.filter=`(["==", "$type", "Polygon"])`),o.paint={"fill-color":`#808080`};break;case`line`:n&&(o.id+=`_line`,o.filter=`(["==", "$type", "LineString"])`);break;case`circle`:n&&(o.id+=`_point`,o.filter=`(["==", "$type", "Point"])`)}return o}var Q=1e-6;function Oe(e,t){if(e===t)return!0;if(e==null&&t!=null||e!=null&&t==null||e==null||t==null||!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;let n=e.origin,r=t.origin;if(Math.abs(n.x-r.x)>=Q||Math.abs(n.y-r.y)>=Q)return!1;let i,a;e.lods[0].scale>t.lods[0].scale?(i=e,a=t):(a=e,i=t);for(let e=i.lods[0].scale;e>=a.lods[a.lods.length-1].scale-Q;e/=2)if(Math.abs(e-a.lods[0].scale)<Q)return!0;return!1}function ke(e,n){if(e===n)return e;if(e==null&&n!=null)return n;if(e!=null&&n==null)return e;if(e==null||n==null)return null;let r=e.size[0],i=e.format,a=e.dpi,o=new t({x:e.origin.x,y:e.origin.y}),s=e.spatialReference,c=e.lods[0].scale>n.lods[0].scale?e.lods[0]:n.lods[0],l=e.lods[e.lods.length-1].scale<=n.lods[n.lods.length-1].scale?e.lods[e.lods.length-1]:n.lods[n.lods.length-1],u=c.scale,d=c.resolution,f=l.scale,p=[],m=u,h=d,g=0;for(;m>=f;)p.push(new te({level:g,resolution:h,scale:m})),g++,m/=2,h/=2;return new j({size:[r,r],dpi:a,format:i||`pbf`,origin:o,lods:p,spatialReference:s})}var $=class extends ue(ie(oe(B(h(I(ne(a(ee(D(g)))))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType=`VectorTileLayer`,this.path=null,this.refreshInterval=0,this.style=null,this.tilemapCache=null,this.type=`vector-tile`}normalizeCtorArgs(e,t){return typeof e==`string`?{url:e,...t}:e}destroy(){if(this.sourceNameToSource)for(let e of Object.values(this.sourceNameToSource))e?.destroy();this.primarySource?.destroy(),this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(globalThis.devicePixelRatio||1,e)}load(e){let t=this.loadFromPortal({supportedTypes:[`Vector Tile Service`],supportsData:!1},e).catch(y).then(async()=>{if(!this.portalItem?.id)return;let t=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await b(t,{...e,query:{f:`json`,...this.customParameters,token:this.apiKey},authMode:this.portalItem.portal.authMode})).data&&this.read({url:t},ae(this.portalItem,`portal-item`))}).catch(y).then(()=>this._loadStyle(e));return this.addResolvingPromise(t),Promise.resolve(this)}get apiKey(){return super.apiKey}set apiKey(e){super.apiKey=e}set portalItem(e){super.portalItem=e}get attributionDataUrl(){let e=this.currentStyleInfo,t=e?.serviceUrl&&C(e.serviceUrl);if(!t)return null;let n=this._getDefaultAttribution(t.path);return n?f(n,{...this.customParameters,token:this.apiKey}):null}get capabilities(){let e=this.primarySource;return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){return this.primarySource?.fullExtent||null}get initialExtent(){return this.primarySource?.initialExtent||null}get parsedUrl(){return this.serviceUrl?C(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo?.serviceUrl||null}get spatialReference(){return this.tileInfo?.spatialReference??null}get styleUrl(){return this.currentStyleInfo?.styleUrl||null}writeStyleUrl(e,t){e&&N(e)&&(e=`https:${e}`);let r=ce(e);t.styleUrl=n(e,r)}get tileInfo(){let e=[];for(let t in this.sourceNameToSource)e.push(this.sourceNameToSource[t]);let t=this.primarySource?.tileInfo||new j;if(e.length>1)for(let n=0;n<e.length;n++)Oe(t,e[n].tileInfo)&&(t=ke(t,e[n].tileInfo));return t}readTilemapCache(e,t){return t.capabilities?.includes(`Tilemap`)?new z({layer:this}):null}set url(e){if(!e)return void this._set(`url`,e);let t=C(e);this._set(`url`,t.path),t.query&&(this.customParameters={...this.customParameters,...t.query})}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){let n=M().maxTextureSize,r=this.currentStyleInfo?.spriteUrl?f(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,i=new U({type:`url`,spriteUrl:r,pixelRatio:e,spriteFormat:this.currentStyleInfo?.spriteFormat},n);await i.load(t),this._spriteSourceMap.set(e,i)}return this._spriteSourceMap.get(e)}async setSpriteSource(e,t){if(!e)return null;let n=M().maxTextureSize,r=e.spriteUrl,i=r?f(r,{...this.customParameters,token:this.apiKey}):null;if(!i&&e.type===`url`)return null;let a=new U(e,n);try{await a.load(t);let n=e.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(n,a),i&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=i),this.emit(`spriteSource-change`,{spriteSource:a}),a}catch(e){y(e)}return null}async loadStyle(e,t){let n=e||this.style||this.url;return this._loadingTask&&typeof n==`string`&&this.url===n||(this._loadingTask?.abort(),this._loadingTask=O(e=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(n,{signal:e})),t)),this._loadingTask.promise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(t){return e(this.styleRepository?.getPaintProperties(t))}setPaintProperties(e,t){let n=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);let r=this.styleRepository.isPainterDataDriven(e);this.emit(`paint-change`,{layer:e,paint:t,isDataDriven:n||r})}getStyleLayer(t){return e(this.styleRepository.getStyleLayer(t))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit(`style-layer-change`,{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit(`delete-style-layer`,{layer:e})}getLayoutProperties(t){return e(this.styleRepository.getLayoutProperties(t))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit(`layout-change`,{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit(`style-layer-visibility-change`,{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}write(e,t){return t?.origin&&!this.styleUrl?(t.messages&&t.messages.push(new E(`vectortilelayer:unsupported`,`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}getTileUrl(e,t,n){return null}async _getSourceAndStyle(e,t){if(!e)throw Error(`invalid style!`);let n=await Se(e,{...t,query:{...this.customParameters,token:this.apiKey}});n.spriteFormat===`webp`&&(await he(`lossy`)||(n.spriteFormat=`png`)),this._set(`currentStyleInfo`,{...n}),typeof e==`string`?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set(`sourceNameToSource`,n.sourceNameToSource),this._set(`primarySource`,n.sourceNameToSource[n.primarySourceName]),this._set(`styleRepository`,new me(n.style,!1)),this.read(n.layerDefinition,{origin:`service`}),this.emit(`load-style`)}_getDefaultAttribution(e){let t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^/]+)?\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/vectortileserver/i),n=[`OpenBasemap_v2`,`OpenBasemap_GCS_v2`,`OpenStreetMap_v2`,`OpenStreetMap_Daylight_v2`,`OpenStreetMap_Export_v2`,`OpenStreetMap_FTS_v2`,`OpenStreetMap_GCS_v2`,`World_Basemap`,`World_Basemap_v2`,`World_Basemap_Export_v2`,`World_Basemap_GCS_v2`,`World_Basemap_WGS84`,`World_Contours_v2`,`World_Hillshade_v2`];if(!t)return;let r=t[2]&&t[2].toLowerCase();if(!r)return;let i=t[1]||``;for(let e of n)if(e.toLowerCase().includes(r))return c(`//static.arcgis.com/attribution/Vector${i}/${e}`)}async _loadStyle(e){return this._loadingTask?.promise??this.loadStyle(null,e)}};r([m({readOnly:!0})],$.prototype,`attributionDataUrl`,null),r([m({type:[`show`,`hide`]})],$.prototype,`listMode`,void 0),r([m({json:{read:!0,write:!0}})],$.prototype,`blendMode`,void 0),r([m({readOnly:!0,json:{read:!1}})],$.prototype,`capabilities`,null),r([m({readOnly:!0})],$.prototype,`currentStyleInfo`,void 0),r([m({json:{read:!1},readOnly:!0,type:x})],$.prototype,`fullExtent`,null),r([m({json:{read:!1},readOnly:!0,type:x})],$.prototype,`initialExtent`,null),r([m({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],$.prototype,`isReference`,void 0),r([m({type:[`VectorTileLayer`]})],$.prototype,`operationalLayerType`,void 0),r([m({readOnly:!0})],$.prototype,`parsedUrl`,null),r([m({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],$.prototype,`path`,void 0),r([m({type:Number,json:{write:!1,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],$.prototype,`refreshInterval`,void 0),r([m()],$.prototype,`style`,void 0),r([m({readOnly:!0})],$.prototype,`serviceUrl`,null),r([m({type:S,readOnly:!0})],$.prototype,`spatialReference`,null),r([m({readOnly:!0})],$.prototype,`styleRepository`,void 0),r([m({readOnly:!0})],$.prototype,`sourceNameToSource`,void 0),r([m({readOnly:!0})],$.prototype,`primarySource`,void 0),r([m({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],$.prototype,`styleUrl`,null),r([fe([`portal-item`,`web-document`],`styleUrl`)],$.prototype,`writeStyleUrl`,null),r([m({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:j})],$.prototype,`tileInfo`,null),r([m()],$.prototype,`tilemapCache`,void 0),r([u(`service`,`tilemapCache`,[`capabilities`,`tileInfo`])],$.prototype,`readTilemapCache`,null),r([m({json:{read:!1},readOnly:!0,value:`vector-tile`})],$.prototype,`type`,void 0),r([m({json:{origins:{"web-document":{read:{source:`styleUrl`}},"portal-item":{read:{source:`url`}}},write:!1,read:!1}}),m(L)],$.prototype,`url`,null),r([m({readOnly:!0})],$.prototype,`version`,void 0),r([u(`version`,[`version`,`currentVersion`])],$.prototype,`readVersion`,null),$=r([le(`esri.layers.VectorTileLayer`)],$);var Ae=$;export{Ae as default};