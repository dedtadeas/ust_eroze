import{$u as e,Cu as t,Ju as n,NT as r,Om as i,Qh as a,Sw as o,Wy as s,Xu as c,Yu as l,Zu as u,_E as d,bD as f,eg as p,po as m,uT as h}from"./index-BqmCqmfp.js";import{f as g,t as _}from"./colorUtils-uG2qTogT.js";import{r as v}from"./gfxUtils-DZoKCRMw.js";var y=0;function ee(){return y++}var b=0;function x(){return b++}var S=0;function C(){return S++}var w=`http://www.w3.org/2000/svg`,T=f(`android`),E=f(`chrome`)||T&&T>=4?`auto`:`optimizeLegibility`,te={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},D=/([A-DF-Za-df-z])|([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?)/g,O={},k={},A=Math.PI;function j(e,t){let n=e*(A/180);return Math.abs(t*Math.sin(n))+Math.abs(t*Math.cos(n))}function M(e){return e.map(e=>`${e.command} ${e.values.join(` `)}`).join(` `).trim()}function N(e,t,n,r,i){if(e){if(e.type===`circle`)return m(`circle`,{cx:e.cx,cy:e.cy,fill:t,"fill-rule":`evenodd`,r:e.r,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-dashoffset":n.dashOffset,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":`4`,"stroke-width":n.width});if(e.type===`ellipse`)return m(`ellipse`,{cx:e.cx,cy:e.cy,fill:t,"fill-rule":`evenodd`,rx:e.rx,ry:e.ry,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":`4`,"stroke-width":n.width});if(e.type===`rect`)return m(`rect`,{fill:t,"fill-rule":`evenodd`,height:e.height,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":`4`,"stroke-width":n.width,width:e.width,x:e.x,y:e.y});if(e.type===`image`)return m(`image`,{alt:i||`image`,height:e.height,href:e.src,preserveAspectRatio:`none`,width:e.width,x:e.x,y:e.y});if(e.type===`path`){let r=typeof e.path==`string`?e.path:M(e.path);return m(`path`,{d:r,fill:t,"fill-rule":`evenodd`,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":`4`,"stroke-width":n.width})}if(e.type===`text`)return h(r),m(`text`,{"dominant-baseline":r.dominantBaseline,fill:t,"fill-rule":`evenodd`,"font-family":r.font.family,"font-size":r.font.size,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,kerning:r.kerning,rotate:r.rotate,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":`4`,"stroke-width":n.width,"text-anchor":r.align,"text-decoration":r.decoration,"text-rendering":E,x:e.x,y:e.y},e.text)}return null}function P(e){if(!e)return{fill:`none`,pattern:null,linearGradient:null};if(!(`type`in e))return{fill:new s(e).toString(),pattern:null,linearGradient:null};if(e.type===`pattern`){let t=`patternId-${ee()}`;return{fill:`url(#${t})`,pattern:{id:t,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}},linearGradient:null}}let t=`linearGradientId-${x()}`;return{fill:`url(#${t})`,pattern:null,linearGradient:{id:t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map(e=>({offset:e.offset,color:e.color&&new s(e.color).toString()}))}}}function F(e){let t={color:`none`,width:1,cap:`butt`,join:`4`,dashArray:`none`,dashOffset:`0`};return e&&(e.width!=null&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new s(e.color).toString()),e.dashArray&&(t.dashArray=e.dashArray),e.dashoffset&&(t.dashOffset=e.dashoffset),e.style&&!e.dashArray&&(t.dashArray=v(e).join(`,`)||`none`)),t}function I(e,t){let n={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(e){let r=e.alignBaseline,i=r===`baseline`?`auto`:r===`top`?`text-top`:r===`bottom`?`hanging`:r;n.align=e.align,n.dominantBaseline=i,n.decoration=e.decoration,n.kerning=e.kerning?`auto`:`0`,n.rotate=e.rotated?`90`:`0`,h(t),n.font.style=t.style||`normal`,n.font.variant=t.variant||`normal`,n.font.weight=t.weight||`normal`,n.font.size=t.size&&t.size.toString()||`10pt`,n.font.family=t.family||`serif`}return n}function L(e){let{pattern:t,linearGradient:n}=e;if(t)return m(`pattern`,{height:t.height,id:t.id,patternUnits:`userSpaceOnUse`,width:t.width,x:t.x,y:t.y},m(`image`,{height:t.image.height,href:t.image.href,width:t.image.width,x:t.image.x,y:t.image.y}));if(n){let e=n.stops.map((e,t)=>m(`stop`,{key:`${t}-stop`,offset:e.offset,"stop-color":e.color}));return m(`linearGradient`,{gradientUnits:`userSpaceOnUse`,id:n.id,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2},e)}return null}function R(e,t){if(!e||e.length===0)return null;let n=[];for(let t of e){let{shape:e,fill:r,stroke:i,font:a}=t,o=P(r),s=F(i),c=e.type===`text`?I(e,a):null,l=N(e,o.fill,s,c);l&&n.push(l)}return m(`mask`,{id:t,maskUnits:`userSpaceOnUse`},m(`g`,null,n))}function z(e,t,r){return u(e,n(e),[t,r])}function B(e,t,r,i,a){return l(e,n(e),[t,r]),e[4]=e[4]*t-i*t+i,e[5]=e[5]*r-a*r+a,e}function V(t,r,i,a){let o=r%360*Math.PI/180;e(t,n(t),o);let s=Math.cos(o),c=Math.sin(o),l=t[4],u=t[5];return t[4]=l*s-u*c+a*c-i*s+i,t[5]=u*s+l*c-i*c-a*s+a,t}function H(e,t){O&&`left`in O?(O.left!=null&&O.left>e&&(O.left=e),(O.right==null||O.right<e)&&(O.right=e),(O.top==null||O.top>t)&&(O.top=t),(O.bottom==null||O.bottom<t)&&(O.bottom=t)):O={left:e,bottom:t,right:e,top:t}}function U(e){let t=e.args,n=t.length,r;switch(e.action){case`M`:case`L`:case`C`:case`S`:case`Q`:case`T`:for(r=0;r<n;r+=2)H(t[r],t[r+1]);k.x=t[n-2],k.y=t[n-1];break;case`H`:for(r=0;r<n;++r)H(t[r],k.y);k.x=t[n-1];break;case`V`:for(r=0;r<n;++r)H(k.x,t[r]);k.y=t[n-1];break;case`m`:{let e=0;for((`x`in k)||(H(k.x=t[0],k.y=t[1]),e=2),r=e;r<n;r+=2)H(k.x+=t[r],k.y+=t[r+1]);break}case`l`:case`t`:for(r=0;r<n;r+=2)H(k.x+=t[r],k.y+=t[r+1]);break;case`h`:for(r=0;r<n;++r)H(k.x+=t[r],k.y);break;case`v`:for(r=0;r<n;++r)H(k.x,k.y+=t[r]);break;case`c`:for(r=0;r<n;r+=6)H(k.x+t[r],k.y+t[r+1]),H(k.x+t[r+2],k.y+t[r+3]),H(k.x+=t[r+4],k.y+=t[r+5]);break;case`s`:case`q`:for(r=0;r<n;r+=4)H(k.x+t[r],k.y+t[r+1]),H(k.x+=t[r+2],k.y+=t[r+3]);break;case`A`:for(r=0;r<n;r+=7)H(t[r+5],t[r+6]);k.x=t[n-2],k.y=t[n-1];break;case`a`:for(r=0;r<n;r+=7)H(k.x+=t[r+5],k.y+=t[r+6])}}function W(e,t,n){let r=te[e.toLowerCase()],i;typeof r==`number`&&(r?t.length>=r&&(i={action:e,args:t.slice(0,t.length-t.length%r)},n.push(i),U(i)):(i={action:e,args:[]},n.push(i),U(i)))}function G(e){let t=(typeof e.path==`string`?e.path:M(e.path)).match(D),n=[];if(O={},k={},!t)return null;let r=``,i=[],a=t.length;for(let e=0;e<a;++e){let a=t[e],o=parseFloat(a);isNaN(o)?(r&&W(r,i,n),i=[],r=a):i.push(o)}W(r,i,n);let o={x:0,y:0,width:0,height:0};return O&&`left`in O&&(o.x=O.left,o.y=O.top,o.width=O.right-O.left,o.height=O.bottom-O.top),o}function K(e){let t={x:0,y:0,width:0,height:0};if(e.type===`circle`)t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if(e.type===`ellipse`)t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if(e.type===`image`||e.type===`rect`)t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if(e.type===`path`){let n=G(e);t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height}return t}function q(e){let t={x:0,y:0,width:0,height:0},n=null,r=-1/0,i=-1/0;for(let a of e)n?(n.x=Math.min(n.x,a.x),n.y=Math.min(n.y,a.y),r=Math.max(r,a.x+a.width),i=Math.max(i,a.y+a.height)):(n=t,n.x=a.x,n.y=a.y,r=a.x+a.width,i=a.y+a.height);return n&&(n.width=r-n.x,n.height=i-n.y),n}function J(e,n,r,i,a,o,s,l,u){let d=(s&&o?j(o,n):n)/2,f=(s&&o?j(o,r):r)/2;if(u){let e=u[0],t=u[1];d=(s&&o?j(o,e):e)/2,f=(s&&o?j(o,t):t)/2}let p=e.width+i,m=e.height+i,h=t(),g=t(),_=!1;if(a&&p!==0&&m!==0){let e=n===r?p/m:n/r,t=n>r?n:r,i=1,a=1;isNaN(t)||(e>1?(i=t/p,a=t/e/m):(a=t/m,i=t*e/p)),c(g,g,B(h,i,a,d,f)),_=!0}let v=e.x+(p-i)/2,y=e.y+(m-i)/2;if(c(g,g,z(h,d-v,f-y)),!_&&(p>n||m>r)){let e=p/n>m/r,t=(e?n:r)/(e?p:m);c(g,g,B(h,t,t,v,y))}return l&&c(g,g,z(h,l[0],l[1])),o&&c(g,g,V(h,o,v,y)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function Y(e){let t=e?.match(/bloom\(\s*([^\s]+)\s+([^\s]+)\s+([^\s]+)\s*\)/i);if(!t)return null;let[,n,r,i]=t;return{strength:Number(n),radius:p(a(r)),threshold:Number(i)}}function X(e,t,n){let r=Y(e);if(!r)return null;let{strength:i,radius:a}=r,o=i>0?a:0,s=(i+o)*t,c=4*i+1;return m(`filter`,{filterUnits:`userSpaceOnUse`,height:`300%`,id:`bloom${n}`,width:`300%`,x:`-100%`,y:`-100%`},m(`feMorphology`,{in:`SourceGraphic`,operator:`dilate`,radius:(i+.5*o)*(5**(t/100)*(.4+t/100)),result:`dilate`}),m(`feGaussianBlur`,{in:`dilate`,result:`blur`,stdDeviation:s/25}),m(`feGaussianBlur`,{in:`blur`,result:`intensityBlur`,stdDeviation:s/50}),m(`feComponentTransfer`,{in:`SourceGraphic`,result:`intensityBrightness`},m(`feFuncR`,{slope:c,type:`linear`}),m(`feFuncG`,{slope:c,type:`linear`}),m(`feFuncB`,{slope:c,type:`linear`})),m(`feMerge`,null,m(`feMergeNode`,{in:`intensityBlur`}),m(`feMergeNode`,{in:`intensityBrightness`}),m(`feGaussianBlur`,{stdDeviation:i/10})))}function Z(e,t,n,r={}){let i=[],a=[],o=C(),s=X(r.cssEffectFilter,t,o),c=null;if(s){let e=Y(r.cssEffectFilter),i=r.clipBloomEffect||!e?.strength?0:(e.strength+e.radius/2)/3,a=t+t*i,o=n+n*i;c=[Math.max(a,10),Math.max(o,10)]}let l=t,u=n;if(r.useRotationSize)for(let i=0;i<e.length;i++){let e=r.rotations?.[i]??0;l=Math.max(j(e,t),l),u=Math.max(j(e,n),u)}for(let o=0;o<e.length;o++){let s=e[o],d=[],f=[],p=0,h=0,g=0;for(let e of s){let{shape:t,fill:n,stroke:a,font:o,offset:s}=e;r.ignoreStrokeWidth||t.type===`text`||(p+=a?.width||0);let c=P(n),l=F(a),u=t.type===`text`?I(t,o):null;i.push(L(c)),d.push(N(t,c.fill,l,u,r.ariaLabel)),f.push(K(t)),s&&(h+=s[0],g+=s[1])}let _=r.rotations?.[o]??0;r.useRotationSize&&(h+=(l-j(_,t))/2,g+=(u-j(_,n))/2);let v=J(q(f),t,n,p,r.scale??!1,_,r.useRotationSize??!1,[h,g],c),y=null;if(r.masking){let e=`mask-${o}`,t=r.masking[o];i.push(R(t,e)),y=`url(#${e})`}a.push(y?m(`g`,{mask:y},m(`g`,{transform:v},d)):m(`g`,{transform:v},d))}return s&&(h(c),l=c[0],u=c[1]),m(`svg`,{"aria-label":r.ariaLabel,focusable:!1,height:u,role:`img`,style:`display: block;`,width:l,xmlns:w},s,m(`defs`,null,i),s?m(`g`,{filter:`url(#bloom${o})`},a):a)}var Q=i();function ne(e,t){Q.append(e,t),Q.detach(t)}function $(e,t,n){let r=Math.ceil(t[0]),i=Math.ceil(t[1]);if(!e.some(e=>!!e.length))return null;let a=n?.node||document.createElement(`div`);return n.opacity!=null&&(a.style.opacity=n.opacity.toString()),n.cssEffectFilter!=null&&(a.style.filter=n.cssEffectFilter),ne(a,()=>Z(e,r,i,n)),a}function re(e,t){e=Math.ceil(e),t=Math.ceil(t);let n=document.createElement(`canvas`);n.width=e,n.height=t,n.style.width=e+`px`,n.style.height=t+`px`;let r=n.getContext(`2d`);return r.clearRect(0,0,e,t),r}function ie(e,t,n){return e?o(e,{responseType:`image`}).then(e=>{let r=e.data,i=r.width,a=r.height,o=i/a,s=t;if(n){let e=Math.max(i,a);s=Math.min(s,e)}return{image:r,width:o<=1?Math.ceil(s*o):s,height:o<=1?s:Math.ceil(s/o)}}):Promise.reject(new d(`renderUtils: imageDataSize`,`href not provided.`))}function ae(e,t){return!(!e||t===`ignore`)&&(t!==`multiply`||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function oe(e,t,n,r,i){switch(i){case`multiply`:e[t]*=n[0],e[t+1]*=n[1],e[t+2]*=n[2],e[t+3]*=n[3];break;default:{let i=_({r:e[t],g:e[t+1],b:e[t+2]});i.h=r.h,i.s=r.s,i.v=i.v/100*r.v;let a=g(i);e[t]=a.r,e[t+1]=a.g,e[t+2]=a.b,e[t+3]*=n[3];break}}}function se(e,t,n,i,a){return ie(e,t,a).then(a=>{let o=a.width??t,s=a.height??t;if(a.image&&ae(n,i)){let t=a.image.width,r=a.image.height;f(`edge`)&&/\.svg$/i.test(e)&&(--t,--r);let c=re(o,s);c.drawImage(a.image,0,0,t,r,0,0,o,s);let l=c.getImageData(0,0,o,s),u=[n.r/255,n.g/255,n.b/255,n.a],d=_(n);for(let e=0;e<l.data.length;e+=4)oe(l.data,e,u,d,i);c.putImageData(l,0,0),e=c.canvas.toDataURL(`image/png`)}else{let t=r?.findCredential(e);if(t?.token){let n=e.includes(`?`)?`&`:`?`;e=`${e}${n}token=${t.token}`}}return{url:e,width:o,height:s}}).catch(()=>({url:e,width:t,height:t}))}export{J as a,q as c,F as i,N as l,$ as n,K as o,P as r,L as s,se as t,Z as u};