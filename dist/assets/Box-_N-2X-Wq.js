import{Ax as e,Bg as t,CD as n,Gd as r,Id as i,Kb as a,Kd as o,MC as s,TC as c,T_ as l,Ub as u,Vg as d,Wb as f,Xv as p,Yd as m,Zv as h,b_ as g,dv as _,e_ as v,kC as y,mT as b,qb as x,r_ as S,uD as C,w_ as w,x_ as T,y_ as E}from"./index-BqmCqmfp.js";import"./quatf64-CJzmL3cc.js";import"./quat-Bk_ZaVz9.js";import"./axisAngleDegrees-Di7q97jx.js";import"./MeshLocalVertexSpace-HjmVAuYa.js";import"./MeshTransform-B2p38eYR.js";import"./meshVertexSpaceUtils-Y8FeTLov.js";import"./projectPointToVector-Clou1sfo.js";import"./dehydratedPoint-Dwb3orme.js";import"./projectVectorToVector-D-Bbb8fP.js";import"./layerViewUtils-Bbe7IKvz.js";import"./elevationInfoUtils-Df_uYU_q.js";import"./GraphicsLayer-BGvt7_Y1.js";import"./geodesicUtils-DJORTTMv.js";import"./getDefaultUnitForView-CBP34vcm.js";import{r as D}from"./layerUtils-DVQFdwBE.js";import{t as O}from"./SketchOptions-CfisVcr8.js";import{i as k}from"./quantityUtils-Dywg00j-.js";import{l as A,n as j,r as M,t as N}from"./rotate-qEFO-Vf9.js";import"./angularMeasurementUtils-BFBiid4G.js";import"./unitFormatUtils-D4yCMgjI.js";import"./GraphicManipulator-3bzgkt2P.js";import"./drapedUtils-p7eKCYi3.js";import{a as P,n as F,r as I,t as L}from"./drawUtils-BjZRY3_w.js";import{t as R}from"./TranslateTooltipInfo-Dg5jnkfm.js";import{n as z,r as B,t as V}from"./ExtentScaleTooltipInfo-C3_coAyh.js";import{n as H,t as U}from"./GraphicMover-CVuh8pZh.js";import{t as W}from"./settings-D6uYZqUj.js";function G(e,t,n,r){let i=[];for(let a of e){let e=a.slice();i.push(e);let o=t*(a[0]-r.x)-n*(a[1]-r.y)+r.x,s=n*(a[0]-r.x)+t*(a[1]-r.y)+r.y;e[0]=o,e[1]=s}return i}function K(e,t,n,r){let i=[r.x,r.y];if(g(e)){let t=[...e];return _(t,t,i,n)}return w(e)?j(e,i,n):l(e)?M(e,i,n):t?N(t,e,i,n):e}function q(e,t,n,r){let i=[];for(let a of e){let e=[],o=r&&a.length>0&&C(E(a[0]),E(a.at(-1)));for(let r=0;r<a.length;r++){let i=a[r],o=r>0?E(a[r-1]):void 0;e.push(K(i,o,t,n))}o&&(e[0]=[...E(e.at(-1))]),i.push(e)}return i}function J({spatialReference:e,xmin:t,ymin:n,ymax:r,xmax:i}){return new v({spatialReference:e??void 0,hasM:!1,hasZ:!1,rings:[[[t,n],[t,r],[i,r],[i,n],[t,n]]]})}function Y(n,r,i){let{hasM:a,hasZ:o,spatialReference:s,type:c}=n,l=r*Math.PI/180,u=Math.cos(l),f=Math.sin(l);switch(c){case`point`:return i??=n,new e({x:u*(n.x-i.x)-f*(n.y-i.y)+i.x,y:f*(n.x-i.x)+u*(n.y-i.y)+i.y,z:n.z,m:n.m,spatialReference:s});case`extent`:case`polygon`:{n=c===`extent`?J(n):n,i??=n.extent.center;let e=T(n),t=q(n.curveRings??n.rings,l,i,!0);return new v({spatialReference:s,hasZ:n.hasZ,hasM:n.hasM,curveRings:e?t:void 0,rings:e?void 0:t})}case`polyline`:{i??=n.extent.center;let e=T(n),r=q(n.curvePaths??n.paths,l,i,!1);return new t({hasZ:o,hasM:a,spatialReference:s,curvePaths:e?r:void 0,paths:e?void 0:r})}case`multipoint`:return i??=n.extent.center,new d({hasM:a,hasZ:o,points:G(n.points,u,f,i),spatialReference:s})}return null}var X=W.transformGraphics,ee={centerIndicator:new r({style:`cross`,size:X.center.size,color:X.center.color}),fill:{default:new o({color:X.fill.color,outline:{color:X.fill.outlineColor,join:`round`,width:1}}),active:new o({color:X.fill.stagedColor,outline:{color:X.fill.outlineColor,join:`round`,style:`dash`,width:1}})},handles:{default:new r({style:`square`,size:X.vertex.size,color:X.vertex.color,outline:{color:X.vertex.outlineColor,width:1}}),hover:new r({style:`square`,size:X.vertex.hoverSize,color:X.vertex.hoverColor,outline:{color:X.vertex.hoverOutlineColor,width:1}})},rotator:{default:new r({style:`circle`,size:X.vertex.size,color:X.vertex.color,outline:{color:X.vertex.outlineColor,width:1}}),hover:new r({style:`circle`,size:X.vertex.hoverSize,color:X.vertex.hoverColor,outline:{color:X.vertex.hoverOutlineColor,width:1}})},rotatorLine:new m({color:X.line.color,width:1})},Z=Symbol(),Q=class extends c{constructor(e){super(e),this._activeHandleGraphic=null,this._graphicAttributes={esriSketchTool:`box`},this._mover=null,this._centerGraphic=null,this._backgroundGraphic=null,this._vertexGraphics=[],this._rotateHandleGraphic=null,this._rotateGraphicOffset=20,this._angleOfRotation=0,this._rotateLineGraphic=null,this._startInfo=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this.tooltip=null,this.type=`box`,this.callbacks={onMoveStart(){},onMove(){},onMoveStop(){},onScaleStart(){},onScale(){},onScaleStop(){},onRotateStart(){},onRotate(){},onRotateStop(){},onGraphicClick(){}},this.enableMovement=!0,this.enableRotation=!0,this.enableScaling=!0,this.graphics=[],this.highlightName=null,this.highlightsEnabled=!0,this.layer=null,this.preserveAspectRatio=!1,this.showCenterGraphic=!0,this.symbols=ee,this.sketchOptions=new O,this.view=null,this._getBounds=(()=>{let e=h();return(t,n)=>{t[0]=1/0,t[1]=1/0,t[2]=-1/0,t[3]=-1/0;for(let r of n){if(!r)continue;let n,i,a,o;if(r.type===`point`)n=a=r.x,i=o=r.y;else if(r.type===`extent`)[n,i,a,o]=[r.xmin,r.ymin,r.xmax,r.ymax];else{let t=S(e,r);[n,i,a,o]=t}t[0]=Math.min(n,t[0]),t[1]=Math.min(i,t[1]),t[2]=Math.max(a,t[2]),t[3]=Math.max(o,t[3])}return t}})()}initialize(){let e=this.view;this._highlightHelper=new H({view:e}),this._setup(),this.addHandles([u(()=>e?.ready,()=>{let{layer:e,view:t}=this;D(t,e)},{once:!0,initial:!0}),a(()=>this.preserveAspectRatio,()=>{this._activeHandleGraphic&&(this._scaleGraphic(this._activeHandleGraphic),this._updateGraphics(),this._updateTooltip(this._activeHandleGraphic))}),a(()=>e?.scale,()=>{this._updateRotateGraphic(),this._updateRotateLineGraphic()}),a(()=>this.graphics,()=>this.refresh()),a(()=>this.layer,(e,t)=>{t&&this._resetGraphics(t),this.refresh()}),a(()=>[this.highlightsEnabled,this.highlightName],()=>{this._highlightHelper?.removeAll(),this._setUpHighlights()}),a(()=>this.sketchOptions.tooltips.effectiveEnabled,t=>{this.tooltip=t?A(()=>({view:e,options:this.sketchOptions.tooltips})):b(this.tooltip)},x),a(()=>this.view.effectiveTheme.accentColor,()=>this._updateSymbolsForTheme(),f),this.on(`move-start`,e=>this.callbacks?.onMoveStart?.(e)),this.on(`move`,e=>this.callbacks?.onMove?.(e)),this.on(`move-stop`,e=>this.callbacks?.onMoveStop?.(e)),this.on(`rotate-start`,e=>this.callbacks?.onRotateStart?.(e)),this.on(`rotate`,e=>this.callbacks?.onRotate?.(e)),this.on(`rotate-stop`,e=>this.callbacks?.onRotateStop?.(e)),this.on(`scale-start`,e=>this.callbacks?.onScaleStart?.(e)),this.on(`scale`,e=>this.callbacks?.onScale?.(e)),this.on(`scale-stop`,e=>this.callbacks?.onScaleStop?.(e))])}destroy(){this._reset(),this.tooltip=b(this.tooltip)}get state(){let e=this.view?.ready??!1,t=this.graphics.length&&this.layer;return e&&t?`active`:e?`ready`:`disabled`}isUIGraphic(e){return this._vertexGraphics.includes(e)||e===this._backgroundGraphic||e===this._centerGraphic||e===this._rotateHandleGraphic||e===this._rotateLineGraphic}move(e,t){if(this._mover&&this.graphics.length){for(let n of this.graphics){let r=n.geometry;n.geometry=P(r,e,t,this.view)}this.refresh(),this.emit(`move-stop`,{graphics:this.graphics,mover:null,dx:e,dy:t,type:`move-stop`})}}scale(e,t){if(!this._mover||!this.graphics.length)return;let n=this._getBoxBounds(h()),r=p(n);for(let n of this.graphics){let i=n.geometry;n.geometry=L(i,e,t,r)}this.refresh(),this.emit(`scale-stop`,{graphics:this.graphics,mover:null,xScale:e,yScale:t,type:`scale-stop`})}rotate(t,n){if(this._mover&&this.graphics.length){if(!n){let t=this._vertexGraphics[1].geometry.x,r=this._vertexGraphics[3].geometry.y;n=new e(t,r,this.view.spatialReference)}for(let e of this.graphics){let r=e.geometry;e.geometry=Y(r,t,n)}this.refresh(),this.emit(`rotate-stop`,{graphics:this.graphics,mover:null,angle:t,type:`rotate-stop`})}}refresh(){this._reset(),this._setup()}reset(){this.graphics=[]}_setup(){this.state===`active`&&(this._setUpHighlights(),this._setupGraphics(),this._setupMover(),this._updateGraphics())}_reset(){this._highlightHelper?.removeAll(),this._resetGraphicStateVars(),this._resetGraphics(),this._updateTooltip(),this._mover?.destroy(),this._mover=null,this.removeHandles(Z)}_resetGraphicStateVars(){this._startInfo=null,this._activeHandleGraphic=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this._angleOfRotation=0}_resetGraphics(e){(e||=this.layer)&&(e.removeMany(this._vertexGraphics),e.remove(this._backgroundGraphic),e.remove(this._centerGraphic),e.remove(this._rotateHandleGraphic),e.remove(this._rotateLineGraphic)),this._vertexGraphics.forEach(e=>!e.destroyed&&e.destroy()),!this._backgroundGraphic.destroyed&&this._backgroundGraphic.destroy(),!this._centerGraphic.destroyed&&this._centerGraphic.destroy(),!this._rotateHandleGraphic.destroyed&&this._rotateHandleGraphic.destroy(),!this._rotateLineGraphic.destroyed&&this._rotateLineGraphic.destroy(),this._vertexGraphics=[],this._backgroundGraphic=null,this._centerGraphic=null,this._rotateHandleGraphic=null,this._rotateLineGraphic=null}_setupMover(){let e=[];this.enableScaling&&(e=e.concat(this._vertexGraphics)),this.enableRotation&&e.push(this._rotateHandleGraphic),this.enableMovement&&(e=e.concat(this.graphics,this._backgroundGraphic)),this.showCenterGraphic&&e.push(this._centerGraphic),this._mover=new U({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,view:this.view,graphics:e,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_setCursor(e){this.addHandles(this.view.acquireCursor(e,`high`),Z)}_getStartInfo(e){let[t,n,r,i]=this._getBoxBounds(h()),a=Math.abs(r-t),o=Math.abs(i-n),s=(r+t)/2,c=(i+n)/2,{x:l,y:u}=e.geometry;return{width:a,height:o,centerX:s,centerY:c,startX:l,startY:u,graphicInfos:this._getGraphicInfos(),box:this._backgroundGraphic.geometry,rotate:this._rotateHandleGraphic.geometry}}_getGraphicInfos(){return this.graphics.map(e=>this._getGraphicInfo(e))}_getGraphicInfo(e){let t=e.geometry,[n,r,i,a]=this._getBounds(h(),[t]);return{width:Math.abs(i-n),height:Math.abs(a-r),centerX:(i+n)/2,centerY:(a+r)/2,geometry:t}}_onGraphicClickCallback(e){e.viewEvent.stopPropagation(),this.emit(`graphic-click`,e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e)}_onGraphicMoveStartCallback(e){let{_angleOfRotation:t,_xScale:n,_yScale:r,_backgroundGraphic:i,_vertexGraphics:a,_rotateHandleGraphic:o,symbols:s,graphics:c}=this,{graphic:l,dx:u,dy:d,viewEvent:f}=e;this._resetGraphicStateVars(),this._hideGraphicsBeforeUpdate(),i.symbol=s.fill.active,this._startInfo=this._getStartInfo(l),this._updateTooltip(l,f),l===o?(this._setCursor(`grabbing`),this.emit(`rotate-start`,{type:`rotate-start`,mover:l,graphics:c,angle:t})):a.includes(l)?(this._activeHandleGraphic=l,this.emit(`scale-start`,{type:`scale-start`,mover:l,graphics:c,xScale:n,yScale:r})):this.emit(`move-start`,{type:`move-start`,graphics:c,mover:l,dx:u,dy:d})}_onGraphicMoveCallback(e){let t=e.graphic;if(!this._startInfo)return;let{_xScale:n,_yScale:r,_angleOfRotation:i,graphics:a}=this;if(this._vertexGraphics.includes(t))this._scaleGraphic(t),this._updateTooltip(t,e.viewEvent),this.emit(`scale`,{type:`scale`,graphics:a,mover:t,xScale:n,yScale:r});else if(t===this._rotateHandleGraphic)this._rotateGraphic(t),this._updateTooltip(t,e.viewEvent),this.emit(`rotate`,{type:`rotate`,graphics:a,mover:t,angle:i});else{let{dx:n,dy:r}=e;this._totalDx+=n,this._totalDy+=r,this._moveGraphic(t,n,r),this._updateTooltip(t,e.viewEvent),this.emit(`move`,{type:`move`,graphics:a,mover:t,dx:n,dy:r})}}_onGraphicMoveStopCallback(e){let t=e.graphic;if(!this._startInfo)return void this.refresh();let{_angleOfRotation:n,_totalDx:r,_totalDy:i,_xScale:a,_yScale:o,_vertexGraphics:s,_rotateHandleGraphic:c,graphics:l}=this;this.refresh(),t===c?(this._setCursor(`pointer`),this.emit(`rotate-stop`,{type:`rotate-stop`,graphics:l,mover:t,angle:n})):s.includes(t)?this.emit(`scale-stop`,{type:`scale-stop`,mover:t,graphics:l,xScale:a,yScale:o}):this.emit(`move-stop`,{type:`move-stop`,graphics:l,mover:t,dx:r,dy:i})}_onGraphicPointerOverCallback(e){let{_backgroundGraphic:t,_vertexGraphics:n,graphics:r,_rotateHandleGraphic:i,symbols:a,view:o}=this,s=e.graphic;if(this._hoveredGraphic=s,s===i)return i.symbol=a.rotator.hover,this._setCursor(`pointer`),void this._updateTooltip(s);if(r.includes(s)||s===t)return void this._setCursor(`move`);if(!n.includes(s))return void this._setCursor(`pointer`);this._updateTooltip(s),e.graphic.symbol=a.handles.hover;let c=o.rotation,l,u=e.index;switch(u<8&&(c>=0&&c<45?u%=8:u=c>=45&&c<90?(u+1)%8:c>=90&&c<135?(u+2)%8:c>=135&&c<180?(u+3)%8:c>=180&&c<225?(u+4)%8:c>=225&&c<270?(u+5)%8:c>=270&&c<315?(u+6)%8:(u+7)%8),u){case 0:case 4:l=`nwse-resize`;break;case 1:case 5:l=`ns-resize`;break;case 2:case 6:l=`nesw-resize`;break;case 3:case 7:l=`ew-resize`;break;default:l=`pointer`}this._setCursor(l)}_onGraphicPointerOutCallback(e){let{_vertexGraphics:t,_rotateHandleGraphic:n,symbols:r}=this;this._hoveredGraphic=null,e.graphic===n?n.symbol=r.rotator.default:t.includes(e.graphic)&&(e.graphic.symbol=r.handles.default),this.removeHandles(Z),this._updateTooltip()}_scaleGraphic(t){let{_startInfo:n,_vertexGraphics:r,preserveAspectRatio:i,view:a}=this,{centerX:o,centerY:s,graphicInfos:c,height:l,startX:u,startY:d,width:f}=n,{resolution:p,transform:m}=a.state,h=r.indexOf(t);h!==1&&h!==5||this._updateX(t,o),h!==3&&h!==7||this._updateY(t,s);let{x:g,y:_}=t.geometry,v=m[0]*g+m[2]*_+m[4],y=m[1]*g+m[3]*_+m[5],b=c?.map(e=>e.geometry)??[],x=b.every(e=>e.type===`point`);if((f===0||l===0)&&x){let t=$((g-u)/p),r=$((d-_)/p);for(let e=0;e<b.length;e++)this.graphics[e].geometry=P(b[e],t,r,a,!0);this._centerGraphic.geometry=new e(g,_,a.spatialReference),this._backgroundGraphic.geometry=P(n.box,t,r,a,!0);return}if(i){let e=$(m[0]*o+m[2]*s+m[4],2),t=$(m[1]*o+m[3]*s+m[5],2),n=$(m[0]*u+m[2]*d+m[4],2),r=$(m[1]*u+m[3]*d+m[5],2),i=F(e,t,n,r,v,y);i!==0&&Math.abs(i)!==1/0||(i=1),this._xScale=this._yScale=i;for(let e of b){let t=b.indexOf(e);this.graphics[t].geometry=L(e,this._xScale,this._yScale,[o,s])}this._updateBackgroundGraphic()}else{let t=g-u,r=d-_;if(h===1||h===5?t=0:h!==3&&h!==7||(r=0),t===0&&r===0)return;let i=o+t/2,c=s+r/2,m=(f+(u>o?t:-1*t))/f,v=(l+(d<s?r:-1*r))/l;h!==1&&h!==5&&m!==0&&Math.abs(m)!==1/0||(m=1),h!==3&&h!==7&&v!==0&&Math.abs(v)!==1/0||(v=1),this._xScale=m,this._yScale=v;let y=(i-o)/p,x=(c-s)/p,S=L(n.box,this._xScale,this._yScale);this._backgroundGraphic.geometry=P(S,y,x,a,!0);let{centerX:C,centerY:w}=this._getGraphicInfo(this._backgroundGraphic),T=(C-o)/p,E=-1*(w-s)/p;for(let e of b){let t=b.indexOf(e),n=L(e,this._xScale,this._yScale,[o,s]);this.graphics[t].geometry=P(n,T,E,a,!0)}this._centerGraphic.geometry=new e(C,w,a.spatialReference)}}_rotateGraphic(t){let{centerX:n,centerY:r,startX:i,startY:a,box:o,rotate:s}=this._startInfo,c=this.view.spatialReference,l=new e(i,a,c),u=new e(n,r,c),d=t.geometry;this._angleOfRotation=I(l,d,u);let f=this._startInfo.graphicInfos?.map(e=>e.geometry)??[];for(let e of f){let t=f.indexOf(e),n=Y(e,this._angleOfRotation,u);this.graphics[t].geometry=n}this._backgroundGraphic.geometry=Y(o,this._angleOfRotation,u),this._rotateHandleGraphic.geometry=Y(s,this._angleOfRotation,u)}_moveGraphic(e,t,n){if(this.graphics.includes(e)){let r=this._backgroundGraphic.geometry;this._backgroundGraphic.geometry=P(r,t,n,this.view);for(let r of this.graphics)r!==e&&(r.geometry=P(r.geometry,t,n,this.view))}else if(e===this._centerGraphic){let e=this._backgroundGraphic.geometry;this._backgroundGraphic.geometry=P(e,t,n,this.view)}if(e===this._backgroundGraphic||e===this._centerGraphic)for(let e of this.graphics)e.geometry=P(e.geometry,t,n,this.view)}_setUpHighlights(){this.highlightsEnabled&&this.graphics.length&&this._highlightHelper?.add(this.graphics,this.highlightName)}_setupGraphics(){let{_graphicAttributes:e,symbols:t}=this;this._centerGraphic=new i({symbol:t.centerIndicator,attributes:e}),this.showCenterGraphic&&this.layer.add(this._centerGraphic),this._backgroundGraphic=new i({symbol:t.fill.default,attributes:e}),this.layer.add(this._backgroundGraphic),this._rotateLineGraphic=new i({symbol:t.rotatorLine,attributes:e}),this._rotateHandleGraphic=new i({symbol:t.rotator.default,attributes:e}),this.enableRotation&&!this._hasExtentGraphic()&&this.layer.addMany([this._rotateLineGraphic,this._rotateHandleGraphic]);for(let n=0;n<8;n++)this._vertexGraphics.push(new i({symbol:t.handles.default,attributes:e}));this.enableScaling&&this.layer.addMany(this._vertexGraphics)}_updateSymbolsForTheme(){let e=this.view.effectiveTheme.accentColor;this.symbols={...this.symbols,fill:{active:this.symbols.fill.active?.clone().set(`outline.color`,e),default:this.symbols.fill.default?.clone().set(`outline.color`,e)},handles:{...this.symbols.handles,default:this.symbols.handles.default.clone().set(`outline.color`,e)},rotator:{...this.symbols.rotator,default:this.symbols.rotator.default.clone().set(`outline.color`,e)},rotatorLine:this.symbols.rotatorLine.clone().set(`color`,e)};for(let e of this._vertexGraphics)e.symbol=e===this._hoveredGraphic?this.symbols.handles.hover:this.symbols.handles.default;this._backgroundGraphic.symbol=this.symbols.fill.default,this._rotateHandleGraphic.symbol=this._rotateHandleGraphic===this._hoveredGraphic?this.symbols.rotator.hover:this.symbols.rotator.default,this._rotateLineGraphic.symbol=this.symbols.rotatorLine}_updateGraphics(){this._updateBackgroundGraphic(),this._updateHandleGraphics(),this._updateCenterGraphic(),this._updateRotateGraphic(),this._updateRotateLineGraphic()}_hideGraphicsBeforeUpdate(){this._centerGraphic.visible=!1,this._rotateHandleGraphic.visible=!1,this._rotateLineGraphic.visible=!1,this._vertexGraphics.forEach(e=>e.visible=!1)}_updateHandleGraphics(){let e=this._getCoordinates(!0);this._vertexGraphics.forEach((t,n)=>{let[r,i]=e[n];this._updateXY(t,r,i)})}_updateBackgroundGraphic(){let e=this._getCoordinates().map(([e,t])=>[e,t]);this._backgroundGraphic.geometry=new v({rings:[e],spatialReference:this.view.spatialReference})}_updateCenterGraphic(){let[t,n,r,i]=this._getBoxBounds(h()),a=(r+t)/2,o=(i+n)/2;this._centerGraphic.geometry=new e(a,o,this.view.spatialReference)}_updateRotateGraphic(){if(!this._vertexGraphics.length)return;let{x:t,y:n}=this._vertexGraphics[1].geometry,r=n+this.view.state.resolution*this._rotateGraphicOffset;this._rotateHandleGraphic.geometry=new e(t,r,this.view.spatialReference)}_updateRotateLineGraphic(){if(!this._vertexGraphics.length||!this._rotateHandleGraphic?.geometry)return;let e=this._vertexGraphics[1].geometry,n=this._rotateHandleGraphic.geometry;this._rotateLineGraphic.geometry=new t({paths:[[[e.x,e.y],[n.x,n.y]]],spatialReference:this.view.spatialReference})}_updateXY(t,n,r){t.geometry=new e(n,r,this.view.spatialReference)}_updateX(t,n){let r=t.geometry.y;t.geometry=new e(n,r,this.view.spatialReference)}_updateY(t,n){let r=t.geometry.x;t.geometry=new e(r,n,this.view.spatialReference)}_hasExtentGraphic(){return this.graphics.some(e=>e?.geometry!=null&&e.geometry.type===`extent`)}_getBoxBounds(e){let t=this.graphics.map(e=>e.geometry);return this._getBounds(e,t)}_getCoordinates(e){let[t,n,r,i]=this._getBoxBounds(h());if(e){let e=(t+r)/2,a=(i+n)/2;return[[t,i],[e,i],[r,i],[r,a],[r,n],[e,n],[t,n],[t,a]]}return[[t,i],[r,i],[r,n],[t,n]]}_updateTooltip(e,t){if(this.tooltip==null)return;if(!e)return void this.tooltip.clear();let{_backgroundGraphic:n,graphics:r,_vertexGraphics:i,_rotateHandleGraphic:a}=this;e===a?this._updateRotateTooltip():i.includes(e)?this._updateScaleTooltip():(r.includes(e)||e===n)&&this._updateMoveTooltip(t)}_updateRotateTooltip(){this.tooltip!=null&&(this.tooltip.info=new B({sketchOptions:this.sketchOptions,angle:-this._angleOfRotation}))}_updateScaleTooltip(){let{tooltip:e,_xScale:t,_yScale:n,sketchOptions:r,view:i,automaticLengthMeasurementUtils:a}=this;if(e==null)return;let o=this._getCoordinates(),s=z({topLeft:o[0],topRight:o[1],bottomRight:o[2],bottomLeft:o[3],spatialReference:i.spatialReference,automaticLengthMeasurementUtils:a});if(s==null)return;let{xSize:c,ySize:l}=s;e.info=new V({sketchOptions:r,xScale:Math.abs(t),yScale:Math.abs(n),xSize:c,ySize:l})}_updateMoveTooltip(e){let{tooltip:t,sketchOptions:n,view:r,automaticLengthMeasurementUtils:i}=this;if(t==null)return;let a=new R({sketchOptions:n});if(e){let{x:t,y:n}=e.origin,o=r.toMap(e),s=r.toMap({x:t,y:n});a.distance=i.autoDistanceBetweenPoints2D(s,o)??k}t.info=a}};function $(e,t=2){return Number.parseFloat(e.toFixed(t))}n([s()],Q.prototype,`tooltip`,void 0),n([s({readOnly:!0})],Q.prototype,`type`,void 0),n([s()],Q.prototype,`callbacks`,void 0),n([s()],Q.prototype,`enableMovement`,void 0),n([s()],Q.prototype,`enableRotation`,void 0),n([s()],Q.prototype,`enableScaling`,void 0),n([s()],Q.prototype,`graphics`,void 0),n([s()],Q.prototype,`highlightName`,void 0),n([s()],Q.prototype,`highlightsEnabled`,void 0),n([s()],Q.prototype,`layer`,void 0),n([s()],Q.prototype,`preserveAspectRatio`,void 0),n([s()],Q.prototype,`showCenterGraphic`,void 0),n([s({readOnly:!0})],Q.prototype,`state`,null),n([s()],Q.prototype,`symbols`,void 0),n([s({type:O})],Q.prototype,`sketchOptions`,void 0),n([s({constructOnly:!0})],Q.prototype,`view`,void 0),n([s({constructOnly:!0})],Q.prototype,`automaticLengthMeasurementUtils`,void 0),Q=n([y(`esri.views.draw.support.Box`)],Q);var te=Q;export{te as default};