import{$r as e,Qr as t,Rw as n,WT as r,Xr as i,Yr as a,Zr as o,_E as s,if as c,qT as l,rf as u,si as d,vx as f,zd as p}from"./index-BqmCqmfp.js";import{n as m,t as h}from"./devEnvironmentUtils-8TtBy-wV.js";import{t as g}from"./webStyleAcceptedFormats-vp0B4e2w.js";function _(t,n,r){let a=t.name;return a==null?Promise.reject(new s(`symbolstyleutils:style-symbol-reference-name-missing`,`Missing name in style symbol reference`)):t.styleName===`Esri2DPointSymbolsStyle`?b(a,n,r):i(t,n,r).then(t=>y(t,a,n,e,r))}function v(e,t){return t.items.find(t=>t.name===e)}async function y(e,i,a,_,y){let b=a?.portal==null?f.getDefault():a.portal,x={portal:b,url:r(e.baseUrl)},S=v(i,e.data);if(!S)throw new s(`symbolstyleutils:symbol-name-not-found`,`The symbol name '${i}' could not be found`,{symbolName:i});let C=y?.acceptedFormats??g,w=_(S,C);if(!w)throw new s(`symbolstyleutils:symbol-reference-no-accepted-format`,`The symbol name '${i}' does not have an accepted format (one of ${C})`,{symbolName:i});let{url:T,format:E}=w,D=n(T,x),O=S.thumbnail?.href??null,k=S.thumbnail?.imageData;m()&&(D=h(D)??``,O=h(O));let A={portal:b,url:r(l(D)),origin:`portal-item`};return t(D,y).then(t=>{let r=E===`cim`?o(t.data):t.data,s=d(r,A);if(s&&p(s)){if(O){let e=n(O,x);s.thumbnail=new u({url:e})}else k&&(s.thumbnail=new u({url:`data:image/png;base64,${k}`}));e.styleUrl?s.styleOrigin=new c({portal:a.portal,styleUrl:e.styleUrl,name:i}):e.styleName&&(s.styleOrigin=new c({portal:a.portal,styleName:e.styleName,name:i}))}return s})}function b(e,n,i){let s=a.replaceAll(/\{SymbolName\}/gi,e),c=n.portal==null?f.getDefault():n.portal;return t(s,i).then(e=>{let t=o(e.data);return d(t,{portal:c,url:r(l(s)),origin:`portal-item`})})}export{_ as n,y as r,v as t};