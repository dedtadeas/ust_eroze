const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingTools-7hOqqzc_.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css","assets/editPlaneUtils-DxRI6Xas.js","assets/boundedPlane-Cn9n7acY.js","assets/sphere-CicnK0Bn.js","assets/vectorStacks-CKtslZxP.js","assets/quatf64-CJzmL3cc.js","assets/lineSegment-uFalXigL.js","assets/plane-CTjDePZl.js","assets/ReactiveSet-DIaWCgzH.js","assets/elevationInfoUtils-Df_uYU_q.js","assets/rotate-qEFO-Vf9.js","assets/quantityUtils-Dywg00j-.js","assets/unitFormatUtils-D4yCMgjI.js","assets/MeshTransform-B2p38eYR.js","assets/quat-Bk_ZaVz9.js","assets/axisAngleDegrees-Di7q97jx.js","assets/meshVertexSpaceUtils-Y8FeTLov.js","assets/MeshLocalVertexSpace-HjmVAuYa.js","assets/getDefaultUnitForView-CBP34vcm.js","assets/angularMeasurementUtils-BFBiid4G.js","assets/projectVectorToVector-D-Bbb8fP.js","assets/projectPointToVector-Clou1sfo.js","assets/dehydratedPoint-Dwb3orme.js","assets/geodesicUtils-DJORTTMv.js","assets/createUtils-DwAaa929.js","assets/distanceOperator-5uQbTYel.js","assets/Distance2DCalculator-CXhBP-8I-Xmr2hQVp.js","assets/UnitFactory-J9WMNXdY.js","assets/Envelope2D-BNwQDrOT.js","assets/Point2D-UYEfE6HP.js","assets/OperatorDefinitions-DQQu7-BK.js","assets/SimpleGeometryCursor-CI9GIWKa.js","assets/Transformation2D-DVoPQwGC.js","assets/apiConverter-DVPFZqjR.js","assets/jsonConverter-DiNOXEUJ.js","assets/simplifyOperator-CVaMEoed.js","assets/operatorSimplify-BpM6lQIp.js","assets/GraphicsLayer-BGvt7_Y1.js","assets/dehydratedFeatureComparison-Ch8xWl-8.js","assets/hydratedFeatures-BSV-K3yB.js","assets/SnappingContext-BiPKdvZN.js","assets/GraphicManipulator-3bzgkt2P.js","assets/drapedUtils-p7eKCYi3.js","assets/LineSnappingHint-BAcwqgNT.js","assets/ParallelSnappingHint-Knbe-U69.js","assets/IntersectionSnappingHint-C3U4Rx6H.js","assets/PointSnappingHint-0hXGrSRX.js","assets/RightAngleSnappingHint--LJCiSno.js","assets/euclideanLengthMeasurementUtils-Bhl6nD1D.js","assets/spatialReferenceEllipsoidUtils-DBtdxVkA.js","assets/SketchOptions-CfisVcr8.js","assets/constraints-DXu8cqG3.js","assets/snappingUtils-CbrwOS61.js","assets/colorUtils-uG2qTogT.js","assets/cimSymbolUtils-1FVTTBxd.js","assets/SnappingVisualizer2D-RgcarHQv.js","assets/drawUtils-BjZRY3_w.js","assets/hitTestSelectUtils-CyV_4TZP.js"])))=>i.map(i=>d[i]);
import{Am as e,CD as t,Cw as n,Kw as r,MC as i,OC as a,Wb as o,_T as s,kC as c,vT as l,wm as u,yT as d}from"./index-BqmCqmfp.js";var f={redo:`r`,undo:`z`},p=Symbol(),m=Symbol(),h=Symbol(),g=class extends a{constructor(t){super(t),this._tool=null,this._updatingHandles=new e,this.enabled=!1,this._onPointerMove=r(async e=>{let t=await this._updatingHandles.addPromise(this._findElementAtScreenPoint(e));this.destroyed||(this.removeHandles(m),t&&t!==this.selectedElement&&this.addHandles(this.view.acquireCursor(`pointer`,`high`),m))})}initialize(){this.addHandles(s(this._updatingHandles)),this._updatingHandles.add(()=>this.enabled,e=>this._setEnabled(e),o),this._updatingHandles.add(()=>this._preferredInteractionTool,()=>this._preferredInteractionToolChanged())}get _validatedSelectedElement(){let e=this.selectedElement;if(!e)return null;let{layer:{source:t}}=this;return t?`hasElement`in t?t.hasElement(e)?e:null:t===e?e:null:null}get _preferredInteractionTool(){return this.options?.tool??`transform`}get updating(){return this._updatingHandles.updating}_setEnabled(e){if(this.removeHandles(p),!e)return;let{view:t}=this;this.addHandles([t.on(`immediate-click`,e=>this._onClick(e),u.TOOL),t.on(`pointer-move`,e=>this._onPointerMove(e).catch(()=>{}),u.TOOL),t.on(`key-down`,e=>{e.key===f.undo&&this._tool?.canUndo()&&(this._tool.undo(),e.stopPropagation()),e.key===f.redo&&this._tool?.canRedo()&&(this._tool.redo(),e.stopPropagation())}),this._updatingHandles.add(()=>this._validatedSelectedElement,e=>this._selectedElementChanged(e),o),l(()=>{this.removeHandles(m),this._removeTool()})],p)}async _findElementAtScreenPoint(e){let t=(await this.view.hitTest(e,{include:[this.layer]})).results[0];return t?.type===`media`?t.element:null}async _onClick(e){await this._updatingHandles.addPromise(e.defer(async()=>{let t=await this._findElementAtScreenPoint(e);this.destroyed||(t&&e.stopPropagation(),this.selectedElement=t,this.selectedElement&&this.removeHandles(m))}))}_preferredInteractionToolChanged(){let{_tool:e}=this;e&&(this._preferredInteractionTool===e.type||this._updatingHandles.addPromise(this._recreateTool()))}async _recreateTool(){this.removeHandles(h),this._removeTool();let e=this._validatedSelectedElement;if(!e)return;let t=new AbortController;this.addHandles(d(t),h);let{TransformTool:r,ControlPointsTransformTool:i}=await n(async()=>{let{TransformTool:e,ControlPointsTransformTool:t}=await import(`./editingTools-7hOqqzc_.js`);return{TransformTool:e,ControlPointsTransformTool:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]));if(t.signal.aborted)return;let{view:a}=this;switch(this._preferredInteractionTool){case`transform`:this._tool=new r({target:e,view:a});break;case`reshape`:this._tool=new i({mediaElement:e,view:a})}this.addHandles(l(()=>{this._tool&&=(a.tools.remove(this._tool),null)}),this._tool),a.addAndActivateTool(this._tool)}_removeTool(){this._tool&&this.removeHandles(this._tool)}async _selectedElementChanged(e){e?.georeference?await this._updatingHandles.addPromise(this._recreateTool()):this._removeTool()}};t([i()],g.prototype,`_validatedSelectedElement`,null),t([i()],g.prototype,`_preferredInteractionTool`,null),t([i({constructOnly:!0})],g.prototype,`view`,void 0),t([i({constructOnly:!0})],g.prototype,`layer`,void 0),t([i()],g.prototype,`selectedElement`,void 0),t([i()],g.prototype,`enabled`,void 0),t([i()],g.prototype,`options`,void 0),t([i()],g.prototype,`updating`,null),g=t([c(`esri.views.2d.layers.support.MediaLayerInteraction`)],g);export{g as MediaLayerInteraction};