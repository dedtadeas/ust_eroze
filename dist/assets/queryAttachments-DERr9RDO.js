import{KT as e,PT as t,Sw as n}from"./index-BqmCqmfp.js";import{t as r}from"./urlUtils-CtPsFIu4.js";import{t as i}from"./AttachmentInfo-BN0SLgvw.js";function a(e){let t=e.toJSON();return t.attachmentTypes&&=t.attachmentTypes.join(`,`),t.keywords&&=t.keywords.join(`,`),t.globalIds&&=t.globalIds.join(`,`),t.objectIds&&=t.objectIds.join(`,`),t.size&&=t.size.join(`,`),t.orderByFields&&=t.orderByFields.join(`,`),t}function o(n,r){let a={};for(let o of r){let{parentObjectId:r,parentGlobalId:s,attachmentInfos:c}=o;for(let o of c){let{id:c}=o,l=e(t(`${n.path}/${r}/attachments/${c}`)),u=i.fromJSON(o);u.set({url:l,parentObjectId:r,parentGlobalId:s}),a[r]?a[r].push(u):a[r]=[u]}}return a}function s(e,t,i){let o={query:r({...e.query,f:`json`,...a(t)})};return i&&(o={...i,...o,query:{...i.query,...o.query}}),n(e.path+`/queryAttachments`,o).then(e=>e.data.attachmentGroups)}async function c(e,t,r){let{objectIds:i}=t,a=[];for(let t of i)a.push(n(e.path+`/`+t+`/attachments`,r));return Promise.all(a).then(e=>i.map((t,n)=>({parentObjectId:t,attachmentInfos:e[n].data.attachmentInfos})))}export{s as executeAttachmentQuery,c as fetchAttachments,o as processAttachmentQueryResult};