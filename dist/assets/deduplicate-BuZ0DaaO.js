import{nb as e}from"./index-BqmCqmfp.js";import{a as t,o as n}from"./Indices-BsTLKVdx.js";function r(r,c,l){let u=Array.isArray(r),d=u?r.length/c:r.byteLength/(4*c),f=u?r:new Uint32Array(r,0,d*c),p=l?.minReduction??0,m=l?.originalIndices||null,h=m?m.length:0,g=l?.componentOffsets||null,_=0;if(g)for(let e=0;e<g.length-1;e++){let t=g[e+1]-g[e];t>_&&(_=t)}else _=d;let v=Math.floor(1.1*_)+1;(s==null||s.length<2*v)&&(s=new Uint32Array(e(2*v)));for(let e=0;e<2*v;e++)s[e]=0;let y=0,b=!!g&&!!m,x=b?h:d,S=t(d),C=new Uint32Array(h),w=1.96,T=p===0?x:Math.ceil(4*w*w/(p*p)*p*(1-p)),E=1,D=g?g[1]:x;for(let e=0;e<x;e++){if(e===T){let t=1-y/e;if(t+w*Math.sqrt(t*(1-t)/e)<p)return null;T*=2}if(e===D){for(let e=0;e<2*v;e++)s[e]=0;if(m)for(let e=g[E-1];e<g[E];e++)C[e]=S[m[e]];D=g[++E]}let t=b?m[e]:e,n=t*c,r=o(f,n,c),a=r%v,l=y;for(;s[2*a+1]!==0;){if(s[2*a]===r){let e=s[2*a+1]-1;if(i(f,n,e*c,c)){l=S[e];break}}a++,a>=v&&(a-=v)}l===y&&(s[2*a]=r,s[2*a+1]=t+1,y++),S[t]=l}if(p!==0&&1-y/d<p)return null;if(b){for(let e=g[E-1];e<C.length;e++)C[e]=S[m[e]];S=n(C)}let O=u?Array(y):new Uint32Array(y*c);y=0;for(let e=0;e<x;e++)S[e]===y&&(a(f,(b?m[e]:e)*c,O,y*c,c),y++);if(m&&!b){let e=new Uint32Array(h);for(let t=0;t<e.length;t++)e[t]=S[m[t]];S=n(e)}return{buffer:Array.isArray(O)?O:O.buffer,indices:S,uniqueCount:y}}function i(e,t,n,r){for(let i=0;i<r;i++)if(e[t+i]!==e[n+i])return!1;return!0}function a(e,t,n,r,i){for(let a=0;a<i;a++)n[r+a]=e[t+a]}function o(e,t,n){let r=0;for(let i=0;i<n;i++)r=e[t+i]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}var s=null;export{r as t};