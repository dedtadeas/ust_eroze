import{$l as e,Il as t,Jg as n,Jl as r,Ml as i,Ol as a,Ul as o,Wl as s,ab as c,iu as l,jl as u,nu as d}from"./index-BqmCqmfp.js";import{c as f,i as p,t as m}from"./vectorStacks-CKtslZxP.js";function h(e){let t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],n=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],r=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}function g(t,n){let r=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),i=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),a=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return e(t,r,i,a),t}function _(t,n,r){Math.abs(t[0])>Math.abs(t[1])?e(n,0,1,0):e(n,1,0,0),o(r,t,n),o(n,r,t),a(r,r),a(n,n)}function v(e,a,o,s=n()){let c=d(e),u=d(a),f=t(e,a)/(c*u);if(f<.9999999999999999){let t=Math.acos(f),n=((1-o)*c+o*u)/Math.sin(t),i=n/c*Math.sin((1-o)*t),d=n/u*Math.sin(o*t);return r(y,e,i),r(b,a,d),l(s,y,b)}return i(s,e,a,o)}n(),n(),n();var y=n(),b=n();function x(e=$){return[e[0],e[1],e[2],e[3]]}function S(e=$[0],t=$[1],n=$[2],r=$[3]){return T(e,t,n,r,p.get())}function C(e,t){return T(t[0],t[1],t[2],t[3],e)}function w(e){return e}function T(e,t,n,r,i=x()){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function E(e,t,n){let r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function D(e,t,n,r=x()){let i=n[0]-t[0],a=n[1]-t[1],o=n[2]-t[2],s=e[0]-t[0],c=e[1]-t[1],l=e[2]-t[2],u=a*l-o*c,d=o*s-i*l,f=i*c-a*s,p=u*u+d*d+f*f,m=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return r[0]=u*m,r[1]=d*m,r[2]=f*m,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function O(e,n,r,i=0,o=Math.floor(r*(1/3)),c=Math.floor(r*(2/3))){if(r<3)return!1;n(j,i);let l=o,d=!1;for(;l<r-1&&!d;)n(M,l),l++,d=!u(j,M);if(!d)return!1;for(l=Math.max(l,c),d=!1;l<r&&!d;)n(N,l),l++,s(P,j,M),a(P,P),s(F,M,N),a(F,F),d=!u(j,N)&&!u(M,N)&&Math.abs(t(P,F))<A;return d?(D(j,M,N,e),!0):(i!==0||o!==1||c!==2)&&O(e,n,r,0,1,2)}function k(t,n,r=!0){let i=n.length/3;return O(t,(t,r)=>e(t,n[3*r+0],n[3*r+1],n[3*r+2]),r?i-1:i)}var A=.99619469809,j=n(),M=n(),N=n(),P=n(),F=n();function I(e,n,r){return n!==e&&C(e,n),e[3]=-t(w(e),r),e}function L(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function R(e,t,n,r){return o(N,t,e),E(n,N,r)}function z(e,t,n,r){return Z(Q(e,t,s(m.get(),n,t),ee,r))}function B(e,t,n){return t!=null&&Z(Q(e,t.origin,t.direction,te,n))}function V(e,t,n){return Z(Q(e,t.origin,t.vector,0,n))}function H(e,t,n){return Z(Q(e,t.origin,t.vector,1,n))}function U(e,t){return X(e,t)>=0}function W(e,n){let r=t(w(e),n.ray.direction),i=-X(e,n.ray.origin);if(i<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return i>0;if((i<0||r<0)&&!(i<0&&r<0))return!0;let a=i/r;return r>0?a<n.c1&&(n.c1=a):a>n.c0&&(n.c0=a),n.c0<=n.c1}function G(e,n){let r=t(w(e),n.ray.direction),i=-X(e,n.ray.origin);if(r>-1e-6&&r<1e-6)return i>0;let a=i/r;return r>0?a<n.c1&&(n.c1=a):a>n.c0&&(n.c0=a),n.c0<=n.c1}function K(e,t,n){let i=r(m.get(),w(e),-e[3]),a=J(e,s(m.get(),t,i),m.get());return l(n,a,i),n}function q(t,n,r,i){let a=w(t),o=m.get(),c=m.get();_(a,o,c);let l=s(m.get(),r,n),u=f(o,l),d=f(c,l),p=f(a,l);return e(i,u,d,p)}function J(e,n,i){let a=r(m.get(),w(e),t(w(e),n));return s(i,n,a),i}function Y(e,t){return Math.abs(X(e,t))}function X(e,n){return t(w(e),n)+e[3]}function Z(e){return e===0||e===1}function Q(e,n,i,a,o){let s=t(w(e),i),u=X(e,n);if(s===0)return u>=0?2:3;let d=-u/s;return 1&a&&(d=c(d,0,1)),!(4&a)&&d<0||!(8&a)&&d>1?u>=0?2:3:(l(o,n,r(o,i,d)),u>=0?0:1)}var $=[0,0,1,0],ee=12,te=8;export{C,h as D,_ as E,v as O,D as S,g as T,Q as _,B as a,w as b,U as c,K as d,O as f,X as g,Y as h,z as i,W as l,E as m,L as n,V as o,q as p,R as r,H as s,I as t,G as u,S as v,k as w,T as x,x as y};