import{Vn as e}from"./index-BqmCqmfp.js";import"./ImmutableArray-C3KNQCVd.js";import{B as t,M as n,T as r,W as i,Y as a,a as o,c as s,ct as c,l,m as u,ot as d,p as f,s as p,t as m,v as h,x as g}from"./Dictionary-B3Q9BFVY.js";import{s as _}from"./shared-BZhQTnH4.js";import"./number-Dq0Kt6xf.js";function v(e,t){return e&&e.domain?e.domain.type===`coded-value`||e.domain.type===`codedValue`?m.convertObjectToArcadeDictionary({type:`codedValue`,name:e.domain.name,dataType:_[e.field.type],codedValues:e.domain.codedValues.map(e=>({name:e.name,code:e.code}))},h(t)):m.convertObjectToArcadeDictionary({type:`range`,name:e.domain.name,dataType:_[e.field.type],min:e.domain.minValue,max:e.domain.maxValue},h(t)):null}function y(_){_.mode===`async`&&(_.functions.domain=function(t,n){return _.standardFunctionAsync(t,n,async(r,o,s)=>{if(a(s,2,3,t,n),f(s[0]))return v(u(s[0],i(s[1]),s[2]===void 0?void 0:s[2]),t);if(p(s[0]))return await s[0]._ensureLoaded(),v(l(i(s[1]),s[0],null,s[2]===void 0?void 0:s[2]),t);throw new e(t,`InvalidParameter`,n)})},_.functions.subtypes=function(t,r){return _.standardFunctionAsync(t,r,async(i,o,s)=>{if(a(s,1,1,t,r),f(s[0])){let e=n(s[0]);return e?m.convertObjectToArcadeDictionary(e,h(t)):null}if(p(s[0])){await s[0]._ensureLoaded();let e=s[0].subtypeMetaData();return e?m.convertObjectToArcadeDictionary(e,h(t)):null}throw new e(t,`InvalidParameter`,r)})},_.functions.domainname=function(t,n){return _.standardFunctionAsync(t,n,async(r,s,c)=>{if(a(c,2,4,t,n),f(c[0]))return o(c[0],i(c[1]),c[2],c[3]===void 0?void 0:c[3]);if(p(c[0])){await c[0]._ensureLoaded();let e=l(i(c[1]),c[0],null,c[3]===void 0?void 0:c[3]);return d(e,c[2])}throw new e(t,`InvalidParameter`,n)})},_.signatures.push({name:`domainname`,min:2,max:4}),_.functions.domaincode=function(t,n){return _.standardFunctionAsync(t,n,async(r,o,c)=>{if(a(c,2,4,t,n),f(c[0]))return s(c[0],i(c[1]),c[2],c[3]===void 0?void 0:c[3]);if(p(c[0])){await c[0]._ensureLoaded();let e=l(i(c[1]),c[0],null,c[3]===void 0?void 0:c[3]);return g(e,c[2])}throw new e(t,`InvalidParameter`,n)})},_.signatures.push({name:`domaincode`,min:2,max:4}),_.functions.text=function(n,r){return _.standardFunctionAsync(n,r,async(i,o,s)=>{if(a(s,1,2,n,r),p(s[0])){let t=c(s[1],``);if(t===``)return s[0].castToText();if(t.toLowerCase()===`schema`)return s[0].convertToText(`schema`,i.abortSignal);if(t.toLowerCase()===`featureset`)return s[0].convertToText(`featureset`,i.abortSignal);throw new e(n,`InvalidParameter`,r)}return t(s[0],s[1])})},_.functions.gdbversion=function(t,n){return _.standardFunctionAsync(t,n,async(r,i,o)=>{if(a(o,1,1,t,n),f(o[0]))return o[0].gdbVersion();if(p(o[0]))return(await o[0].load()).gdbVersion;throw new e(t,`InvalidParameter`,n)})},_.functions.schema=function(t,n){return _.standardFunctionAsync(t,n,async(i,o,s)=>{if(a(s,1,1,t,n),p(s[0]))return await s[0].load(),m.convertObjectToArcadeDictionary(s[0].schema(),h(t));if(f(s[0])){let e=r(s[0]);return e?m.convertObjectToArcadeDictionary(e,h(t)):null}throw new e(t,`InvalidParameter`,n)})})}export{y as registerFunctions};