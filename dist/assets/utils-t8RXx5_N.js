import{tw as e}from"./index-BqmCqmfp.js";import{Q as t}from"./PieChartMeshWriter-CI24zfQF.js";function n(t){return e(t.frameDurations.reduce((e,t)=>e+t,0))}function r(e){let{width:t,height:n}=e,r=e.frameDurations.reverse();return{frameCount:e.frameCount,duration:e.duration,frameDurations:r,getFrame:t=>{let n=e.frameDurations.length-1-t;return e.getFrame(n)},width:t,height:n}}function i(t,n){let{width:r,height:i,getFrame:a}=t,o=n/t.duration,s=t.frameDurations.map(t=>e(t*o));return{frameCount:t.frameCount,duration:t.duration,frameDurations:s,getFrame:a,width:r,height:i}}function a(t,n){let{width:r,height:i,getFrame:a}=t,o=t.frameDurations.slice(),s=o.shift();return o.unshift(e(s+n)),{frameCount:t.frameCount,duration:t.duration+n,frameDurations:o,getFrame:a,width:r,height:i}}function o(t,n){let{width:r,height:i,getFrame:a}=t,o=t.frameDurations.slice(),s=o.pop();return o.push(e(s+n)),{frameCount:t.frameCount,duration:t.duration+n,frameDurations:o,getFrame:a,width:r,height:i}}var s=class{constructor(t,n,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this._lastUpdated=e(0),this.timeInFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;n>a;)a+=this.timeToFrame,this.nextFrame();let o=this._animation.getFrame(this._currentFrame);this._onFrameData(o)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case`None`:this._currentFrame-=this._direction;break;case`Loop`:this._currentFrame=0;break;case`Oscillate`:this._currentFrame-=this._direction,this._direction=-1}}else if(this._currentFrame===-1)switch(this._repeatType){case`None`:this._currentFrame-=this._direction;break;case`Loop`:this._currentFrame=this._animation.frameDurations.length-1;break;case`Oscillate`:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame],this.timeInFrame=0;let e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)}update(t){let n=e(t-this._lastUpdated);this._lastUpdated=t,this._advance(n)}_advance(e){this.timeInFrame+=e,this.timeInFrame>this.timeToFrame&&this.nextFrame()}};function c(t,n){t.animationsEnabled&&n?.update(e(t.time))}function l(c,l,u,d){let f,{repeatType:p}=l;if(p??=`Loop`,!0===l.reverseAnimation&&(c=r(c)),l.duration!=null&&(c=i(c,e(1e3*l.duration))),l.repeatDelay!=null){let t=1e3*l.repeatDelay;p===`Loop`?c=o(c,e(t)):p===`Oscillate`&&(c=a(o(c,e(t/2)),e(t/2)))}if(l.startTimeOffset!=null)f=e(1e3*l.startTimeOffset);else if(l.randomizeStartTime!=null){let r=l.randomizeStartSeed==null?82749913:l.randomizeStartSeed,i=t(u,r);f=e(i*n(c))}else f=e(0);return new s(c,f,p,d)}export{c as n,l as t};