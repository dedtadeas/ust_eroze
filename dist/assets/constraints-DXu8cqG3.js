import{$l as e,Dv as t,Et as n,Ev as r,Hg as i,Hl as a,Ig as o,Il as s,Iv as c,Jg as l,Nl as u,Ol as d,Ov as f,Qg as p,Rl as m,Sv as h,Ul as g,Wl as _,Xg as v,Xl as y,_t as b,_v as x,au as ee,bv as S,cv as te,eb as ne,eu as C,id as w,jl as T,jt as re,lv as ie,nD as ae,od as oe,rd as se,ru as ce,tb as le,tu as E,uD as ue,vv as de,yv as D}from"./index-BqmCqmfp.js";import{E as fe,S as pe,b as me,c as he,d as ge,g as _e,h as ve,i as ye,m as O,y as k}from"./plane-CTjDePZl.js";import{d as be,m as xe,v as Se,y as Ce}from"./sphere-CicnK0Bn.js";import{a as we,i as Te,r as Ee}from"./geodesicUtils-DJORTTMv.js";import{_ as A,a as De,c as j,d as M,l as Oe,m as ke,u as N}from"./LineSnappingHint-BAcwqgNT.js";function Ae({start:e,end:n,type:r},i,a){let o=[],s=S(L,n,e),c=S(R,e,i),l=t(s),u=2*h(s,c),d=u*u-4*l*(t(c)-a*a);if(d===0){let t=-u/(2*l);(r===0||t>=0)&&o.push(D(w(),e,s,t))}else if(d>0){let t=Math.sqrt(d),n=(-u+t)/(2*l);(r===0||n>=0)&&o.push(D(w(),e,s,n));let i=(-u-t)/(2*l);(r===0||i>=0)&&o.push(D(w(),e,s,i))}return o}function je(t,n){let r=t.start,i=t.end,a=S(L,i,r),o=e(Ge,-a[1],a[0],0),l=n.start,u=n.end,d=m(Ke,u,l),f=s(d,o),g=e(qe,r[0],r[1],0),_=m(Je,g,l),v=s(_,o),y=c();if(Math.abs(f)<y)return[];let b=E(Ye,l,d,v/f);if(n.type===0){let e=m(Xe,b,l);if(s(e,d)<-y)return[]}if(t.type===1){let e=te(R,b,r);if(h(e,a)<-y)return[]}return[p(b)]}function Me(e,t){return Be(P(Qe,t[2],e),t)}function Ne(e,t){return ze(P(Qe,0,e),P($e,0,t)).map(([e,t])=>oe(e,t))}function Pe(e,t,n){return Ie(e,P(Qe,e[2],t),n)}function Fe(e,t,n,r=l()){let i=S(L,e,t),a=f(i);return D(r,t,i,a===0?1:n/a),r[2]=e[2],r}function Ie(e,{start:t,end:n,type:r},i=l()){let a=m(z,e,t),o=m(Ge,n,t),c=s(a,o)/s(o,o);return E(i,t,o,r===0?Math.max(c,0):c)}var Le=(()=>{let e=l(),t=l(),n=l();return({start:i,end:a},{center:o,radius:c,normal:u,slicePlane:d})=>{let f=O(o,u,Ze);if(F(ve(f,i),0)&&F(ve(f,a),0)){fe(u,e,t);let f=(i,a)=>(_(n,a,o),r(i,s(n,e),s(n,t)),i),p=De({start:f(L,i),end:f(R,a),type:1},se,c),m=[];for(let[n,r]of p){let i=ce(l(),o);E(i,i,e,n),E(i,i,t,r),d&&!I(d,i)||m.push(i)}return m}let p=l();return ye(f,i,a,p)?!F(C(p,o),c)||d&&!I(d,p)?[]:[p]:[]}})();function Re({start:e,end:n,type:r},i,a){let o=[],s=_(z,n,e),c=S(R,e,i),u=t(s),d=2*h(s,c),f=d*d-4*u*(t(c)-a*a);if(f===0){let t=-d/(2*u);(r===1||t>=0)&&o.push(E(l(),e,s,t))}else if(f>0){let t=Math.sqrt(f),n=(-d+t)/(2*u);(r===1||n>=0)&&o.push(E(l(),e,s,n));let i=(-d-t)/(2*u);(r===1||i>=0)&&o.push(E(l(),e,s,i))}return o}function ze(e,t){let n=e.start,r=e.end,i=t.start,o=t.end,l=m(z,r,n),u=m(Ge,o,i),d=m(Ke,i,n),f=g(qe,l,u);if(!F(s(d,f),0))return[];let h=a(f);if(F(h,0))return[];let _=g(Je,d,u),v=s(_,f)/h,y=E(Ye,n,l,v);if(e.type===0){let e=m(Xe,y,n);if(s(l,e)<-c())return[]}if(t.type===0){let e=m(Xe,y,i);if(s(u,e)<-c())return[]}return[p(y)]}function Be({start:e,end:t,type:n},r){let i=m(z,r,e),o=m(Ge,t,e),l=g(Ke,o,i),u=a(l)/a(o),d=c();if(u<d)switch(n){case 1:return[p(r)];case 0:return s(o,i)<-d?[]:[p(r)]}return[]}function Ve(e,t,n,r){let[i,a]=e,[o,s]=n,c=o-i,l=s-a,u=c*c+l*l,d=Math.sqrt(u);if(d>t+r||d<Math.abs(t-r)||F(d,0)&&F(t,r))return[];let f=(t*t-r*r+u)/(2*d),p=Math.sqrt(t*t-f*f),m=p*l/d,h=p*c/d,[g,_]=x(L,e,n,f/d);return F(m,h)?[oe(g,_)]:[oe(g+m,_-h),oe(g-m,_+h)]}function P(t,n,{start:r,end:i,type:a}){return e(t.start,r[0],r[1],n),e(t.end,i[0],i[1],n),t.type=We[a],t}function He(e,t){return F(e[2],t[2])}function F(e,t){return le(Math.abs(e-t),0,c())}function Ue(e,t){return t.filter(t=>I(e,t))}function I(e,t){return he(e,t)}var We={0:1,1:0},L=w(),R=w(),z=l(),Ge=l(),Ke=l(),qe=l(),Je=l(),Ye=l(),Xe=l(),Ze=k(),Qe={start:l(),end:l(),type:1},$e={start:l(),end:l(),type:1},B=class{intersect(e){return U(this,e)}closestPoints(e){return[this.closestTo(e)]}},V=class extends B{constructor(e){super(),this.point=e}equals(e){return this===e||G(e)&&T(this.point,e.point)}closestTo(){return N(this.point)}},et=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.lineLike={start:e,end:t,type:n}}equals(e){return this===e||K(e)&&this.lineLike.type===e.lineLike.type&&T(this.start,e.start)&&T(this.end,e.end)}closestTo(e){let t=M();return Ie(e,this.lineLike,t),t}},tt=class extends et{constructor(e,t){super(e,t,1)}},nt=class extends et{constructor(e,t){super(e,t,0)}},rt=class extends B{constructor(e){super(),this.constraints=e}equals(e){return this===e||Gt(e)&&ue(this.constraints,e.constraints,(e,t)=>e.equals(t))}closestTo(e){let t,n=1/0;for(let r of this.constraints){let i=r.closestTo(e),a=ee(e,i);a<n&&(n=a,t=i)}return N(t??e)}closestPoints(e){return this.constraints.flatMap(t=>t===this?[]:t.closestPoints(e))}},it=class extends B{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||Y(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){let t=M();return Fe(e,this.center,this.radius,t),t}},at=class extends B{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return this===e||X(e)&&T(this.center,e.center)&&this.radius===e.radius}closestTo(e){let t=M();return Fe(e,this.center,this.radius,t),t[2]=this.center[2],t}asCircle(){return new ot(N(this.center),this.radius,j(0,0,1))}},ot=class extends B{constructor(e,t,n,r=void 0){super(),this.center=e,this.radius=t,this.normal=n,this.slicePlane=r}equals(e){return this===e||Z(e)&&T(this.center,e.center)&&T(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){let{center:t,radius:n}=this;ge(this.getPlane(ct),e,st);let r=m(st,st,t),i=y(r);if(F(i,0))return N(e);let a=n/Math.sqrt(i),o=M();E(o,t,r,a);let{slicePlane:s}=this;return s&&!I(s,o)?kt(s,this)?.closestTo(e)??N(e):o}getPlane(e=k()){return O(this.center,this.normal,e)}},st=l(),ct=k(),lt=class extends B{constructor(e){super(),this.z=e}equals(e){return this===e||q(e)&&this.z===e.z}closestTo(e){return j(e[0],e[1],this.z)}getPlane(t=k()){return e(ut,0,0,this.z),O(ut,i,t)}},ut=l(),dt=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.planeLike={start:A(e),end:A(t),type:n}}equals(e){return this===e||J(e)&&this.planeLike.type===e.planeLike.type&&T(this.start,e.start)&&T(this.end,e.end)}closestTo(e){let t=M();return Pe(e,this.planeLike,t),t}closestEndTo(e){let{start:t,end:n}=this.planeLike;return Math.sign(h(S(ft,n,t),S(pt,A(e),t)))>0?this.end:this.start}getPlane(e=k()){let t=ce(mt,this.end);return t[2]+=1,pe(this.start,this.end,t,e)}getSlicePlane(t=k()){let{start:n,end:r,type:i}=this.planeLike;if(i===0)return;let a=e(mt,n[0],n[1],0),o=e(ht,r[0],r[1],0),s=_(ht,o,a);return O(a,s,t),t}},ft=w(),pt=w(),mt=l(),ht=l(),gt=class extends dt{constructor(e,t){super(e,t,1)}},_t=class extends dt{constructor(e,t){super(e,t,0)}},vt=class extends B{constructor(e,t){super(),this.sphere=Se(e,t),this._center=p(e)}equals(e){return this===e||Q(e)&&be(this.sphere,e.sphere)}closestTo(e){let t=M();return Ce(this.sphere,e,t),t}get center(){return this._center}get radius(){return this.sphere[3]}},yt=class extends B{constructor(e,t,n){super(),this.start=e,this.end=t,this.getZ=n,this.planeLike={start:A(e),end:A(t),type:0}}equals(e){return this===e||$(e)&&T(this.start,e.start)&&T(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return Tt(this,e)}addIfOnTheGround(e,t){for(let n of t){let t=this.getZ(n[0],n[1])??0;F(n[2],t)&&(n[2]=t,e.push(n))}}},bt=class extends B{constructor(e,t,n){super(),this._x=e,this._y=t,this._z=n}equals(e){return this===e||qt(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,t,n]){return ke(this._x??e,this._y??t,this._z??n)}},xt=class extends B{constructor(e,t,n,r,i){super(),this._origin=e,this._spatialReference=t,this._distanceMeters=n,this._z=r,this._directionDegrees=i}equals(e){return this===e||Kt(e)&&ie(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,t,n]){return r(H,e,t),ie(H,this._origin)||this._applyDirectionAndDistance(H),ke(H[0],H[1],this._z??n)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Te(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Ct(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){let{azimuth:t}=we(St,this._origin,e,this._spatialReference);Te(e,this._origin,t??0,this._distanceMeters,this._spatialReference)}}},H=[0,0],St=new Ee;function Ct(e,t,n,r,i){let{azimuth:a,distance:s}=we(wt,t,r,i);a??=0;let c=s*Math.cos((a-n)*o);c=Math.max(0,c),Te(e,t,n,c,i)}var wt=new Ee;function Tt(e,t){let n=M();return Pe(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??Jt,n}function U(e,t){if(Gt(e)){let n=[];for(let r of e.constraints){let e=r.intersect(t);e&&n.push(e)}return Wt(n)}if(Gt(t))return U(t,e);if($(e))return Vt(e,t);if($(t))return Vt(t,e);if(G(e)){let{point:n}=e;if(G(t))return T(n,t.point)?e:void 0;let r=t.closestTo(n);return u(r,n)?e:void 0}if(K(e)){if(G(t))return U(t,e);if(K(t))return W(ze(e.lineLike,t.lineLike));if(q(t))return Et(e,t);if(J(t))return W(je(t.planeLike,e.lineLike));if(Y(t))return W(Re(e.lineLike,t.center,t.radius));if(Z(t))return W(Le(e.lineLike,t));if(X(t))return Dt(e,t);if(Q(t))return Ot(e,t)}else if(q(e)){if(G(t)||K(t))return U(t,e);if(q(t))return At(e,t);if(J(t))return jt(e,t);if(Y(t))return Mt(e,t);if(Z(t))return Pt(e,t);if(X(t))return Nt(e,t);if(Q(t))return Ft(e,t)}else if(J(e)){if(G(t)||K(t)||q(t))return U(t,e);if(J(t))return Ht(Ne(e.planeLike,t.planeLike));if(Y(t))return Ht(Ae(e.planeLike,t.center,t.radius));if(Z(t))return Lt(e,t);if(X(t))return It(e,t);if(Q(t))return Rt(e,t)}else if(Y(e)){if(G(t)||K(t)||q(t)||J(t))return U(t,e);if(Y(t))return Ht(Ve(A(e.center),e.radius,A(t.center),t.radius));if(Z(t))return;if(X(t))return zt(e,t);if(Q(t))return}else if(Z(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t))return U(t,e);if(Z(t))return;if(X(t))return t.asCircle(),void 0;if(Q(t))return}else if(X(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t)||Z(t))return U(t,e);if(X(t))return Bt(t,e);if(Q(t))return}else if(Q(e)){if(G(t)||K(t)||q(t)||J(t)||Y(t)||X(t))return U(t,e);if(Q(t))return}}var Et=(()=>{let e=k();return(t,n)=>{let{start:r,end:i}=t;if(He(r,i)&&F(r[2],n.z))return t;let a=M();return ye(n.getPlane(e),r,i,a)?new V(a):void 0}})();function Dt({lineLike:e},{center:t,radius:n}){let r=t[2];return W(Re(e,t,n).filter(e=>F(e[2],r)))}function Ot({lineLike:e},{sphere:t}){return W(xe(t,e.start,e.end))}var kt=(()=>{let e=b(),t=l(),r=l();return(i,a,o)=>{let{normal:c,center:u,radius:f}=a;fe(c,t,r);let m=me(i),h=f*s(m,t),_=f*s(m,r);re(e,u[0],u[1],u[2],1);let v=n(i,e),y=Math.hypot(h,_),b=F(y,0);if(F(ve(i,u),0)){if(b)return a;if(F(f,0))return!o||I(o,u)?new V(N(u)):void 0;g(t,m,c),d(t,t);let e=[],n=p(u);E(n,n,t,f),o&&!I(o,n)||e.push(n);let r=p(u);return E(r,r,t,-f),o&&!I(o,r)||e.push(r),W(e)}if(b)return;let x=-v/y;if(Math.abs(x)>1||F(x,1))return;let ee=Math.atan(h/_),S=ne(x)-ee,te=Math.PI-S,C=[],w=l();E(w,u,t,f*Math.cos(S)),E(w,w,r,f*Math.sin(S)),C.push(w);let T=l();return E(T,u,t,f*Math.cos(te)),E(T,T,r,f*Math.sin(te)),C.push(T),W(o?Ue(o,C):C)}})();function At(e,t){return F(e.z,t.z)?e:void 0}function jt({z:e},{planeLike:t}){let[n,r]=t.start,[i,a]=t.end,o=j(n,r,e),s=j(i,a,e);return t.type===0?new tt(o,s):new nt(o,s)}function Mt(e,t){let[n,r]=t.center;return new at(j(n,r,e.z),t.radius)}function Nt(e,t){return F(t.center[2],e.z)?t:void 0}var Pt=(()=>{let e=k();return(t,n)=>kt(t.getPlane(e),n,n.slicePlane)})();function Ft(e,{center:t,radius:n}){let r=Math.abs(t[2]-e.z);if(r>n&&!F(r,n))return;let i=j(t[0],t[1],e.z),a=Math.sqrt(n**2-r**2);return F(a,0)?void 0:new at(i,a)}var It=(()=>{let e=k();return(t,{center:n,radius:r})=>{let i=Ae(t.planeLike,n,r),a=n[2];t.getSlicePlane(e);let o=[];for(let[t,n]of i){let r=[t,n,a];I(e,r)&&o.push(r)}return W(o)}})(),Lt=(()=>{let e=k(),t=k();return(n,r)=>kt(n.getPlane(e),r,n.getSlicePlane(t))})(),Rt=(()=>{let e=k();return(t,{center:n,radius:r})=>{let i=t.getPlane(e),a=_e(i,n),o=Math.abs(a);if(o>r&&!F(o,r))return;let s=Math.sqrt(r**2-a**2);if(F(s,0)){let e=M();return ge(i,n,e),new V(e)}let c=M(),l=p(me(i));return E(c,n,l,a),new ot(c,s,l,t.getSlicePlane())}})();function zt(e,t){let n=de(A(e.center),A(t.center));return F(n,0)&&F(e.radius,t.radius)?t:Ut(Ve(A(e.center),e.radius,A(t.center),t.radius),t.center[2])}function Bt(e,t){if(!He(e.center,t.center))return;let n=de(A(e.center),A(t.center));return F(n,0)&&F(e.radius,t.radius)?e:Ut(Ve(A(e.center),e.radius,A(t.center),t.radius),e.center[2])}function Vt(e,t){let{planeLike:n,getZ:r}=e,i=[];if(G(t))e.addIfOnTheGround(i,Me(n,t.point));else if(K(t))e.addIfOnTheGround(i,je(n,t.lineLike));else if(Y(t))for(let[e,a]of Ae(n,t.center,t.radius)){let t=r(e,a);t!=null&&i.push(v(e,a,t))}else if(J(t)||$(t))for(let[e,a]of Ne(n,t.planeLike)){let t=r(e,a)??Jt;i.push(v(e,a,t))}return W(i)}function Ht(e){return Wt(e.map(([e,t])=>{let n=j(e,t,0),r=j(e,t,1);return new tt(n,r)}))}function W(e){return Wt(e.map(e=>e?new V(Oe(e)):void 0))}function Ut(e,t){return W(e.map(([e,n])=>[e,n,t]))}function Wt(e){if(e.length!==0)return e.length===1?e[0]??void 0:new rt(e.filter(ae))}function Gt(e){return e instanceof rt}function G(e){return e instanceof V}function K(e){return e instanceof et}function q(e){return e instanceof lt}function J(e){return e instanceof dt}function Y(e){return e instanceof it}function X(e){return e instanceof at}function Z(e){return e instanceof ot}function Q(e){return e instanceof vt}function $(e){return e instanceof yt}function Kt(e){return e instanceof xt}function qt(e){return e instanceof bt}var Jt=0;export{bt as a,V as c,tt as d,Ie as f,xt as i,it as l,gt as n,_t as o,lt as r,Wt as s,yt as t,G as u};