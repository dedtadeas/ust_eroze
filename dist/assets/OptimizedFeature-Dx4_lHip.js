import{n as e}from"./memoryEstimations-O7VgDRVG.js";import{t}from"./OptimizedGeometry-f3I9Z6C1.js";function n(e,t){return e?t?4:3:t?3:2}function r(e,t,r,o){if(!t?.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);let s=e.coords,c=[],l=r?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0],{lengths:u,coords:d}=t,f=n(r,o),p=0;for(let e of u){let t=i(l,d,p,e,r,o);t&&c.push(t),p+=e*f}if(c.sort((e,t)=>{let n=e[2]-t[2];return n===0&&r&&(n=e[4]-t[4]),n}),c.length){let e=6*c[0][2];s[0]=c[0][0]/e,s[1]=c[0][1]/e,r&&(e=6*c[0][4],s[2]=e===0?0:c[0][3]/e),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||r&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){let e=t.lengths[0]?a(d,0,u[0],r,o):null;if(!e)return null;s[0]=e[0],s[1]=e[1],r&&e.length>2&&(s[2]=e[2])}return e}function i(e,t,r,i,a,o){let s=n(a,o),c=r,l=r+s,u=0,d=0,f=0,p=0,m=0;for(let n=0,r=i-1;n<r;n++,c+=s,l+=s){let n=t[c],r=t[c+1],i=t[c+2],o=t[l],s=t[l+1],h=t[l+2],g=n*s-o*r;p+=g,u+=(n+o)*g,d+=(r+s)*g,a&&(g=n*h-o*i,f+=(i+h)*g,m+=g),n<e[0]&&(e[0]=n),n>e[1]&&(e[1]=n),r<e[2]&&(e[2]=r),r>e[3]&&(e[3]=r),a&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(p>0&&(p*=-1),m>0&&(m*=-1),!p)return null;let h=[u,d,.5*p];return a&&(h[3]=f,h[4]=.5*m),h}function a(e,t,r,i,a){let u=n(i,a),d=t,f=t+u,p=0,m=0,h=0,g=0;for(let t=0,n=r-1;t<n;t++,d+=u,f+=u){let t=e[d],n=e[d+1],r=e[d+2],a=e[f],u=e[f+1],_=e[f+2],v=i?s(t,n,r,a,u,_):o(t,n,a,u);if(v)if(p+=v,i){let e=l(t,n,r,a,u,_);m+=v*e[0],h+=v*e[1],g+=v*e[2]}else{let e=c(t,n,a,u);m+=v*e[0],h+=v*e[1]}}return p>0?i?[m/p,h/p,g/p]:[m/p,h/p]:r>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function o(e,t,n,r){let i=n-e,a=r-t;return Math.sqrt(i*i+a*a)}function s(e,t,n,r,i,a){let o=r-e,s=i-t,c=a-n;return Math.sqrt(o*o+s*s+c*c)}function c(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function l(e,t,n,r,i,a){return[e+.5*(r-e),t+.5*(i-t),n+.5*(a-n)]}var u=class n{constructor(e=null,t={},n,r,i=0){this.geometry=e,this.attributes=t,this.centroid=n,this.objectId=r,this.displayId=i}static fromJSON(e){let r=e.geometry?t.fromJSON(e.geometry):null,i=e.centroid?t.fromJSON(e.centroid):null,a=e.objectId;return new n(r,e.attributes,i,a)}weakClone(){let e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){let e=this.geometry?.clone(),t=new n(e,{...this.attributes},this.centroid?.clone(),this.objectId);return t.displayId=this.displayId,t}ensureCentroid(e){return this.centroid??=r(new t,this.geometry,e.hasZ,e.hasM),this.centroid}get usedMemory(){return 128+e(this.attributes)+(this.geometry?.usedMemory??0)}};function d(e){return!!e.geometry?.coords?.length}export{u as n,r,d as t};