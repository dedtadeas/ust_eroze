function e(e){return e?{originPosition:e.originPosition===`upper-left`?`upperLeft`:e.originPosition===`lower-left`?`lowerLeft`:e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:e.extent==null?[0,0,0,0]:[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]}:null}function t(e){return e.originPosition===`lowerLeft`&&e.scale.length===4&&e.translate.length===4}function n(e){if(t(e))return e;let{originPosition:n,scale:r,translate:i}=e,a=r[0]??1,o=r[1]??1;return{originPosition:`lowerLeft`,scale:[a,n===`lowerLeft`?o:-o,r[2]??1,r[3]??1],translate:[i[0]??0,i[1]??0,i[2]??0,i[3]??0]}}function r({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function i({scale:e,translate:t},n){return Math.round((n-t[1])/e[1])}function a({scale:e,translate:t},n){return Math.round(((n??0)-t[2])/e[2])}function o({scale:e,translate:t},n){return n?Math.round((n-t[3])/e[3]):0}function s(e,t){return e&&t?d:e&&!t?l:!e&&t?u:c}var c=(e,t)=>{let n=[];if(!t.length)return null;let a=t[0],o=r(e,a[0]),s=i(e,a[1]);n.push([o,s]);for(let a=1;a<t.length;a++){let[c,l]=t[a],u=r(e,c),d=i(e,l);u===o&&d===s||n.push([u-o,d-s]),o=u,s=d}return n},l=(e,t)=>{let n=[];if(!t.length)return null;let o=t[0],s=r(e,o[0]),c=i(e,o[1]),l=a(e,o[2]);n.push([s,c,l]);for(let o=1;o<t.length;o++){let[u,d,f]=t[o],p=r(e,u),m=i(e,d),h=a(e,f);p===s&&m===c&&h===l||n.push([p-s,m-c,h]),s=p,c=m,l=h}return n},u=(e,t)=>{let n=[];if(!t.length)return null;let a=t[0],s=r(e,a[0]),c=i(e,a[1]),l=o(e,a[2]);n.push([s,c,l]);for(let a=1;a<t.length;a++){let[u,d,f]=t[a],p=r(e,u),m=i(e,d),h=o(e,f);p===s&&m===c&&h===l||n.push([p-s,m-c,h]),s=p,c=m,l=h}return n},d=(e,t)=>{let n=[];if(!t.length)return null;let s=t[0],c=r(e,s[0]),l=i(e,s[1]),u=a(e,s[2]),d=o(e,s[3]);n.push([c,l,u,d]);for(let s=1;s<t.length;s++){let[f,p,m,h]=t[s],g=r(e,f),_=i(e,p),v=a(e,m),y=o(e,h);g===c&&_===l&&v===u&&y===d||n.push([g-c,_-l,v,y]),c=g,l=_,u=v,d=y}return n};function f(e,t,n,r){let i=[],a=s(n,r);for(let n=0;n<t.length;n++){let r=a(e,t[n]);r&&r.length>=3&&i.push(r)}return i.length?i:null}function p(e,t,n,r){let i=[],a=s(n,r);for(let n=0;n<t.length;n++){let r=a(e,t[n]);r&&r.length>=2&&i.push(r)}return i.length?i:null}function m({scale:e,translate:t},n){return n*e[0]+t[0]}function h({scale:e,translate:t},n){return n*e[1]+t[1]}function g({scale:e,translate:t},n){return(n??0)*e[2]+t[2]}function _({scale:e,translate:t},n){return n?n*e[3]+t[3]:0}function v(e,t){return e&&t?S:e&&!t?b:!e&&t?x:y}var y=(e,t)=>{let n=Array(t.length);if(!t.length)return n;let r=t[0],i=m(e,r[0]),a=h(e,r[1]);n[0]=[i,a];let{scale:o,originPosition:s}=e,c=o[0],l=s===`lowerLeft`?o[1]:-o[1];for(let e=1;e<t.length;e++){let[r,o]=t[e];i+=c*r,a+=l*o,n[e]=[i,a]}return n},b=(e,t)=>{let n=Array(t.length);if(!t.length)return n;let r=t[0],i=m(e,r[0]),a=h(e,r[1]);n[0]=[i,a,g(e,r[2])];let{scale:o,originPosition:s}=e,c=o[0],l=s===`lowerLeft`?o[1]:-o[1];for(let r=1;r<t.length;r++){let[o,s,u]=t[r];i+=c*o,a+=l*s,n[r]=[i,a,g(e,u)]}return n},x=(e,t)=>{let n=Array(t.length);if(!t.length)return n;let r=t[0],i=m(e,r[0]),a=h(e,r[1]);n[0]=[i,a,_(e,r[2])];let{scale:o,originPosition:s}=e,c=o[0],l=s===`lowerLeft`?o[1]:-o[1];for(let r=1;r<t.length;r++){let[o,s,u]=t[r];i+=c*o,a+=l*s,n[r]=[i,a,_(e,u)]}return n},S=(e,t)=>{let n=Array(t.length);if(!t.length)return n;let r=t[0],i=m(e,r[0]),a=h(e,r[1]);n[0]=[i,a,g(e,r[2]),_(e,r[3])];let{scale:o,originPosition:s}=e,c=o[0],l=s===`lowerLeft`?o[1]:-o[1];for(let r=1;r<t.length;r++){let[o,s,u,d]=t[r];i+=c*o,a+=l*s,n[r]=[i,a,g(e,u),_(e,d)]}return n};function C(e,t,n){let r=Array(n.length);for(let i=0;i<n.length;i++)r[i]=t(e,n[i]);return r}function w(e,t,s){let c=n(e);return t.x=r(c,s.x),t.y=i(c,s.y),s.z!=null&&(t.z=a(c,s.z)),s.m!=null&&(t.m=o(c,s.m)),t}function T(e,t,r){let i=f(n(e),r.rings,r.hasZ,r.hasM);return i?(t.rings=i,t.hasZ=r.hasZ??!1,t.hasM=r.hasM??!1,t):null}function E(e,t,r){let i=p(n(e),r.paths,r.hasZ,r.hasM);return i?(t.paths=i,t.hasZ=r.hasZ??!1,t.hasM=r.hasM??!1,t):null}function D(e,t,r,i=r?.hasZ??!1,a=r?.hasM??!1){if(r!=null){let o=n(e);t.points=v(i,a)(o,r.points),t.hasZ=i,t.hasM=a}return t}function O(e,t,r,i=r?.z!=null,a=r?.m!=null){if(r==null)return t;let o=n(e);return t.x=m(o,r.x),t.y=h(o,r.y),i&&(t.z=g(o,r.z)),a&&(t.m=_(o,r.m)),t}function k(e,t,r,i=r?.hasZ??!1,a=r?.hasM??!1){if(r!=null){let o=n(e);t.rings=C(o,v(i,a),r.rings),t.hasZ=i,t.hasM=a}return t}function A(e,t,r,i=r?.hasZ??!1,a=r?.hasM??!1){if(r!=null){let o=n(e);t.paths=C(o,v(i,a),r.paths),t.hasZ=i,t.hasM=a}return t}export{T as a,w as c,n as d,A as i,E as l,O as n,i as o,k as r,r as s,D as t,e as u};