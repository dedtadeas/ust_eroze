import{Do as e,Mo as t,To as n,Uo as r,Xo as i,Zo as a,bo as o,jo as s,ko as c}from"./index-BqmCqmfp.js";import{t as l}from"./guid-D8BoG5RM.js";import{m as u,s as d}from"./dom-atD5WAsR.js";import"./keyed-CU6bsPrA.js";import{a as f,c as p,l as m,n as h,o as g,t as _}from"./floating-ui-bSZlirwY.js";import"./debounce-JuHvylml.js";import{t as v}from"./openCloseComponent-C1bAqVbv.js";import{t as y}from"./FloatingArrow-B1y4p2MR.js";var b={positionContainer:`position-container`,container:`container`},x=`calcite-tooltip`,S={host:e=>`${x}-${e}`},C=300,w=C/3,T=C*1.5,E=`aria-describedby`;function D(e){let{referenceElement:t}=e;return(typeof t==`string`?u(e,{id:t}):t)||null}var O=class{constructor(){this.registeredElements=new WeakMap,this.registeredShadowRootCounts=new WeakMap,this.hoverOpenTimeout=null,this.hoverCloseTimeout=null,this.activeTooltip=null,this.registeredElementCount=0,this.clickedTooltip=null,this.hoveredTooltip=null,this.queryTooltip=e=>{let{registeredElements:t}=this,n=e.find(e=>t.has(e));return t.get(n)},this.keyDownHandler=e=>{if(e.key===`Escape`&&!e.defaultPrevented){let{activeTooltip:t}=this;if(t?.open){this.clearHoverTimeout(),this.closeActiveTooltip();let n=D(t),r=e.composedPath();(n instanceof Element&&r.includes(n)||r.includes(t))&&e.preventDefault()}}},this.pointerLeaveHandler=e=>{e.defaultPrevented||(this.clearHoverTimeout(),this.closeHoveredTooltip())},this.pointerMoveHandler=e=>{if(e.defaultPrevented){this.closeHoveredTooltip();return}let t=e.composedPath(),n=this.queryTooltip(t);if(this.pathHasOpenTooltip(n,t)){this.clearHoverTimeout();return}n!==this.clickedTooltip&&(n!==this.hoveredTooltip&&this.clearHoverOpenTimeout(),this.hoveredTooltip=n,n?this.openHoveredTooltip(n):this.activeTooltip?.open&&this.closeHoveredTooltip(),this.clickedTooltip=null)},this.clickHandler=e=>{if(e.defaultPrevented)return;this.clickedTooltip=null;let t=e.composedPath(),n=this.queryTooltip(t);if(this.pathHasOpenTooltip(n,t)){this.clearHoverTimeout();return}if(this.closeActiveTooltip(),n){if(this.clearHoverTimeout(),n.closeOnClick){this.clickedTooltip=n,this.toggleTooltip(n,!1);return}this.toggleTooltip(n,!0)}},this.blurHandler=()=>{this.closeActiveTooltip()},this.focusInHandler=e=>{if(e.defaultPrevented)return;let t=e.composedPath(),n=this.queryTooltip(t);if(this.pathHasOpenTooltip(n,t)){this.clearHoverTimeout();return}n!==this.clickedTooltip&&(this.clickedTooltip=null,this.closeTooltipIfNotActive(n),n&&this.toggleFocusedTooltip(n,!0))},this.openHoveredTooltip=e=>{this.hoverOpenTimeout=window.setTimeout(()=>{this.hoverOpenTimeout===null||e!==this.hoveredTooltip||(this.clearHoverCloseTimeout(),this.closeTooltipIfNotActive(e),this.toggleTooltip(e,!0))},this.activeTooltip?.open?w:C)},this.closeHoveredTooltip=()=>{this.hoverCloseTimeout=window.setTimeout(()=>{this.hoverCloseTimeout!==null&&this.closeActiveTooltip()},T)}}registerElement(e,t){this.registeredElementCount++,this.registeredElements.set(e,t);let n=this.getReferenceElShadowRootNode(e);n&&this.registerShadowRoot(n),this.registeredElementCount===1&&this.addListeners()}unregisterElement(e){let t=this.getReferenceElShadowRootNode(e);t&&this.unregisterShadowRoot(t),this.registeredElements.delete(e)&&this.registeredElementCount--,this.registeredElementCount===0&&this.removeListeners()}pathHasOpenTooltip(e,t){let{activeTooltip:n}=this;return n?.open&&t.includes(n)||e?.open&&t.includes(e)}addShadowListeners(e){e.addEventListener(`focusin`,this.focusInHandler)}removeShadowListeners(e){e.removeEventListener(`focusin`,this.focusInHandler)}addListeners(){window.addEventListener(`keydown`,this.keyDownHandler),window.addEventListener(`pointermove`,this.pointerMoveHandler),window.addEventListener(`click`,this.clickHandler),window.addEventListener(`focusin`,this.focusInHandler),window.addEventListener(`blur`,this.blurHandler),document.addEventListener(`pointerleave`,this.pointerLeaveHandler)}removeListeners(){window.removeEventListener(`keydown`,this.keyDownHandler),window.removeEventListener(`pointermove`,this.pointerMoveHandler),window.removeEventListener(`click`,this.clickHandler),window.removeEventListener(`focusin`,this.focusInHandler),window.removeEventListener(`blur`,this.blurHandler),document.removeEventListener(`pointerleave`,this.pointerLeaveHandler)}clearHoverOpenTimeout(){window.clearTimeout(this.hoverOpenTimeout),this.hoverOpenTimeout=null}clearHoverCloseTimeout(){window.clearTimeout(this.hoverCloseTimeout),this.hoverCloseTimeout=null}clearHoverTimeout(){this.clearHoverOpenTimeout(),this.clearHoverCloseTimeout()}closeTooltipIfNotActive(e){this.activeTooltip!==e&&this.closeActiveTooltip()}closeActiveTooltip(){let{activeTooltip:e}=this;e?.open&&this.toggleTooltip(e,!1)}toggleFocusedTooltip(e,t){t&&this.clearHoverTimeout(),this.toggleTooltip(e,t)}toggleTooltip(e,t){e.open=t,this.activeTooltip=t?e:null}registerShadowRoot(e){let{registeredShadowRootCounts:t}=this,n=t.get(e),r=Math.min((typeof n==`number`?n:0)+1,1);r===1&&this.addShadowListeners(e),t.set(e,r)}unregisterShadowRoot(e){let{registeredShadowRootCounts:t}=this,n=t.get(e),r=Math.max((typeof n==`number`?n:1)-1,0);r===0&&this.removeShadowListeners(e),t.set(e,r)}getReferenceElShadowRootNode(e){return e instanceof Element?d(e):null}},k=a`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:contents;--calcite-floating-ui-z-index: var(--calcite-tooltip-z-index, var(--calcite-z-index-tooltip))}.position-container{inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.position-container{opacity:0;inset-block-start:0;left:0}}.position-container{max-inline-size:var(--calcite-tooltip-max-size-x, 20rem);max-block-size:20rem}.position-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.position-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.position-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.position-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.position-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.calcite-floating-ui-arrow{pointer-events:none;position:absolute;z-index:calc(var(--calcite-z-index) * -1);fill:var(--calcite-color-foreground-1)}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-color-border-3)}.container{position:relative;overflow:hidden;padding:.75rem 1rem;font-size:var(--calcite-font-size--2);line-height:1.375;font-weight:var(--calcite-font-weight-medium);word-wrap:break-word;word-break:break-word;border-radius:var(--calcite-tooltip-corner-radius, var(--calcite-corner-radius-round));color:var(--calcite-tooltip-text-color, var(--calcite-color-text-1));text-align:start}.position-container .calcite-floating-ui-anim{border-width:1px;border-style:solid;background-color:var(--calcite-tooltip-background-color, var(--calcite-color-foreground-1));border-color:var(--calcite-tooltip-border-color, var(--calcite-color-border-3));border-radius:var(--calcite-tooltip-corner-radius, var(--calcite-corner-radius-round))}.calcite-floating-ui-arrow{fill:var(--calcite-tooltip-background-color, var(--calcite-color-foreground-1))}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-tooltip-border-color, var(--calcite-color-border-3))}:host([hidden]){display:none}[hidden]{display:none}`,A=new O,j=class extends n{constructor(){super(...arguments),this.arrowRef=s(),this.guid=S.host(l()),this.transitionProp=`opacity`,this.floatingLayout=`vertical`,this.closeOnClick=!1,this.offsetDistance=f,this.offsetSkidding=0,this.open=!1,this.overlayPositioning=`absolute`,this.placement=`auto`,this.calciteTooltipBeforeClose=r({cancelable:!1}),this.calciteTooltipBeforeOpen=r({cancelable:!1}),this.calciteTooltipClose=r({cancelable:!1}),this.calciteTooltipOpen=r({cancelable:!1})}static{this.properties={floatingLayout:[16,{},{state:!0}],referenceEl:[16,{},{state:!0}],closeOnClick:[7,{},{reflect:!0,type:Boolean}],label:1,offsetDistance:[11,{},{type:Number,reflect:!0}],offsetSkidding:[11,{},{reflect:!0,type:Number}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],referenceElement:1}}static{this.styles=k}async reposition(e=!1){let{referenceEl:t,placement:n,overlayPositioning:r,offsetDistance:i,offsetSkidding:a,arrowRef:o,floatingEl:s}=this;return m(this,{floatingEl:s,referenceEl:t,overlayPositioning:r,placement:n,offsetDistance:i,offsetSkidding:a,arrowEl:o.value,type:`tooltip`},e)}connectedCallback(){super.connectedCallback(),this.setUpReferenceElement(!0)}willUpdate(e){(e.has(`offsetDistance`)&&(this.hasUpdated||this.offsetDistance!==f)||e.has(`offsetSkidding`)&&(this.hasUpdated||this.offsetSkidding!==0)||e.has(`overlayPositioning`)&&(this.hasUpdated||this.overlayPositioning!==`absolute`)||e.has(`placement`)&&(this.hasUpdated||this.placement!==`auto`))&&this.reposition(!0),e.has(`open`)&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),e.has(`referenceElement`)&&this.setUpReferenceElement()}loaded(){this.referenceElement&&!this.referenceEl&&this.setUpReferenceElement()}disconnectedCallback(){super.disconnectedCallback(),this.removeReferences(),g(this)}openHandler(){v(this),this.reposition(!0)}onBeforeOpen(){this.calciteTooltipBeforeOpen.emit()}onOpen(){this.calciteTooltipOpen.emit()}onBeforeClose(){this.calciteTooltipBeforeClose.emit()}onClose(){this.calciteTooltipClose.emit(),p(this)}setFloatingEl(e){this.floatingEl=e,e&&requestAnimationFrame(()=>this.setUpReferenceElement())}setTransitionEl(e){e&&(this.transitionEl=e)}setUpReferenceElement(e=!0){this.removeReferences(),this.referenceEl=D(this.el),h(this);let{el:t,referenceElement:n,referenceEl:r}=this;e&&n&&!r&&console.warn(`${t.tagName}: reference-element id "${n}" was not found.`,{el:t}),this.addReferences()}getId(){return this.el.id||this.guid}addReferences(){let{referenceEl:e}=this;if(!e)return;let t=this.getId();`setAttribute`in e&&e.setAttribute(E,t),A.registerElement(e,this.el)}removeReferences(){let{referenceEl:e}=this;e&&(`removeAttribute`in e&&e.removeAttribute(E),A.unregisterElement(e))}render(){let{referenceEl:n,label:r,open:a,floatingLayout:o}=this,s=n&&a,l=!s;return this.el.inert=l,this.el.ariaLabel=r,this.el.ariaLive=`polite`,c(this.el,`id`,this.getId()),this.el.role=`tooltip`,i`<div class=${e(b.positionContainer)} ${t(this.setFloatingEl)}><div class=${e({[_.animation]:!0,[_.animationActive]:s})} ${t(this.setTransitionEl)}>${y({floatingLayout:o,ref:this.arrowRef})}<div class=${e(b.container)}><slot></slot></div></div></div>`}};o(`calcite-tooltip`,j);export{j as Tooltip};