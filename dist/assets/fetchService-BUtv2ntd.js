import{Sb as e,Sw as t,yb as n}from"./index-BqmCqmfp.js";async function r(e,n){let{data:r}=await t(e,{responseType:`json`,query:{f:`json`,...n?.customParameters,token:n?.apiKey}});return r}var i=new Set([`Catalog Layer`,`Feature Layer`,`Oriented Imagery Layer`]);async function a(t,i){let{loadContext:a,...o}=i||{},s=a?await a.fetchServiceMetadata(t,o):await r(t,o),l=e();d(s),c(s);let u={serviceJSON:s,preferredHost:l};if((s.currentVersion??0)<10.5)return u;let f=`${n()??t}/layers`,p=a?await a.fetchServiceMetadata(f,o):await r(f,o);return d(p),c(p),u.layersJSON={layers:p.layers,tables:p.tables},u}function o(e){let{type:t}=e;return!!t&&i.has(t)}function s(e){return e.type===`Table`}function c(e){e.layers=e.layers?.filter(o),e.tables=e.tables?.filter(s)}function l(e){e.type||=`Feature Layer`}function u(e){e.type||=`Table`}function d(e){e.layers?.forEach(l),e.tables?.forEach(u)}function f(e){switch(e){case`Feature Layer`:case`Table`:return`FeatureLayer`;case`Oriented Imagery Layer`:return`OrientedImageryLayer`;case`Catalog Layer`:return`CatalogLayer`}return`FeatureLayer`}export{a as n,r,f as t};