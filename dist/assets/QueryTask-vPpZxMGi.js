const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/meshFeatureSet-CBr8Bp39.js","assets/index-BqmCqmfp.js","assets/index-kIqmb12G.css","assets/earcut-Drx511Ix.js","assets/vec3-40WN6G4a.js","assets/vec4-CcFo8HF1.js","assets/vectorStacks-CKtslZxP.js","assets/quatf64-CJzmL3cc.js","assets/quat-Bk_ZaVz9.js","assets/Mesh-CUHzTZdQ.js","assets/computeTranslationToOriginAndRotation-BC3OuSky.js","assets/projectPointToVector-Clou1sfo.js","assets/spatialReferenceEllipsoidUtils-DBtdxVkA.js","assets/MeshComponent--ctdPfFQ.js","assets/MeshMaterialMetallicRoughness-BUsirHC6.js","assets/meshCloneUtils-Akm6YUJV.js","assets/meshProperties-Du90n6lL.js","assets/MeshLocalVertexSpace-HjmVAuYa.js","assets/MeshTransform-B2p38eYR.js","assets/axisAngleDegrees-Di7q97jx.js","assets/MeshVertexAttributes-Df5_8xlW.js","assets/External-Cyg8cgWj.js","assets/vertexSpaceConversion-g9XG_RJW.js","assets/BufferView-DNaZpbJX.js","assets/Util-3rPi0NfK.js","assets/meshVertexSpaceUtils-Y8FeTLov.js","assets/triangulationUtils-BJbNyOeM.js","assets/Indices-BsTLKVdx.js","assets/deduplicate-BuZ0DaaO.js","assets/plane-CTjDePZl.js","assets/meshFeatureAttributes-DKUFwpcn.js","assets/RelationshipQuery-Cq9nc9mN.js","assets/executeRelationshipQuery-BIZJq23k.js","assets/urlUtils-CtPsFIu4.js","assets/queryAttachments-DERr9RDO.js","assets/AttachmentInfo-BN0SLgvw.js","assets/executeAttributeBinsQuery-B-Vb3h0C.js","assets/AttributeBinsFeatureSet-Cw3XBtzs.js","assets/queryUtils-BA7HiGeg.js","assets/FixedIntervalBinParameters-BO-nZFQ3.js","assets/AttributeBinsQuery-DyK0zHZB.js","assets/executePivotQuery--zSJlpCt.js","assets/queryUtils-GIY2oFHT.js","assets/PivotQuery-VQ28ggdJ.js","assets/executeTopFeaturesQuery-vfDKrb88.js","assets/queryTopFeatures-BiS96kSo.js","assets/TopFeaturesQuery-BCmsIF5I.js","assets/executeForTopIds-DsPj20Oh.js","assets/executeForTopExtents-DEgj1BmU.js","assets/executeForTopCount-D_G7XPuS.js"])))=>i.map(i=>d[i]);
import{CD as e,Cd as t,Cw as n,IS as r,MC as i,OC as a,Od as o,Pa as s,Sx as c,WT as l,_E as u,bD as d,kC as f,rT as p,sr as m,zu as h}from"./index-BqmCqmfp.js";import{n as g}from"./query-D8IHih8e.js";import{n as _,t as v}from"./executeForIds-CFB4h9Bk.js";import{t as y}from"./executeQueryJSON-BAg2ttNX.js";import{t as b}from"./executeQueryPBF-DMb74A0k.js";async function x(e,n,r){let i=h(e),a=await g(i,t.from(n),{...r}),o=a.data.extent;return!o||isNaN(o.xmin)||isNaN(o.ymin)||isNaN(o.xmax)||isNaN(o.ymax)?{count:a.data.count,extent:null}:{count:a.data.count,extent:c.fromJSON(o)}}var S=class extends a{constructor(e){super(e),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.uniqueIdFields=null,this.url=null}get parsedUrl(){return l(this.url)}async execute(e,t){let n=await this.executeJSON(e,t);return this.featureSetFromJSON(e,n,t)}async executeJSON(e,t){let n=this._normalizeQuery(e),r=e.outStatistics?.[0]!=null,i=d(`featurelayer-pbf-statistics`),a=(!r||i)&&!0!==e.returnTrueCurves,o;if(this.pbfSupported&&a)try{o=await b(this.url,n,t,{uniqueIdFields:this.uniqueIdFields})}catch(e){if(e.name!==`query:parsing-pbf`)throw e;this.pbfSupported=!1}return this.pbfSupported&&a||(o=await y(this.url,n,t,{uniqueIdFields:this.uniqueIdFields})),this._normalizeFields(o.fields),o}async featureSetFromJSON(e,t,r){if(!this._queryIs3DObjectFormat(e)||this.infoFor3D==null||!t.features)return s.fromJSON(t);let{meshFeatureSetFromJSON:i}=await p(n(()=>import(`./meshFeatureSet-CBr8Bp39.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])),r);return i(e,this.infoFor3D,t)}executeForCount(e,t){return _(this.url,this._normalizeQuery(e),t,{uniqueIdFields:this.uniqueIdFields})}executeForExtent(e,t){return x(this.url,this._normalizeQuery(e),t)}executeForIds(e,t){return v(this.url,this._normalizeQuery(e),t,{uniqueIdFields:this.uniqueIdFields})}async executeRelationshipQuery(e,t){let[{default:r},{executeRelationshipQuery:i}]=await p(Promise.all([n(()=>import(`./RelationshipQuery-Cq9nc9mN.js`),__vite__mapDeps([31,1,2])),n(()=>import(`./executeRelationshipQuery-BIZJq23k.js`),__vite__mapDeps([32,1,2,33]))]),t);return e=r.from(e),(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),i(this.url,e,t)}async executeRelationshipQueryForCount(e,t){let[{default:r},{executeRelationshipQueryForCount:i}]=await p(Promise.all([n(()=>import(`./RelationshipQuery-Cq9nc9mN.js`),__vite__mapDeps([31,1,2])),n(()=>import(`./executeRelationshipQuery-BIZJq23k.js`),__vite__mapDeps([32,1,2,33]))]),t);return e=r.from(e),(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),i(this.url,e,t)}async executeAttachmentQuery(e,t){let{executeAttachmentQuery:r,fetchAttachments:i,processAttachmentQueryResult:a}=await p(n(()=>import(`./queryAttachments-DERr9RDO.js`),__vite__mapDeps([34,1,2,35,33])),t),o=h(this.url);return a(o,await(this.queryAttachmentsSupported?r(o,e,t):i(o,e,t)))}async executeAttributeBinsQuery(e,t){let{executeAttributeBinsQuery:r}=await p(n(()=>import(`./executeAttributeBinsQuery-B-Vb3h0C.js`),__vite__mapDeps([36,1,2,37,38,33,39,40])),t);return r(this.parsedUrl,e,t)}async executePivotQuery(e,t){let{executePivotQuery:r}=await p(n(()=>import(`./executePivotQuery--zSJlpCt.js`),__vite__mapDeps([41,1,2,33,42,43])),t);return r(this.parsedUrl,e,t)}async executeTopFeaturesQuery(e,t){let{executeTopFeaturesQuery:r}=await p(n(()=>import(`./executeTopFeaturesQuery-vfDKrb88.js`),__vite__mapDeps([44,1,2,33,45,46])),t);return r(this.parsedUrl,e,this.sourceSpatialReference,t)}async executeForTopIds(e,t){let{executeForTopIds:r}=await p(n(()=>import(`./executeForTopIds-DsPj20Oh.js`),__vite__mapDeps([47,1,2,33,45,46])),t);return r(this.parsedUrl,e,t)}async executeForTopExtents(e,t){let{executeForTopExtents:r}=await p(n(()=>import(`./executeForTopExtents-DEgj1BmU.js`),__vite__mapDeps([48,1,2,33,45,46])),t);return r(this.parsedUrl,e,t)}async executeForTopCount(e,t){let{executeForTopCount:r}=await p(n(()=>import(`./executeForTopCount-D_G7XPuS.js`),__vite__mapDeps([49,1,2,33,45,46])),t);return r(this.parsedUrl,e,t)}_normalizeQuery(e){let n=t.from(e);n.sourceSpatialReference=n.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(n=n===e?n.clone():n,n.gdbVersion=e.gdbVersion||this.gdbVersion,n.dynamicDataSource=e.dynamicDataSource?o.from(e.dynamicDataSource):this.dynamicDataSource);let{infoFor3D:i}=this;if(i!=null&&this._queryIs3DObjectFormat(e)){if(n=n===e?n.clone():n,n.formatOf3DObjects=m(i),!n.formatOf3DObjects)throw new u(`query:unsupported-3d-query-formats`,`Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf`);if(n.outSpatialReference&&!r(n.outSpatialReference,this.sourceSpatialReference))throw new u(`query:unsupported-out-spatial-reference`,`3D object feature services do not support projection of geometries`);if(n.outFields==null||!n.outFields.includes(`*`)){n=n===e?n.clone():n,n.outFields??=[];let{originX:t,originY:r,originZ:a,translationX:o,translationY:s,translationZ:c,scaleX:l,scaleY:u,scaleZ:d,rotationX:f,rotationY:p,rotationZ:m,rotationDeg:h}=i.transformFieldRoles;n.outFields.push(t,r,a,o,s,c,l,u,d,f,p,m,h)}}return n}_normalizeFields(e){if(this.fieldsIndex!=null&&e!=null)for(let t of e){let e=this.fieldsIndex.get(t.name);e&&Object.assign(t,e.toJSON())}}_queryIs3DObjectFormat(e){return this.infoFor3D!=null&&!0===e.returnGeometry&&e.multipatchOption!==`xyFootprint`&&!e.outStatistics}};e([i({type:o})],S.prototype,`dynamicDataSource`,void 0),e([i()],S.prototype,`fieldsIndex`,void 0),e([i()],S.prototype,`gdbVersion`,void 0),e([i()],S.prototype,`infoFor3D`,void 0),e([i({readOnly:!0})],S.prototype,`parsedUrl`,null),e([i()],S.prototype,`pbfSupported`,void 0),e([i()],S.prototype,`queryAttachmentsSupported`,void 0),e([i()],S.prototype,`sourceSpatialReference`,void 0),e([i()],S.prototype,`uniqueIdFields`,void 0),e([i({type:String})],S.prototype,`url`,void 0),S=e([f(`esri.layers.graphics.sources.support.QueryTask`)],S);export{S as t};