import{Qx as e,aa as t,uS as n}from"./index-BqmCqmfp.js";function r(e){let t,n,r=[],a=!1;function o(...o){return a&&t===this&&i(o,r)||(n=e.apply(this,o),t=this,r=o,a=!0),n}return o}function i(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function a(e){return e?A:j}function o(e,t){return t?.mode?t.mode:a(e).mode}function s(e,t){return t??a(e)}function c(e,t){return o(e==null||(e.hasZ??!1),t)}function l(e,t){return s(e==null||(e.hasZ??!1),t)}function u(e){let t=h(e);return c(e.geometry,t)}function d(e){let t=h(e),n=c(e.geometry,t),r=t!=null&&n!==`on-the-ground`?k(t):0,i=t?.featureExpressionInfo;return{mode:n,offset:r,featureExpressionInfo:i}}function f(e){return m(e)||p(e)}function p(e){return e?.featureExpressionInfo?.expression===`0`}function m(e){if(!e||e.mode===`on-the-ground`)return!1;let t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||t===`0`)}function h(e){return e.layer&&`elevationInfo`in e.layer?e.layer.elevationInfo:null}var g=r((t,r,i)=>{if(!t||r===`decimal-degrees`)return 0;let a=r!==`unknown`&&r?r:`meters`,o=n(i);return o?e(t,a,o):0});function _(e,t){return g(e?.offset,e?.unit,t)}function v(e,t,n){if(!n?.mode)return;let r=e.hasZ?e.z:0,i=_(n,e.spatialReference);switch(n.mode){case`absolute-height`:return r-i;case`on-the-ground`:return 0;case`relative-to-ground`:return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,`ground`)??0)+i);case`relative-to-scene`:return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,`scene`)??0)+i)}}function y(e,t,n,r=null){return x(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,r)}function b(e,t,n,r,i=null){return x(e,t[0],t[1],t.length>2?t[2]:0,n,r,i)}function x(e,t,n,r,i,a,o=null){if(a==null)return;let s=o==null?`absolute-height`:o.mode;if(s===`on-the-ground`)return 0;let{absoluteZ:c}=S(t,n,r,i,e,a);return C(c,t,n,r,i,e,o,s)}function S(e,t,n,r,i,a){let o=_(a,r);switch(a.mode){case`absolute-height`:return{absoluteZ:n+o,elevation:0};case`on-the-ground`:{let n=i.elevationProvider.getElevation(e,t,0,r,`ground`)??0;return{absoluteZ:n,elevation:n}}case`relative-to-ground`:{let a=i.elevationProvider.getElevation(e,t,n,r,`ground`)??0;return{absoluteZ:n+a+o,elevation:a}}case`relative-to-scene`:{let a=i.elevationProvider.getElevation(e,t,n,r,`scene`)??0;return{absoluteZ:n+a+o,elevation:a}}}}function C(e,t,n,r,i,a,o,s){let c=_(o,i);switch(s){case`absolute-height`:return e-c;case`relative-to-ground`:return e-((a.elevationProvider.getElevation(t,n,r,i,`ground`)??0)+c);case`relative-to-scene`:return e-((a.elevationProvider.getElevation(t,n,r,i,`scene`)??0)+c)}}function w(e,t){if(t==null)return!1;let{mode:n}=t;return n!=null&&(e===`scene`&&n===`relative-to-scene`||e===`ground`&&n!==`absolute-height`)}function T(e,t,n){return n&&n.mode!==t?`${e} only support ${t} elevation mode`:null}function E(e,t,n){return n?.mode===t?`${e} do not support ${t} elevation mode`:null}function D(e,t){return t?.featureExpressionInfo!=null&&t.featureExpressionInfo.expression!==`0`?`${e} do not support featureExpressionInfo`:null}function O(e,t){t&&e.warn(`.elevationInfo=`,t)}function k(e){return(e?.offset??0)*t(e?.unit)}var A={mode:`absolute-height`,offset:0},j={mode:`on-the-ground`,offset:null};export{r as S,o as _,D as a,v as b,b as c,_ as d,s as f,c as g,l as h,w as i,d as l,j as m,y as n,A as o,O as p,x as r,u as s,E as t,f as u,p as v,S as x,T as y};